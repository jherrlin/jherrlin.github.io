<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="en-us">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>Emacs Org mode tables | jherrlin</title>

<meta property='og:title' content='Emacs Org mode tables - jherrlin'>
<meta property='og:description' content='Intro This is the second post in the serie of how I use Emacs Org mode (from now on org) and it will cover usage of org tables. Some of the content assumes basic knowledge about org. If you are new to org I can recommend this two videos; hrs and kitchin.
Org tables are like spreadsheets with super powers. Tables can be used to keep information organized, as input to source blocks (more about that in the first post, &#34;Emacs Org mode source blocks&#34;) or used in calculations.'>
<meta property='og:url' content='https://jherrlin.github.io/posts/emacs-orgmode-tables/'>
<meta property='og:site_name' content='jherrlin'>
<meta property='og:type' content='article'><meta property='og:image' content='https://www.gravatar.com/avatar/4bc4e51875ff5d86326b676d50864a2c?s=256'><meta property='article:section' content='Posts'><meta property='article:tag' content='emacs'><meta property='article:tag' content='GNU'><meta property='article:tag' content='org'><meta property='article:tag' content='programming'><meta property='article:published_time' content='2020-06-21T16:16:30&#43;02:00'/><meta property='article:modified_time' content='2020-06-21T16:16:30&#43;02:00'/><meta name='twitter:card' content='summary'><meta name='twitter:site' content='@jherrlin'><meta name='twitter:creator' content='@jherrlin'>


<link href="https://jherrlin.github.io/index.xml" rel="alternate" type="application/rss+xml" title="jherrlin" />

<link rel="stylesheet" href="/css/style.css"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<link rel="canonical" href="https://jherrlin.github.io/posts/emacs-orgmode-tables/">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
<section class="section">
  <div class="container">
    <nav id="nav-main" class="nav">
      <div id="nav-name" class="nav-left">
        <a id="nav-anchor" class="nav-item" href="https://jherrlin.github.io/">
          <h1 id="nav-heading" class="title is-4">jherrlin</h1>
        </a>
      </div>
      <div class="nav-right">
        <nav id="nav-items" class="nav-item level is-mobile"><a class="level-item" aria-label="github" href='https://github.com/jherrlin'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="twitter" href='https://twitter.com/jherrlin'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="email" href='mailto:jherrlin@gmail.com'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="linkedin" href='https://linkedin.com/in/john-herrlin-63458280'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path stroke-width="1.8" d="m5.839218,4.101561c0,1.211972 -0.974141,2.194011 -2.176459,2.194011s-2.176459,-0.982039 -2.176459,-2.194011c0,-1.211094 0.974141,-2.194011 2.176459,-2.194011s2.176459,0.982917 2.176459,2.194011zm0.017552,3.94922l-4.388022,0l0,14.04167l4.388022,0l0,-14.04167zm7.005038,0l-4.359939,0l0,14.04167l4.360816,0l0,-7.370999c0,-4.098413 5.291077,-4.433657 5.291077,0l0,7.370999l4.377491,0l0,-8.89101c0,-6.915523 -7.829986,-6.66365 -9.669445,-3.259423l0,-1.891237z"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="rss" href='/index.xml'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle>
    
  </svg></i>
            </span>
          </a></nav>
      </div>
    </nav>

    <nav class="nav">
      

      
    </nav>

  </div>
  <script src="/js/navicon-shift.js"></script>
</section>
<section class="section">
  <div class="container">
    <div class="subtitle tags is-6 is-pulled-right">
      
      
<a class="subtitle is-6" href="/tags/emacs/">#emacs</a>



  
  | <a class="subtitle is-6" href="/tags/gnu/">#GNU</a>
  
  | <a class="subtitle is-6" href="/tags/org/">#org</a>
  
  | <a class="subtitle is-6" href="/tags/programming/">#programming</a>
  


      
    </div>
    <h2 class="subtitle is-6">June 21, 2020</h2>
    <h1 class="title">Emacs Org mode tables</h1>
    
    <div class="content">
      
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Intro
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>
  This is the second post in the serie of how I use Emacs <a href="https://orgmode.org/">Org mode</a> (from now on org) and
  it will cover usage of <a href="https://orgmode.org/manual/Tables.html#Tables">org tables</a>. Some of the content assumes basic knowledge about
  org. If you are new to org I can recommend this two videos; <a href="https://www.youtube.com/watch?v=SzA2YODtgK4">hrs</a> and <a href="https://www.youtube.com/watch?v=fgizHHd7nOo">kitchin</a>.</p>
<p>
  Org tables are like spreadsheets with super powers. Tables can be used to keep
  information organized, as input to source blocks (more about that in the first post,
  &#34;Emacs Org mode source blocks&#34;) or used in calculations.</p>
<p>
  My main usage of tables is to calculate work time. I sum up the time I should work and
  the time I have been working and calc the diff.</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Versions
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>
  â€¦ of Emacs and Org mode.</p>
<div class="src src-org">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-org" data-lang="org"><span class="line"><span class="cl"><span class="c">#+BEGIN_SRC </span><span class="cs">emacs-lisp</span><span class="c">
</span></span></span><span class="line"><span class="cl"><span class="c"></span>  <span class="p">(</span><span class="nv">org-version</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c">#+END_SRC</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cs">#+RESULTS</span><span class="c">:</span>
</span></span><span class="line"><span class="cl">: 9.3.7
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#+BEGIN_SRC </span><span class="cs">emacs-lisp</span><span class="c">
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="p">(</span><span class="nv">emacs-version</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c">#+END_SRC</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cs">#+RESULTS</span><span class="c">:</span>
</span></span><span class="line"><span class="cl">: GNU Emacs 26.3 (build 1, x86_64-pc-linux-gnu, GTK+ Version 3.24.20)
</span></span><span class="line"><span class="cl">:  of 2020-05-19</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-3" class="outline-2">
<h2 id="headline-3">
Emacs config
</h2>
<div id="outline-text-headline-3" class="outline-text-2">
<p>
  Without config Emacs don&#39;t know how to execute source blocks. This following snippet
  provides Emacs with the ability to understand a set of languages/applications. The set
  of languages/applications need to be available in the underlying OS. To get a complete
  list of languages/applications available in org. A complete list can be found here:
  <a href="https://code.orgmode.org/bzg/org-mode/src/master/lisp">repo</a>. Support for source blocks are available in files prefixed with <code class="verbatim">ob-</code>.</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="line"><span class="cl"><span class="p">(</span><span class="nb">setq</span> <span class="nv">org-confirm-babel-evaluate</span> <span class="no">nil</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nv">org-babel-do-load-languages</span>
</span></span><span class="line"><span class="cl"> <span class="ss">&#39;org-babel-load-languages</span>
</span></span><span class="line"><span class="cl"> <span class="o">&#39;</span><span class="p">((</span><span class="nv">emacs-lisp</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nv">shell</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nv">scheme</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nv">python</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nv">awk</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">(</span><span class="nv">clojure</span> <span class="o">.</span> <span class="no">t</span><span class="p">)))</span></span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-4" class="outline-2">
<h2 id="headline-4">
Table with a name
</h2>
<div id="outline-text-headline-4" class="outline-text-2">
<p>
  This example names the table via the <code class="verbatim">#+NAME:</code> command. This named table is then used as
  input to a source block. Here we use <code class="verbatim">awk</code> to sum the population in Europe. More about
  this can be found in the first post, &#34;Emacs Org mode source blocks&#34;.</p>
<div class="src src-org">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-org" data-lang="org"><span class="line"><span class="cl"><span class="cs">#+NAME</span><span class="c">: countries</span>
</span></span><span class="line"><span class="cl"><span class="s">| Country name | Area | Population | Region        |</span>
</span></span><span class="line"><span class="cl"><span class="s">|--------------+------+------------+---------------|</span>
</span></span><span class="line"><span class="cl"><span class="s">| USSR         | 8649 |        275 | Asia          |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Canada       | 3852 |         25 | North America |</span>
</span></span><span class="line"><span class="cl"><span class="s">| China        | 3705 |       1032 | Asia          |</span>
</span></span><span class="line"><span class="cl"><span class="s">| USA          | 3615 |        237 | North America |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Brazil       | 3286 |        134 | South America |</span>
</span></span><span class="line"><span class="cl"><span class="s">| India        | 1267 |        746 | Asia          |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Mexico       |  762 |         78 | North America |</span>
</span></span><span class="line"><span class="cl"><span class="s">| France       |  211 |         55 | Europe        |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Japan        |  144 |        120 | Asia          |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Germany      |   96 |         61 | Europe        |</span>
</span></span><span class="line"><span class="cl"><span class="s">| England      |   94 |         56 | Europe        |</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#+BEGIN_SRC </span><span class="cs">awk</span><span class="c"> :stdin countries
</span></span></span><span class="line"><span class="cl"><span class="c"></span>  <span class="sr">/Europe/</span> <span class="p">{</span> <span class="nx">sum</span><span class="o">+=</span> <span class="o">$</span><span class="mi">3</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nb">END</span> <span class="p">{</span> <span class="kr">print</span> <span class="s2">&#34;Sum of the population in Europe is&#34;</span><span class="p">,</span> <span class="nx">sum</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c">#+END_SRC</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cs">#+RESULTS</span><span class="c">:</span>
</span></span><span class="line"><span class="cl">: Sum of the population in Europe is 172</span></span></code></pre></div>
</div>
<p>
  Data is taken from the book <a href="https://ia802309.us.archive.org/25/items/pdfy-MgN0H1joIoDVoIC7/The_AWK_Programming_Language.pdf">The AWK Programming Language</a>.</p>
</div>
</div>
<div id="outline-container-headline-5" class="outline-2">
<h2 id="headline-5">
Calculate sums
</h2>
<div id="outline-text-headline-5" class="outline-text-2">
<p>
  Just like the previous example this one will do calculations based on data in a table.
  But this on will use table formulas (<code class="verbatim">TBLFM</code>) to do the calculations. This time the
  table wont be passed to a programming language outside of Emacs. In the &#34;before&#34; we have
  some items with amount and cost data. We would like to know the amount * cost for each
  row and the sum of all &#34;Total&#34; rows.</p>
<p>
  By putting the pointer on the <code class="verbatim">TBLFM</code> formula and use the keyboard sequence <code class="verbatim">C-c C-c</code> the
  calculations will be executed.</p>
<p>
  Org docs on <a href="https://orgmode.org/worg/org-tutorials/org-spreadsheet-lisp-formulas.html">table formulas</a> and <a href="https://orgmode.org/org.html#Advanced-features">advanced features</a>.</p>
<div class="src src-org">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-org" data-lang="org"><span class="line"><span class="cl">Before <span class="nc">=TBLFM=</span> is evaluated
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">| Description | Amounts | Cost | Total |</span>
</span></span><span class="line"><span class="cl"><span class="s">|-------------+---------+------+-------|</span>
</span></span><span class="line"><span class="cl"><span class="s">| Item 1      |       5 |   10 |       |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Item 2      |       1 |   55 |       |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Item 3      |      20 |   10 |       |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Item 4      |    1000 |    1 |       |</span>
</span></span><span class="line"><span class="cl"><span class="s">|-------------+---------+------+-------|</span>
</span></span><span class="line"><span class="cl"><span class="s">| Sum:        |         |      |       |</span>
</span></span><span class="line"><span class="cl"><span class="cs">#+TBLFM</span><span class="c">: $4=$2*$3::@&gt;$4=vsum(@&lt;&lt;$4..@&gt;&gt;$4)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">After <span class="nc">=TBLFM=</span> is evaluated
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">| Description | Amounts | Cost | Total |</span>
</span></span><span class="line"><span class="cl"><span class="s">|-------------+---------+------+-------|</span>
</span></span><span class="line"><span class="cl"><span class="s">| Item 1      |       5 |   10 |    50 |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Item 2      |       1 |   55 |    55 |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Item 3      |      20 |   10 |   200 |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Item 4      |    1000 |    1 |  1000 |</span>
</span></span><span class="line"><span class="cl"><span class="s">|-------------+---------+------+-------|</span>
</span></span><span class="line"><span class="cl"><span class="s">| Sum:        |         |      |  1305 |</span>
</span></span><span class="line"><span class="cl"><span class="cs">#+TBLFM</span><span class="c">: $4=$2*$3::@&gt;$4=vsum(@&lt;&lt;$4..@&gt;&gt;$4)</span></span></span></code></pre></div>
</div>
<div id="outline-container-headline-6" class="outline-3">
<h3 id="headline-6">
Calculate with time
</h3>
<div id="outline-text-headline-6" class="outline-text-3">
<p>
   This is more or less the same as in previous example but this time we have a <code class="verbatim">U</code> in the
   <code class="verbatim">TBLFM</code> and that tells org to calculate time. Org have many different ways of manage
   time, more about that <a href="https://orgmode.org/manual/Durations-and-time-values.html">here</a>.</p>
<div class="src src-org">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-org" data-lang="org"><span class="line"><span class="cl">Before <span class="nc">=TBLFM=</span> is evaluated
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">| Task  |  Time |</span>
</span></span><span class="line"><span class="cl"><span class="s">|-------+-------|</span>
</span></span><span class="line"><span class="cl"><span class="s">| Taks1 |  8:00 |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Task2 |  0:30 |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Task3 |  2:00 |</span>
</span></span><span class="line"><span class="cl"><span class="s">|-------+-------|</span>
</span></span><span class="line"><span class="cl"><span class="s">| Total |       |</span>
</span></span><span class="line"><span class="cl"><span class="cs">#+TBLFM</span><span class="c">: @&gt;$2=vsum(@&lt;&lt;$2..@&gt;&gt;$2);U</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">After <span class="nc">=TBLFM=</span> is evaluated
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">| Task  |  Time |</span>
</span></span><span class="line"><span class="cl"><span class="s">|-------+-------|</span>
</span></span><span class="line"><span class="cl"><span class="s">| Taks1 |  8:00 |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Task2 |  0:30 |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Task3 |  2:00 |</span>
</span></span><span class="line"><span class="cl"><span class="s">|-------+-------|</span>
</span></span><span class="line"><span class="cl"><span class="s">| Total | 10:30 |</span>
</span></span><span class="line"><span class="cl"><span class="cs">#+TBLFM</span><span class="c">: @&gt;$2=vsum(@&lt;&lt;$2..@&gt;&gt;$2);U</span></span></span></code></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-7" class="outline-2">
<h2 id="headline-7">
Calculate work time
</h2>
<div id="outline-text-headline-7" class="outline-text-2">
<p>
  This is an example on how I use tables to make sure that I work my hours.</p>
<p>
  At my current work we have 40 hours a week freely distributed, no 8-17. As I am a person
  that like routines I often try to do 8-17 but I am not to strict about it. Working some
  hours in the night or on weekends is normal. I have a setup where I schedule 8 hours of
  work every weekday (5*8=40). And to keep track that I really do that I use a table
  together with some Emacs LiSP code and a <code class="verbatim">TBLFM</code> formula. If I am sick or on vacation I
  put &#34;0:00&#34; in &#34;Worked&#34;. This tells the LiSP code to not add &#34;8:00&#34; hours in the &#34;Should
  work&#34; spot. And if I work hours on a weekend that day should not add extra &#34;8:00&#34; to
  &#34;Should work&#34;.</p>
<div class="src src-org">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-org" data-lang="org"><span class="line"><span class="cl"><span class="c">#+BEGIN_SRC </span><span class="cs">emacs-lisp</span><span class="c"> :results none
</span></span></span><span class="line"><span class="cl"><span class="c"></span>  <span class="p">(</span><span class="nb">defun</span> <span class="nv">jh/hours-a-day</span> <span class="p">(</span><span class="nv">date</span> <span class="nv">time</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="nb">if</span> <span class="p">(</span><span class="nf">string-equal</span> <span class="nv">time</span> <span class="s">&#34;0:00&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="nb">if</span> <span class="p">(</span><span class="nb">or</span> <span class="p">(</span><span class="nf">string-match</span> <span class="s">&#34; Mon&#34;</span> <span class="nv">date</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="nf">string-match</span> <span class="s">&#34; Tue&#34;</span> <span class="nv">date</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="nf">string-match</span> <span class="s">&#34; Wed&#34;</span> <span class="nv">date</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="nf">string-match</span> <span class="s">&#34; Thu&#34;</span> <span class="nv">date</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="p">(</span><span class="nf">string-match</span> <span class="s">&#34; Fri&#34;</span> <span class="nv">date</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">          <span class="s">&#34;8:00&#34;</span> <span class="s">&#34;&#34;</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="c">#+END_SRC</span></span></span></code></pre></div>
</div>
<p>
  The example contains multiple <code class="verbatim">TBLFM</code>, eval them one by one from the top to the bottom.</p>
<div class="src src-org">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-org" data-lang="org"><span class="line"><span class="cl"><span class="s">| Day              | Worked | Should work |</span>
</span></span><span class="line"><span class="cl"><span class="s">|------------------+--------+-------------|</span>
</span></span><span class="line"><span class="cl">| [2020-06-20 Sat] |   2:00 |             | # Day off, it&#39;s a weekend
</span></span><span class="line"><span class="cl"><span class="s">| [2020-06-19 Fri] |   8:00 |        8:00 |</span>
</span></span><span class="line"><span class="cl"><span class="s">| [2020-06-18 Thu] |   8:00 |        8:00 |</span>
</span></span><span class="line"><span class="cl"><span class="s">| [2020-06-17 Wed] |   7:30 |        8:00 |</span>
</span></span><span class="line"><span class="cl"><span class="s">| [2020-06-16 Tue] |   7:30 |        8:00 |</span>
</span></span><span class="line"><span class="cl">| [2020-06-15 Mon] |   0:00 |             | # Sick or vacation, as it&#39;s a weekday
</span></span><span class="line"><span class="cl"><span class="s">|------------------+--------+-------------|</span>
</span></span><span class="line"><span class="cl"><span class="s">| Total            |  33:00 |       32:00 |</span>
</span></span><span class="line"><span class="cl"><span class="s">| Diff             |        |       01:00 |</span>
</span></span><span class="line"><span class="cl"><span class="cs">#+TBLFM</span><span class="c">: @&lt;&lt;$3..@&gt;&gt;&gt;$3=&#39;(jh/hours-a-day $1 $2)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="cs">#+TBLFM</span><span class="c">: @&gt;&gt;$2=vsum(@&lt;&lt;$2..@&gt;&gt;&gt;$2);U</span>
</span></span><span class="line"><span class="cl"><span class="cs">#+TBLFM</span><span class="c">: @&gt;&gt;$3=vsum(@&lt;&lt;$3..@&gt;&gt;&gt;$3);U</span>
</span></span><span class="line"><span class="cl"><span class="cs">#+TBLFM</span><span class="c">: @&gt;$3=(@&gt;&gt;$2-@&gt;&gt;$3);U</span></span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-8" class="outline-2">
<h2 id="headline-8">
Logbook and clocktable
</h2>
<div id="outline-text-headline-8" class="outline-text-2">
<p>
  This example is not about tables but headlines, drawers and clocktable will be part of a
  bigger example later.</p>
<p>
  So, org have headlines. A headline is a row that starts with one or more <code class="verbatim">*</code>. The number
  of <code class="verbatim">*</code> declares the depth of the sub headline. In this example <code class="verbatim">Work</code> is headline,
  <code class="verbatim">[2020-06-10 Wed] Deployed server</code> and <code class="verbatim">[2020-06-11 Thu] Updated deps</code> are sub
  headlines. Here is headline <a href="https://orgmode.org/manual/Headlines.html">docs</a>.</p>
<p>
  Drawers are values associated with a headline. In this case we use <code class="verbatim">LOGBOOK</code> drawer and
  each <code class="verbatim">LOGBOOK</code> have one or more <code class="verbatim">CLOCK</code> entries. Each <code class="verbatim">CLOCK</code> entry is a datetime range.</p>
<p>
  Clocktable is a report on <code class="verbatim">CLOCK</code> entries. It asks for a <code class="verbatim">scope</code> and finds clocking
  information from it. In this case the <code class="verbatim">scope</code> is the current buffer. To eval a
  clocktable, put the pointer on <code class="verbatim">#+BEGIN:</code> row and use <code class="verbatim">C-c C-c</code>. Here is the doc on
  <a href="https://orgmode.org/manual/The-clock-table.html#The-clock-table">clocktable</a>.</p>
<div class="src src-org">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-org" data-lang="org"><span class="line"><span class="cl"><span class="c">#+BEGIN: </span><span class="cs">clocktable</span><span class="c"> :scope file :maxlevel 2
</span></span></span><span class="line"><span class="cl"><span class="c"></span>#<span class="gd">+CAPTION: Clock summary at [2020-06-21 Sun 21:03]
</span></span></span><span class="line"><span class="cl"><span class="gd">| Headline                             | Time    |      |
</span></span></span><span class="line"><span class="cl"><span class="gd">|--------------------------------------+</span>---------<span class="gd">+------|
</span></span></span><span class="line"><span class="cl"><span class="gd">| *Total time*                         | *12:00* |      |
</span></span></span><span class="line"><span class="cl"><span class="gd">|--------------------------------------+</span>---------+------|
</span></span><span class="line"><span class="cl"><span class="s">| Work                                 | 12:00   |      |</span>
</span></span><span class="line"><span class="cl"><span class="s">| \_  [2020-06-11 Thu] Updated deps    |         | 4:00 |</span>
</span></span><span class="line"><span class="cl"><span class="s">| \_  [2020-06-10 Wed] Deployed server |         | 8:00 |</span>
</span></span><span class="line"><span class="cl"><span class="c">#+END:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh">*</span><span class="gs"> Work</span>
</span></span><span class="line"><span class="cl"><span class="gu">**</span> [2020-06-11 Thu] Updated deps
</span></span><span class="line"><span class="cl"><span class="c">   :LOGBOOK:
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="cs">   CLOCK: [2020-06-11 Thu 13:00]--[2020-06-11 Thu 17:00] =&gt;  4:00
</span></span></span><span class="line"><span class="cl"><span class="cs"></span><span class="c">   :END:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">**</span> [2020-06-10 Wed] Deployed server
</span></span><span class="line"><span class="cl"><span class="c">   :LOGBOOK:
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="cs">   CLOCK: [2020-06-10 Wed 08:00]--[2020-06-10 Wed 12:00] =&gt;  4:00
</span></span></span><span class="line"><span class="cl"><span class="cs">   CLOCK: [2020-06-10 Wed 13:00]--[2020-06-10 Wed 17:00] =&gt;  4:00
</span></span></span><span class="line"><span class="cl"><span class="cs"></span><span class="c">   :END:</span></span></span></code></pre></div>
</div>
<p>
  HINT: <strong>Total time</strong> format may differ. Look here: <a href="https://stackoverflow.com/questions/22720526/set-clock-table-duration-format-for-emacs-org-mode">how to change <strong>Total time</strong> format</a>.</p>
</div>
</div>
<div id="outline-container-headline-9" class="outline-2">
<h2 id="headline-9">
Composed example
</h2>
<div id="outline-text-headline-9" class="outline-text-2">
<p>
  This example combines many of the features we have gone through. The main idea here is a
  headline with sub headlines. Each sub headline contains a date and a optional text
  together with clocking information. This file scope is used by clocktable to generate a
  report. After the report is generated a formula is executed on the table. This formula
  is pretty extensive. But the main things is to calculate the &#34;Worked&#34; and &#34;Should work&#34;
  columns and subtract &#34;Should work&#34; with &#34;Worked&#34; to show how many hours I have left to
  work.</p>
<p>
  This example depends on the <code class="verbatim">jh/hours-a-day</code> LiSP snippet.</p>
<p>
  The example below states that I have one more hour to work before I have completed my 40
  hours.</p>
<div class="src src-org">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-org" data-lang="org"><span class="line"><span class="cl"><span class="gh">*</span><span class="gs"> Timetable</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">  #+BEGIN: </span><span class="cs">clocktable</span><span class="c"> :scope file :compact t :formula &#34;$3=&#39;(jh/hours-a-day $1 $2)&#39;::@3$3=vsum(@4$3..@&gt;$3);U::@1$2=string(\&#34;Worked|\&#34;)::@1$3=string(\&#34;Should work\&#34;)::@2$2=vsum(@4$2..@&gt;$2)-vsum(@4$3..@&gt;$3);U::@2$1=string(\&#34;Hour pool\&#34;)&#34;
</span></span></span><span class="line"><span class="cl"><span class="c"></span>  #<span class="gd">+CAPTION: Clock summary at [2020-06-21 Sun 21:53]
</span></span></span><span class="line"><span class="cl"><span class="gd">  | Headline                                   | Worked | Should work |
</span></span></span><span class="line"><span class="cl"><span class="gd">  |--------------------------------------------+</span>--------<span class="gd">+-------------|
</span></span></span><span class="line"><span class="cl"><span class="gd">  | Hour pool                                  | -01:00 |             |
</span></span></span><span class="line"><span class="cl"><span class="gd">  |--------------------------------------------+</span>--------+-------------|
</span></span><span class="line"><span class="cl">  <span class="s">| Work                                       |  39:00 |       40:00 |</span>
</span></span><span class="line"><span class="cl">  <span class="s">| \_  [2020-06-13 Sat] Fixed server problems |   3:00 |             |</span>
</span></span><span class="line"><span class="cl">  <span class="s">| \_  [2020-06-12 Fri]                       |   4:00 |        8:00 |</span>
</span></span><span class="line"><span class="cl">  <span class="s">| \_  [2020-06-11 Thu] Updated deps          |   8:00 |        8:00 |</span>
</span></span><span class="line"><span class="cl">  <span class="s">| \_  [2020-06-10 Wed] Deployed server       |   8:00 |        8:00 |</span>
</span></span><span class="line"><span class="cl">  <span class="s">| \_  [2020-06-09 Tue] Meetings              |   8:00 |        8:00 |</span>
</span></span><span class="line"><span class="cl">  <span class="s">| \_  [2020-06-08 Mon]                       |   8:00 |        8:00 |</span>
</span></span><span class="line"><span class="cl">  #+TBLFM: $3=&#39;(jh/hours-a-day $1 $2)&#39;::@3$3=vsum(@4$3..@&gt;$3);U::@1$2=string(&#34;Worked|&#34;)::@1$3=string(&#34;Should work&#34;)::@2$2=vsum(@4$2..@&gt;$2)-vsum(@4$3..@&gt;$3);U::@2$1=string(&#34;Hour pool&#34;)
</span></span><span class="line"><span class="cl"><span class="c">  #+END:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh">*</span><span class="gs"> Work</span>
</span></span><span class="line"><span class="cl"><span class="gu">**</span> [2020-06-13 Sat] Fixed server problems
</span></span><span class="line"><span class="cl"><span class="c">   :LOGBOOK:
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="cs">   CLOCK: [2020-06-13 Sat 08:00]--[2020-06-13 Sat 11:00] =&gt;  3:00
</span></span></span><span class="line"><span class="cl"><span class="cs"></span><span class="c">   :END:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">**</span> [2020-06-12 Fri]
</span></span><span class="line"><span class="cl"><span class="c">   :LOGBOOK:
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="cs">   CLOCK: [2020-06-12 Fri 13:00]--[2020-06-12 Fri 17:00] =&gt;  4:00
</span></span></span><span class="line"><span class="cl"><span class="cs"></span><span class="c">   :END:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">**</span> [2020-06-11 Thu] Updated deps
</span></span><span class="line"><span class="cl"><span class="c">   :LOGBOOK:
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="cs">   CLOCK: [2020-06-11 Thu 08:00]--[2020-06-11 Thu 12:00] =&gt;  4:00
</span></span></span><span class="line"><span class="cl"><span class="cs">   CLOCK: [2020-06-11 Thu 13:00]--[2020-06-11 Thu 17:00] =&gt;  4:00
</span></span></span><span class="line"><span class="cl"><span class="cs"></span><span class="c">   :END:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">**</span> [2020-06-10 Wed] Deployed server
</span></span><span class="line"><span class="cl"><span class="c">   :LOGBOOK:
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="cs">   CLOCK: [2020-06-10 Wed 08:00]--[2020-06-10 Wed 12:00] =&gt;  4:00
</span></span></span><span class="line"><span class="cl"><span class="cs">   CLOCK: [2020-06-10 Wed 13:00]--[2020-06-10 Wed 17:00] =&gt;  4:00
</span></span></span><span class="line"><span class="cl"><span class="cs"></span><span class="c">   :END:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">**</span> [2020-06-09 Tue] Meetings
</span></span><span class="line"><span class="cl"><span class="c">   :LOGBOOK:
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="cs">   CLOCK: [2020-06-09 Tue 08:00]--[2020-06-09 Tue 12:00] =&gt;  4:00
</span></span></span><span class="line"><span class="cl"><span class="cs">   CLOCK: [2020-06-09 Tue 13:00]--[2020-06-09 Tue 17:00] =&gt;  4:00
</span></span></span><span class="line"><span class="cl"><span class="cs"></span><span class="c">   :END:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">**</span> [2020-06-08 Mon]
</span></span><span class="line"><span class="cl"><span class="c">   :LOGBOOK:
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="cs">   CLOCK: [2020-06-08 Mon 08:00]--[2020-06-08 Mon 12:00] =&gt;  4:00
</span></span></span><span class="line"><span class="cl"><span class="cs">   CLOCK: [2020-06-08 Mon 13:00]--[2020-06-08 Mon 17:00] =&gt;  4:00
</span></span></span><span class="line"><span class="cl"><span class="cs"></span><span class="c">   :END:</span></span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-10" class="outline-2">
<h2 id="headline-10">
Nice things I didn&#39;t cover
</h2>
<div id="outline-text-headline-10" class="outline-text-2">
<p>
  Sub headlines with logbook entries can be created really fast from custom templates.
  Take a look at <a href="https://orgmode.org/manual/Capture-templates.html">capture templates</a>.</p>
<p>
  Clocking commands can be used on sub headlines to start and stop timing. More info
  <a href="https://orgmode.org/manual/Clocking-commands.html">here</a>.</p>
</div>
</div>

      
      <div class="related">

<h3>Similar articles:</h3>
<ul>
	
	<li><a href="/posts/emacs-orgmode-source-code-blocks/">Emacs Org mode source blocks</a></li>
	
	<li><a href="/posts/clojure-spec-test-transducers/">Quick overview of Clojure spec, test.check and transducers</a></li>
	
	<li><a href="/posts/datomic-entity-event-log/">Entity event log in Datomic</a></li>
	
</ul>
</div>
      
    </div>
    
  </div>
</section>

    <script src="/js/copycode.js"></script>



<section class="section">
  <div class="container has-text-centered">
    <p></p>
    
      <p>Powered by <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/ribice/kiss">Kiss</a>.</p>
    
  </div>
</section>



</body>
</html>

