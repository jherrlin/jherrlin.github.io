<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#1b1b1b">
	<title>Quick overview of Clojure spec, test.check and transducers | John Herrlin</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Quick overview of Clojure spec, test.check and transducers" />
<meta property="og:description" content="Into   A quick and dirty overview on some of the capabilities of Clojure spec, test.check and transducers. With focus on generative data. Describing models with spec and then use test.check to generate entities from that model. Bulletproof transducers with the generated data.  Wont cover or explain details, instead show how it can be used.  Some examples where generated data can be used:    Provide generated data through a Rest API endpoint and serve it a JSON." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jherrlin.github.io/posts/clojure-spec-test-transducers/" />
<meta property="article:published_time" content="2020-05-22T23:47:13+02:00" />
<meta property="article:modified_time" content="2020-05-22T23:47:13+02:00" />

		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Quick overview of Clojure spec, test.check and transducers"/>
<meta name="twitter:description" content="Into   A quick and dirty overview on some of the capabilities of Clojure spec, test.check and transducers. With focus on generative data. Describing models with spec and then use test.check to generate entities from that model. Bulletproof transducers with the generated data.  Wont cover or explain details, instead show how it can be used.  Some examples where generated data can be used:    Provide generated data through a Rest API endpoint and serve it a JSON."/>

	<link rel="stylesheet" href="/css/bundle.css">
	<link rel="stylesheet" href="/css/custom.css">
	<link rel="icon" href="/icons/16.png" sizes="16x16" type="image/png">
	<link rel="icon" href="/icons/32.png" sizes="32x32" type="image/png">
		
</head>
<body>
	<header class="header">
	<a class="logo" href="/">John Herrlin</a>
	
</header>
	<div class="primary">
	
	<main class="main">
		
<nav class="breadcrumb block" aria-label="breadcrumb">
	<ol class="breadcrumb__list">
		
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="/">Home</a>
		</li>
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="/posts/">Posts</a>
		</li>
		<li class="breadcrumbs__item breadcrumb__item--active" aria-current="page">Quick overview of Clojure spec, test.check and transducers</li>
	</ol>
</nav>
		<div class="single block">
			<article class="entry">
	<div class="entry__meta meta mb">
	<time class="entry__meta-published meta-published" datetime="2020-05-22T23:47:13&#43;02:00">May 22, 2020</time>
<span class="entry__meta-categories meta-categories">
	<span class="meta-categories__list">Categories:
		<a class="meta-categories__link" href="/categories/test" rel="category">test</a>, 
		<a class="meta-categories__link" href="/categories/spec" rel="category">spec</a>, 
		<a class="meta-categories__link" href="/categories/clojure" rel="category">clojure</a>, 
		<a class="meta-categories__link" href="/categories/transducers" rel="category">transducers</a>, 
		<a class="meta-categories__link" href="/categories/generative" rel="category">generative</a>
	</span>
</span>
	</div>
				<h1 class="entry__title">Quick overview of Clojure spec, test.check and transducers</h1>
<details class="entry__toc toc" open>
	<summary class="toc__title">Table of Contents</summary>
	<nav id="TableOfContents">
<ul>
<li><a href="#headline-1">Into</a>
</li>
<li><a href="#headline-2">Dependencies</a>
</li>
<li><a href="#headline-3">Require</a>
</li>
<li><a href="#headline-4">Specs</a>
</li>
<li><a href="#headline-5">Generate</a>
</li>
<li><a href="#headline-6">Validate</a>
</li>
<li><a href="#headline-7">Transducers</a>
</li>
<li><a href="#headline-8">Test transducer composition</a>
</li>
</ul>
</nav>
</details>
				<div class="entry__content">
<h2 id="headline-1">
Into
</h2>
<p>
  A quick and dirty overview on some of the capabilities of Clojure spec, test.check and
  transducers. With focus on generative data. Describing models with spec and then use
  test.check to generate entities from that model. Bulletproof transducers with the
  generated data.
</p>
<p>
  Wont cover or explain details, instead show how it can be used.
</p>
<p>
  Some examples where generated data can be used:
</p>
<ul>
<li>
<p>
Provide generated data through a Rest API endpoint and serve it a JSON. Good starting
point before you have data in your app.
</p>
</li>
<li>
<p>
Use in tests.
</p>
</li>
<li>
<p>
In Clojures fdef&#39;s to bulletproof your functions.
</p>
</li>
</ul>
<h2 id="headline-2">
Dependencies
</h2>
<p>
  <a href="https://clojure.org/guides/deps_and_cli">Clojure Deps</a> handles dependencies. The <code class="verbatim">deps.edn</code> looks like this:
</p>
<div class="src src-clojure">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">  {<span style="color:#e6db74">:deps</span> {org.clojure/clojure {<span style="color:#e6db74">:mvn/version</span> <span style="color:#e6db74">&#34;1.10.1&#34;</span>}
          org.clojure/test.check {<span style="color:#e6db74">:mvn/version</span> <span style="color:#e6db74">&#34;0.10.0&#34;</span>}}}</code></pre></div>
</div>
<h2 id="headline-3">
Require
</h2>
<p>
  Start by require the needed namespaces.
</p>
<div class="src src-clojure">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">  (<span style="color:#a6e22e">require</span> <span style="color:#f92672">&#39;</span>[clojure.string <span style="color:#e6db74">:as</span> str]
           <span style="color:#f92672">&#39;</span>[clojure.spec.alpha <span style="color:#e6db74">:as</span> s]
           <span style="color:#f92672">&#39;</span>[clojure.spec.test.alpha <span style="color:#e6db74">:as</span> stest]
           <span style="color:#f92672">&#39;</span>[clojure.test.check.generators <span style="color:#e6db74">:as</span> gen])</code></pre></div>
</div>
<h2 id="headline-4">
Specs
</h2>
<p>
  Specs with two models. <code class="verbatim">::person</code> and <code class="verbatim">::person-with-age</code>.
</p>
<p>
  Each attribute have a generator that knows how to generate appropriate data with a
  likelihood.
</p>
<div class="src src-clojure">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">  (<span style="color:#a6e22e">s/def</span> <span style="color:#e6db74">::non-blank-string</span> (<span style="color:#a6e22e">s/and</span> string? (complement str/blank?)))

  (<span style="color:#a6e22e">s/def</span> <span style="color:#e6db74">::known-email-providers</span> <span style="color:#f92672">#</span>{<span style="color:#e6db74">&#34;gmail.com&#34;</span> <span style="color:#e6db74">&#34;live.se&#34;</span> <span style="color:#e6db74">&#34;protonmail.com&#34;</span>})

  (<span style="color:#a6e22e">s/def</span> <span style="color:#e6db74">::random-email-providers</span>
    (<span style="color:#a6e22e">s/with-gen</span>
      (<span style="color:#a6e22e">s/and</span> string? <span style="color:#f92672">#</span>(re-matches <span style="color:#f92672">#</span><span style="color:#e6db74">&#34;.+\..+&#34;</span> %))
      <span style="color:#f92672">#</span>(<span style="color:#a6e22e">gen/fmap</span> (<span style="color:#66d9ef">fn </span>[[a b]] (str a <span style="color:#e6db74">&#34;.&#34;</span> b))
                 (<span style="color:#a6e22e">gen/tuple</span>
                  (<span style="color:#a6e22e">s/gen</span> <span style="color:#e6db74">::non-blank-string</span>)
                  (<span style="color:#a6e22e">s/gen</span> <span style="color:#e6db74">::non-blank-string</span>)))))

  (<span style="color:#a6e22e">s/def</span> <span style="color:#e6db74">:person/name</span>
    (<span style="color:#a6e22e">s/with-gen</span>
      <span style="color:#e6db74">::non-blank-string</span>
      <span style="color:#f92672">#</span>(<span style="color:#a6e22e">gen/frequency</span> [[<span style="color:#ae81ff">3</span> (<span style="color:#a6e22e">s/gen</span> <span style="color:#e6db74">::non-blank-string</span>)]
                       [<span style="color:#ae81ff">7</span> (<span style="color:#a6e22e">gen/elements</span> [<span style="color:#e6db74">&#34;Ann&#34;</span> <span style="color:#e6db74">&#34;Anna&#34;</span> <span style="color:#e6db74">&#34;Hanna&#34;</span> <span style="color:#e6db74">&#34;Johanna&#34;</span> <span style="color:#e6db74">&#34;Erik&#34;</span>])]])))

  (<span style="color:#a6e22e">s/def</span> <span style="color:#e6db74">:person/email</span>
    (<span style="color:#a6e22e">s/with-gen</span>
      (<span style="color:#a6e22e">s/and</span> string? <span style="color:#f92672">#</span>(re-matches <span style="color:#f92672">#</span><span style="color:#e6db74">&#34;.+@.+\..+&#34;</span> %))
      <span style="color:#f92672">#</span>(<span style="color:#a6e22e">gen/fmap</span>
        (<span style="color:#66d9ef">fn </span>[[a b]] (str a <span style="color:#e6db74">&#34;@&#34;</span> b))
        (<span style="color:#a6e22e">gen/tuple</span>
         (<span style="color:#a6e22e">s/gen</span> <span style="color:#e6db74">::non-blank-string</span>)
         (<span style="color:#a6e22e">gen/frequency</span> [[<span style="color:#ae81ff">5</span> (<span style="color:#a6e22e">s/gen</span> <span style="color:#e6db74">::known-email-providers</span>)]
                         [<span style="color:#ae81ff">5</span> (<span style="color:#a6e22e">s/gen</span> <span style="color:#e6db74">::random-email-providers</span>)]])))))

  (<span style="color:#a6e22e">s/def</span> <span style="color:#e6db74">:person/born</span>
    (<span style="color:#a6e22e">s/with-gen</span>
      (<span style="color:#a6e22e">s/int-in</span> <span style="color:#ae81ff">1800</span> <span style="color:#ae81ff">2500</span>)
      <span style="color:#f92672">#</span>(<span style="color:#a6e22e">gen/frequency</span> [[<span style="color:#ae81ff">5</span> (<span style="color:#a6e22e">s/gen</span> (<span style="color:#a6e22e">s/int-in</span> <span style="color:#ae81ff">1800</span> <span style="color:#ae81ff">2020</span>))]
                       [<span style="color:#ae81ff">5</span> (<span style="color:#a6e22e">gen/choose</span> <span style="color:#ae81ff">1985</span> <span style="color:#ae81ff">1987</span>)]])))

  (<span style="color:#a6e22e">s/def</span> <span style="color:#e6db74">::person</span>
    (<span style="color:#a6e22e">s/keys</span> <span style="color:#e6db74">:req</span> [<span style="color:#e6db74">:person/name</span>
                  <span style="color:#e6db74">:person/email</span>
                  <span style="color:#e6db74">:person/born</span>]))

  (<span style="color:#a6e22e">s/def</span> <span style="color:#e6db74">:person/age</span> (<span style="color:#a6e22e">s/int-in</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">150</span>))

  (<span style="color:#a6e22e">s/def</span> <span style="color:#e6db74">::person-with-age</span>
    (<span style="color:#a6e22e">s/merge</span>
     <span style="color:#e6db74">::person</span>
     (<span style="color:#a6e22e">s/keys</span> <span style="color:#e6db74">:req</span> [<span style="color:#e6db74">:person/age</span>])))</code></pre></div>
</div>
<h2 id="headline-5">
Generate
</h2>
<p>
  Generate a single entity.
</p>
<div class="src src-clojure">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">  (<span style="color:#a6e22e">gen/generate</span> (<span style="color:#a6e22e">s/gen</span> <span style="color:#e6db74">::person</span>))</code></pre></div>
</div>
<p>
  Result.
</p>
<div class="src src-clojure">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">  <span style="color:#f92672">#</span><span style="color:#e6db74">:person</span>{<span style="color:#e6db74">:name</span> <span style="color:#e6db74">&#34;Johanna&#34;</span>,
           <span style="color:#e6db74">:email</span> <span style="color:#e6db74">&#34;5g29n6pytf1Ze4Wa47e5Ff2Wv@live.se&#34;</span>,
           <span style="color:#e6db74">:born</span> <span style="color:#ae81ff">1986</span>}</code></pre></div>
</div>
<p>
  Generate a collection with 100 entities.
</p>
<div class="src src-clojure">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">  (<span style="color:#a6e22e">gen/sample</span> (<span style="color:#a6e22e">s/gen</span> <span style="color:#e6db74">::person</span>) <span style="color:#ae81ff">100</span>)</code></pre></div>
</div>
<p>
  Results are truncated.
</p>
<div class="src src-clojure">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">  (<span style="color:#f92672">#</span><span style="color:#e6db74">:person</span>{<span style="color:#e6db74">:name</span> <span style="color:#e6db74">&#34;Ann&#34;</span>, <span style="color:#e6db74">:email</span> <span style="color:#e6db74">&#34;t@gmail.com&#34;</span>, <span style="color:#e6db74">:born</span> <span style="color:#ae81ff">1800</span>}
   <span style="color:#f92672">#</span><span style="color:#e6db74">:person</span>{<span style="color:#e6db74">:name</span> <span style="color:#e6db74">&#34;Ann&#34;</span>, <span style="color:#e6db74">:email</span> <span style="color:#e6db74">&#34;1@1.V&#34;</span>, <span style="color:#e6db74">:born</span> <span style="color:#ae81ff">1985</span>}
   <span style="color:#f92672">#</span><span style="color:#e6db74">:person</span>{<span style="color:#e6db74">:name</span> <span style="color:#e6db74">&#34;E&#34;</span>, <span style="color:#e6db74">:email</span> <span style="color:#e6db74">&#34;V@gmail.com&#34;</span>, <span style="color:#e6db74">:born</span> <span style="color:#ae81ff">1800</span>}
   <span style="color:#f92672">#</span><span style="color:#e6db74">:person</span>{<span style="color:#e6db74">:name</span> <span style="color:#e6db74">&#34;Erik&#34;</span>, <span style="color:#e6db74">:email</span> <span style="color:#e6db74">&#34;c@live.se&#34;</span>, <span style="color:#e6db74">:born</span> <span style="color:#ae81ff">1987</span>}
   <span style="color:#f92672">#</span><span style="color:#e6db74">:person</span>{<span style="color:#e6db74">:name</span> <span style="color:#e6db74">&#34;Erik&#34;</span>, <span style="color:#e6db74">:email</span> <span style="color:#e6db74">&#34;OSW@Xc.AO7D&#34;</span>, <span style="color:#e6db74">:born</span> <span style="color:#ae81ff">1987</span>}
   <span style="color:#f92672">#</span><span style="color:#e6db74">:person</span>{<span style="color:#e6db74">:name</span> <span style="color:#e6db74">&#34;Ann&#34;</span>, <span style="color:#e6db74">:email</span> <span style="color:#e6db74">&#34;wKoGD@T34.6U2&#34;</span>, <span style="color:#e6db74">:born</span> <span style="color:#ae81ff">1985</span>}
   <span style="color:#f92672">#</span><span style="color:#e6db74">:person</span>{<span style="color:#e6db74">:name</span> <span style="color:#e6db74">&#34;C0q082&#34;</span>, <span style="color:#e6db74">:email</span> <span style="color:#e6db74">&#34;q@e7RR7N.P5ED&#34;</span>, <span style="color:#e6db74">:born</span> <span style="color:#ae81ff">1800</span>}
   ,,,)</code></pre></div>
</div>
<h2 id="headline-6">
Validate
</h2>
<p>
  Lets validate data against a spec.
</p>
<div class="src src-clojure">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">  (<span style="color:#a6e22e">s/valid?</span> <span style="color:#e6db74">::person</span>
            <span style="color:#f92672">#</span><span style="color:#e6db74">:person</span>{<span style="color:#e6db74">:name</span> <span style="color:#e6db74">&#34;Johanna&#34;</span>,
                     <span style="color:#e6db74">:email</span> <span style="color:#e6db74">&#34;5g29n6pytf1Ze4Wa47e5Ff2Wv@live.se&#34;</span>,
                     <span style="color:#e6db74">:born</span> <span style="color:#ae81ff">1986</span>})
  <span style="color:#75715e">;; =&gt; true</span>

  (<span style="color:#a6e22e">s/valid?</span> <span style="color:#e6db74">::person</span>
            <span style="color:#f92672">#</span><span style="color:#e6db74">:person</span>{<span style="color:#e6db74">:name</span> <span style="color:#e6db74">&#34;Someone&#34;</span>})
  <span style="color:#75715e">;; =&gt; false</span></code></pre></div>
</div>
<h2 id="headline-7">
Transducers
</h2>
<p>
  Use a composition of transducers on data what we can generate. Generate 1000 persons,
  filter out persons that have a name that contains &#34;ann&#34; and are born in 1985 or 1986 and
  uses proton as a mail provider. Set their current age and take 3 of them.
</p>
<div class="src src-clojure">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">  (<span style="color:#66d9ef">defn </span>person-name-contains [s]
    (filter (comp <span style="color:#f92672">#</span>(re-matches (re-pattern (str <span style="color:#e6db74">&#34;(?i).*&#34;</span> s <span style="color:#e6db74">&#34;.*&#34;</span>)) %) <span style="color:#e6db74">:person/name</span>)))

  (<span style="color:#66d9ef">defn </span>person-born-in-years [years-set]
    (filter (comp years-set <span style="color:#e6db74">:person/born</span>)))

  (<span style="color:#66d9ef">defn </span>person-email-provider [provider]
    (filter (comp <span style="color:#f92672">#</span>(re-matches (re-pattern (str <span style="color:#e6db74">&#34;(?i).*&#34;</span> provider <span style="color:#e6db74">&#34;.*&#34;</span>)) %) <span style="color:#e6db74">:person/email</span>)))

  (<span style="color:#66d9ef">defn </span>calc-person-age []
    (map (<span style="color:#66d9ef">fn </span>[{<span style="color:#e6db74">:person/keys</span> [born] <span style="color:#e6db74">:as</span> p}] (assoc p <span style="color:#e6db74">:person/age</span> (- <span style="color:#ae81ff">2020</span> born)))))

  (<span style="color:#66d9ef">def </span>xf
    (<span style="color:#a6e22e">comp</span>
     (<span style="color:#a6e22e">calc-person-age</span>)
     (<span style="color:#a6e22e">person-name-contains</span> <span style="color:#e6db74">&#34;ann&#34;</span>)
     (<span style="color:#a6e22e">person-born-in-years</span> <span style="color:#f92672">#</span>{<span style="color:#ae81ff">1985</span> <span style="color:#ae81ff">1986</span>})
     (<span style="color:#a6e22e">person-email-provider</span> <span style="color:#e6db74">&#34;protonmail&#34;</span>)
     (take <span style="color:#ae81ff">3</span>)))

  (into [] xf (<span style="color:#a6e22e">gen/sample</span> (<span style="color:#a6e22e">s/gen</span> <span style="color:#e6db74">::person</span>) <span style="color:#ae81ff">1000</span>))</code></pre></div>
</div>
<p>
  This is the results.
</p>
<div class="src src-clojure">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">[<span style="color:#f92672">#</span><span style="color:#e6db74">:person</span>{<span style="color:#e6db74">:name</span> <span style="color:#e6db74">&#34;Ann&#34;</span>,
          <span style="color:#e6db74">:email</span> <span style="color:#e6db74">&#34;Tz77Z1sFXL6kO1fnojYy8@protonmail.org&#34;</span>,
          <span style="color:#e6db74">:born</span> <span style="color:#ae81ff">1985</span>,
          <span style="color:#e6db74">:age</span> <span style="color:#ae81ff">35</span>}
 <span style="color:#f92672">#</span><span style="color:#e6db74">:person</span>{<span style="color:#e6db74">:name</span> <span style="color:#e6db74">&#34;Hanna&#34;</span>,
          <span style="color:#e6db74">:email</span> <span style="color:#e6db74">&#34;O@protonmail.org&#34;</span>,
          <span style="color:#e6db74">:born</span> <span style="color:#ae81ff">1985</span>,
          <span style="color:#e6db74">:age</span> <span style="color:#ae81ff">35</span>}
 <span style="color:#f92672">#</span><span style="color:#e6db74">:person</span>{<span style="color:#e6db74">:name</span> <span style="color:#e6db74">&#34;Anna&#34;</span>,
          <span style="color:#e6db74">:email</span> <span style="color:#e6db74">&#34;Jq29sl1l2yoLmL42W3whqO4i8YtVJ@protonmail.org&#34;</span>,
          <span style="color:#e6db74">:born</span> <span style="color:#ae81ff">1986</span>,
          <span style="color:#e6db74">:age</span> <span style="color:#ae81ff">34</span>}]</code></pre></div>
</div>
<h2 id="headline-8">
Test transducer composition
</h2>
<p>
  Lets use Clojure&#39;s <code class="verbatim">fdef</code> to test our composition of transducers.
</p>
<p>
  <code class="verbatim">anns-with-proton-mail</code> will be evaluated 1000 times. Each time with 100 new
  <code class="verbatim">::person</code>&#39;s and a random positive integer that arguments the pagination. On every
  invocation the function should return a collection of <code class="verbatim">::person-with-age</code> and the
  collection should not be greater than our paginate value. If a return don&#39;t conform to
  our rules an error will be thrown.
</p>
<div class="src src-clojure">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">  (<span style="color:#66d9ef">defn </span>anns-with-proton-mail [paginate xs]
    (<span style="color:#a6e22e">into</span>
     []
     (<span style="color:#a6e22e">comp</span>
      (<span style="color:#a6e22e">calc-person-age</span>)
      (<span style="color:#a6e22e">person-name-contains</span> <span style="color:#e6db74">&#34;ann&#34;</span>)
      (<span style="color:#a6e22e">person-born-in-years</span> <span style="color:#f92672">#</span>{<span style="color:#ae81ff">1985</span> <span style="color:#ae81ff">1986</span>})
      (<span style="color:#a6e22e">person-email-provider</span> <span style="color:#e6db74">&#34;protonmail&#34;</span>)
      (take paginate))
     xs))

  (<span style="color:#a6e22e">s/fdef</span> anns-with-proton-mail
    <span style="color:#e6db74">:args</span> (<span style="color:#a6e22e">s/cat</span> <span style="color:#e6db74">:paginate</span> pos-int? <span style="color:#e6db74">:xs</span> (<span style="color:#a6e22e">s/coll-of</span> <span style="color:#e6db74">::person</span> <span style="color:#e6db74">:count</span> <span style="color:#ae81ff">100</span>))
    <span style="color:#e6db74">:ret</span> (<span style="color:#a6e22e">s/coll-of</span> <span style="color:#e6db74">::person-with-age</span>)
    <span style="color:#e6db74">:fn</span> (<span style="color:#66d9ef">fn </span>[{{p <span style="color:#e6db74">:paginate</span> xs <span style="color:#e6db74">:xs</span>} <span style="color:#e6db74">:args</span> res <span style="color:#e6db74">:res</span>}]
          (&gt;=  p (count res))))

  (<span style="color:#a6e22e">stest/check</span> <span style="color:#f92672">`</span>anns-with-proton-mail)</code></pre></div>
</div>
<p>
  Results from <code class="verbatim">stest/check</code>.
</p>
<div class="src src-clojure">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">  ({<span style="color:#e6db74">:spec</span>
    <span style="color:#f92672">#</span>object[clojure.spec.alpha$fspec_impl$reify__2524 <span style="color:#ae81ff">0</span>x449e3c52
            <span style="color:#e6db74">&#34;clojure.spec.alpha$fspec_impl$reify__2524@449e3c52&#34;</span>],
    <span style="color:#e6db74">:clojure.spec.test.check/ret</span>
    {<span style="color:#e6db74">:result</span> true,
     <span style="color:#e6db74">:pass?</span> true,
     <span style="color:#e6db74">:num-tests</span> <span style="color:#ae81ff">1000</span>,
     <span style="color:#e6db74">:time-elapsed-ms</span> <span style="color:#ae81ff">17372</span>,
     <span style="color:#e6db74">:seed</span> <span style="color:#ae81ff">1590228136922</span>},
    <span style="color:#e6db74">:sym</span> user/anns-with-proton-mail})</code></pre></div>
</div>
</div>
				
				<footer class="entry__footer">
					
					
<div class="entry__share share">
	<a class="share__link btn" title="Share on Twitter" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fjherrlin.github.io%2fposts%2fclojure-spec-test-transducers%2f&amp;text=Quick%20overview%20of%20Clojure%20spec%2c%20test.check%20and%20transducers" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Share on Twitter', 'width=800,height=450,resizable=yes,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
	</a>
</div>
				</footer>
				
			</article>
		</div>
	</main>
	
	



	

	</div>
	<footer class="footer">
<div class="footer__social social">
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="mailto:jherrlin@gmail.com">
			<svg class="social__icon" aria-label="Email" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M299 268l124 106c-4 4-10 7-17 7H106c-7 0-13-3-17-7l124-106 43 38 43-38zm-43 13L89 138c4-4 10-7 17-7h300c7 0 13 3 17 7L256 281zm54-23l121-105v208L310 258zM81 153l121 105L81 361V153z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/jherrlin">
			<svg class="social__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/jherrlin">
			<svg class="social__icon" aria-label="Github" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
		</a>
</div>
	<div class="footer__copyright">© 2020 John Herrlin. <span class="footer__copyright-credits">Powered by <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/vimux/binario" rel="nofollow noopener" target="_blank">Binario</a> theme.</span></div>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>

<script src="/js/custom.js"></script>
</body>
</html>